cscope 15 $HOME/Prajwala-webrtc/workspace/ipop-project/Tincan/trunk               0000220416
	@include/async_io.h

23 #iâdeà
TINCAN_ASYNCIO_H_


24 
	#TINCAN_ASYNCIO_H_


	)

25 
	~"web¹c/¹c_ba£/loggšg.h
"

26 #ià
defšed
(
_IPOP_WIN
)

27 
	~<Wšsock2.h
>

28 
	~<mšwšba£.h
>

31 
	~"tšÿn_ba£.h
"

33 
Çme¥aû
 
	gtšÿn


35 
	eAIO_OP


37 
	gAIO_READ
,

38 
	gAIO_WRITE
,

39 
	gAIO_MAX


42 
	gAsyncIo


43 #ià
defšed
(
_IPOP_WIN
)

44 : 
public
 
OVERLAPPED


47 
AsyncIo
() :

48 
bufãr_to_Œªsãr_
(
nuÎ±r
),

49 
cÚ‹xt_
(
nuÎ±r
),

50 
by‹s_to_Œªsãr_
(0),

51 
by‹s_Œªsã¼ed_
(0),

52 
æags_
(
AIO_READ
),

53 
good_
(
Œue
)

55 #ià
defšed
(
_IPOP_WIN
)

56 
Z”oMemÜy
(
this
, (
OVERLAPPED
));

59 
AsyncIo
(

60 
ušt8_t
* 
bufãr
,

61 
ušt32_t
 
by‹s_to_Œªsãr
,

62 * 
cÚ‹xt
,

63 
AIO_OP
 
æags
,

64 
ušt32_t
 
by‹s_Œªsã¼ed
 = 0) :

65 
bufãr_to_Œªsãr_
(
bufãr
),

66 
cÚ‹xt_
(
cÚ‹xt
),

67 
by‹s_to_Œªsãr_
(
by‹s_to_Œªsãr
),

68 
by‹s_Œªsã¼ed_
(
by‹s_Œªsã¼ed
),

69 
æags_
(
æags
),

70 
good_
(
Œue
)

72 #ià
defšed
(
_IPOP_WIN
)

73 
Z”oMemÜy
(
this
, (
OVERLAPPED
));

76 #ià!
defšed
(
_IPOP_WIN
)

77 
	gvœtu®
 ~
AsyncIo
() = ;

79 
In™Ÿlize
(

80 
ušt8_t
* 
bufãr_to_Œªsãr
,

81 
ušt32_t
 
by‹s_to_Œªsãr
,

82 * 
cÚ‹xt
 = 
nuÎ±r
,

83 
AIO_OP
 
æags
 = 
AIO_READ
,

84 
ušt32_t
 
by‹s_Œªsã¼ed
 = 0)

86 
bufãr_to_Œªsãr_
 = 
bufãr_to_Œªsãr
;

87 
	gby‹s_to_Œªsãr_
 = 
by‹s_to_Œªsãr
;

88 
	gcÚ‹xt_
 = 
cÚ‹xt
;

89 
	gæags_
 = 
æags
;

90 
	gby‹s_Œªsã¼ed_
 = 
by‹s_Œªsã¼ed
;

93 
BufãrToT¿nsãr
(
ušt8_t
* 
v®
)

95 
	gbufãr_to_Œªsãr_
 = 
v®
;

97 
ušt8_t
* 
BufãrToT¿nsãr
()

99  
	gbufãr_to_Œªsãr_
;

102 
By‹sToT¿nsãr
(
ušt32_t
 
v®
)

104 
	gby‹s_to_Œªsãr_
 = 
v®
;

106 
ušt32_t
 
By‹sToT¿nsãr
()

108  
	gby‹s_to_Œªsãr_
;

111 
By‹sT¿nsã¼ed
(
ušt32_t
 
v®
)

113 
	gby‹s_Œªsã¼ed_
 = 
v®
;

115 
ušt32_t
 
By‹sT¿nsã¼ed
()

117  
	gby‹s_Œªsã¼ed_
;

120 
CÚ‹xt
(* 
v®
)

122 
	gcÚ‹xt_
 = 
v®
;

124 * 
CÚ‹xt
()

126  
	gcÚ‹xt_
;

129 
boŞ
 
IsR—d
()

131  
	gæags_
 =ğ
AIO_READ
;

133 
S‘R—dOp
()

135 
	gæags_
 = 
AIO_READ
;

137 
boŞ
 
IsWr™e
()

139  
	gæags_
 =ğ
AIO_WRITE
;

141 
S‘Wr™eOp
()

143 
	gæags_
 = 
AIO_WRITE
;

145 
boŞ
 
IsGood
()

147  
	ggood_
;

149 
ušt8_t
 * 
	gbufãr_to_Œªsãr_
;

150 * 
	gcÚ‹xt_
;

151 
ušt32_t
 
	gby‹s_to_Œªsãr_
;

152 
ušt32_t
 
	gby‹s_Œªsã¼ed_
;

153 
AIO_OP
 
	gæags_
;

154 
boŞ
 
	ggood_
;

	@include/basic_tunnel.h

23 #iâdeà
BASIC_TUNNEL_H_


24 
	#BASIC_TUNNEL_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"web¹c/¹c_ba£/ÃtwÜk.h
"

27 #ifdeà
mš


28 #undeà
mš


30 #ifdeà
max


31 #undeà
max


33 
	~"web¹c/¹c_ba£/s¦_id’t™y.h
"

34 
	~"web¹c/¹c_ba£/th»ad.h
"

35 
	~"web¹c/¹c_ba£/thœd_·¹y/sig¦Ù/sig¦Ù.h
"

36 
	~"web¹c/¹c_ba£/jsÚ.h
"

37 
	~"async_io.h
"

38 
	~"cÚŒŞËr_hªdË.h
"

39 
	~"³”_ÃtwÜk.h
"

40 
	~"pdev.h
"

41 
	~"p_äame.h
"

42 
	~"tšÿn_exû±iÚ.h
"

43 
	~"tuÂ–_desütÜ.h
"

44 
	~"vœtu®_lšk.h
"

46 
Çme¥aû
 
	gtšÿn


48 
şass
 
	gBasicTuÂ–
 :

49 
public
 
sig¦Ù
::
has_¦Ùs
<>,

50 
public
 
	gMes§geHªdËr


52 
	gpublic
:

53 
	eMSG_ID


55 
MSGID_TRANSMIT
,

56 
	gMSGID_SEND_ICC
,

57 
	gMSGID_QUERY_NODE_INFO
,

58 
	gMSGID_FWD_FRAME
,

59 
	gMSGID_FWD_FRAME_RD
,

60 
	gMSGID_DISC_LINK
,

62 şas 
	cT¿nsm™MsgD©a
 : 
public
 
Mes§geD©a


64 
public
:

65 
sh¬ed_±r
<
Vœtu®Lšk
> 
vl
;

66 
	gunique_±r
<
	gT­F¿me
> 
	gäm
;

68 şas 
	cLškInfoMsgD©a
 : 
public
 
Mes§geD©a


70 
public
:

71 
sh¬ed_±r
<
Vœtu®Lšk
> 
vl
;

72 
	gJsÚ
::
V®ue
 
šfo
;

73 
	g¹c
::
Ev’t
 
msg_ev’t
;

74 
LškInfoMsgD©a
(è: 
šfo
(
JsÚ
::
¬¿yV®ue
), 
msg_ev’t
(
çl£
, false) {}

75 ~
LškInfoMsgD©a
() = ;

77 şas 
	cLškMsgD©a
 : 
public
 
Mes§geD©a


79 
public
:

80 
sh¬ed_±r
<
Vœtu®Lšk
> 
vl
;

81 
	g¹c
::
Ev’t
 
msg_ev’t
;

82 
LškMsgD©a
(è: 
msg_ev’t
(
çl£
, false)

84 ~
LškMsgD©a
() = ;

87 
BasicTuÂ–
(

88 
unique_±r
<
TuÂ–DesütÜ
> 
desütÜ
,

89 
IpİCÚŒŞËrLšk
 * 
ù¾_hªdË
);

91 
	gvœtu®
 ~
BasicTuÂ–
();

93 
vœtu®
 
CÚfigu»
(

94 
unique_±r
<
T­DesütÜ
> 
p_desc
,

95 cÚ¡ 
veùÜ
<
¡ršg
>& 
ignÜed_li¡
);

97 
vœtu®
 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
C»©eVlšk
(

98 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

99 
unique_±r
<
P“rDesütÜ
> 
³”_desc
) = 0;

101 
vœtu®
 
	gTuÂ–DesütÜ
 & 
DesütÜ
();

103 
vœtu®
 
¡ršg
 
Fšg”´št
();

105 
vœtu®
 
InjeùFame
(

106 
¡ršg
 && 
d©a
);

108 
vœtu®
 
¡ršg
 
Name
();

110 
vœtu®
 
¡ršg
 
MacAdd»ss
();

112 
vœtu®
 
Qu”yInfo
(

113 
JsÚ
::
V®ue
 & 
Šl_šfo
) = 0;

115 
vœtu®
 
Qu”yLškIds
(

116 
veùÜ
<
¡ršg
> & 
lšk_ids
) = 0;

118 
vœtu®
 
Qu”yLškInfo
(

119 cÚ¡ 
¡ršg
 & 
vlšk_id
,

120 
JsÚ
::
V®ue
 & 
vlšk_šfo
) = 0;

122 
vœtu®
 
Qu”yLškCas
(

123 cÚ¡ 
¡ršg
 & 
vlšk_id
,

124 
JsÚ
::
V®ue
 & 
ÿs_šfo
) = 0;

126 
vœtu®
 
S’dIcc
(

127 cÚ¡ 
¡ršg
 & 
vlšk_id
,

128 cÚ¡ 
¡ršg
 & 
d©a
) = 0;

130 
vœtu®
 
Shutdown
();

132 
vœtu®
 
S¹
();

134 
vœtu®
 
S¹Io
();

136 
vœtu®
 
StİIo
() {}

138 
vœtu®
 
RemoveLšk
(

139 cÚ¡ 
¡ršg
 & 
vlšk_id
) = 0;

141 
vœtu®
 
Upd©eRou‹TabË
(

142 cÚ¡ 
JsÚ
::
V®ue
 & 
¹_desü
) = 0;

146 
vœtu®
 
VlškR—dCom¶‘e
(

147 
ušt8_t
 * 
d©a
,

148 
ušt32_t
 
d©a_Ën
,

149 
Vœtu®Lšk
 & 
vlšk
) = 0;

152 
vœtu®
 
T­R—dCom¶‘e
(

153 
AsyncIo
 * 
aio_rd
) = 0;

154 
vœtu®
 
T­Wr™eCom¶‘e
(

155 
AsyncIo
 * 
aio_wr
) = 0;

158 
OnMes§ge
(

159 
Mes§ge
* 
msg
è
	gov”ride
;

160 
	g´Ùeùed
:

161 
S‘IgnÜedN‘wÜkIÁ”çûs
(

162 cÚ¡ 
veùÜ
<
¡ršg
>& 
ignÜed_li¡
);

164 
	gunique_±r
<
	gVœtu®Lšk
> 
C»©eVlšk
(

165 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

166 
unique_±r
<
P“rDesütÜ
>

167 
³”_desc
, 
üick‘
::
IûRŞe
 
iû_rŞe
);

168 
vœtu®
 
VLškUp
(

169 
¡ršg
 
vlšk_id
);

170 
vœtu®
 
VLškDown
(

171 
¡ršg
 
vlšk_id
);

172 
	gunique_±r
<
	gT­Dev
> 
	gtdev_
;

173 
	gunique_±r
<
	gT­DesütÜ
> 
	gp_desc_
;

174 
	gunique_±r
<
	gTuÂ–DesütÜ
> 
	gdesütÜ_
;

176 
IpİCÚŒŞËrLšk
 * 
	gù¾_lšk_
;

177 
	gunique_±r
<
	g¹c
::
SSLId’t™y
> 
s¦id_
;

178 
	gunique_±r
<
	g¹c
::
SSLFšg”´št
> 
loÿl_fšg”´št_
;

179 
	g¹c
::
Th»ad
 
Ãt_wÜk”_
;

180 
	g¹c
::
Th»ad
 
sig_wÜk”_
;

181 
	g¹c
::
BasicN‘wÜkMªag”
 
Ãt_mªag”_
;

	@include/control_dispatch.h

23 #iâdeà
TINCAN_CONTROL_DISPATCH_H_


24 
	#TINCAN_CONTROL_DISPATCH_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"web¹c/¹c_ba£/loggšg.h
"

27 
	~"web¹c/¹c_ba£/log_sšks.h
"

28 
	~"ba£/fes/fe_ut.h
"

29 
	~"ba£/ªdroid/·th_uts.h
"

30 
	~<m­
>

31 
	~<memÜy
>

32 
	~<mu‹x
>

33 
	~"cÚŒŞËr_hªdË.h
"

34 
	~"p_äame.h
"

35 
	~"tšÿn_cÚŒŞ.h
"

36 
Çme¥aû
 
	gtšÿn


38 
usšg
 
	g¹c
::
FeRÙ©šgLogSšk
;

39 
usšg
 
	g¹c
::
LogMes§ge
;

40 
usšg
 
	g¹c
::
Fesy¡em
;

41 
usšg
 
	g¹c
::
P©hÇme
;

42 şas 
	cCÚŒŞDi¥©ch


44 
	gpublic
:

45 
CÚŒŞDi¥©ch
();

46 ~
CÚŒŞDi¥©ch
();

47 
İ”©Ü
 (è(
	gTšÿnCÚŒŞ
 & 
	gcÚŒŞ
);

48 
S‘Di¥©chToTšÿnInf
(
TšÿnDi¥©chIÁ”çû
 * 
dtÙ
);

49 
S‘Di¥©chToLi¡’”Inf
(
Di¥©chToLi¡’”Inf
 * 
dtŞ
);

51 
	g´iv©e
:

52 
CÚfigu»Loggšg
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

53 
C»©eLšk
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

54 
C»©eIpİCÚŒŞËrRe¥Lšk
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

55 
C»©eTuÂ–
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

56 
Echo
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

57 
InjeùF¿me
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

58 
Qu”yLškSts
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

59 
Qu”yTuÂ–Info
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

60 
Qu”yCªdid©eAdd»ssS‘
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

61 
RemoveLšk
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

62 
RemoveTuÂ–
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

63 
Upd©eRou‹TabË
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

64 
LoggšgSev”™y
 
G‘LogLev–
(cÚ¡ 
¡ršg
 & 
log_Ëv–
);

65 
S’dIcc
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
);

67 
	gm­
<
	g¡ršg
, (
	gCÚŒŞDi¥©ch
::*)(
TšÿnCÚŒŞ
 & 
cÚŒŞ
)>
cÚŒŞ_m­_
;

68 
Di¥©chToLi¡’”Inf
 * 
	gdtŞ_
;

69 
TšÿnDi¥©chIÁ”çû
 * 
	gtšÿn_
;

70 
IpİCÚŒŞËrLšk
 * 
	gù¾_lšk_
;

71 
mu‹x
 
	gdi¥_mu‹x_
;

72 
	gunique_±r
<
	gFeRÙ©šgLogSšk
> 
	glog_sšk_
;

73 şas 
	cDiscÚÃùedCÚŒŞËrHªdË
 : 
vœtu®
 
public
 
IpİCÚŒŞËrLšk
 {

74 
public
:

75 
DiscÚÃùedCÚŒŞËrHªdË
() {

76 
msg_
 = "No connectiono Controllerƒxists. "

79 
	gvœtu®
 ~
DiscÚÃùedCÚŒŞËrHªdË
() = ;

80 
	g´iv©e
:

81 
vœtu®
 
D–iv”
(

82 
TšÿnCÚŒŞ
 &) {

83 
LOG
(
LS_INFO
è<< 
msg_
 << 
’dl
;

85 
vœtu®
 
D–iv”
(

86 
unique_±r
<
TšÿnCÚŒŞ
>)

88 
LOG
(
LS_INFO
è<< 
	gmsg_
 << 
	g’dl
;

90 
¡ršg
 
	gmsg_
;

	@include/control_listener.h

23 #iâdeà
TINCAN_CONTROL_LISTENER_H_


24 
	#TINCAN_CONTROL_LISTENER_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"web¹c/¹c_ba£/async_udp_sock‘.h
"

27 
	~"web¹c/¹c_ba£/async_·ck‘_sock‘.h
"

28 
	~"web¹c/¹c_ba£/loggšg.h
"

29 
	~"web¹c/¹c_ba£/thœd_·¹y/sig¦Ù/sig¦Ù.h
"

30 
	~"web¹c/¹c_ba£/sock‘_add»ss.h
"

31 
	~"web¹c/¹c_ba£/th»ad.h
"

32 
	~"web¹c/p2p/ba£/basic_·ck‘_sock‘_çùÜy.h
"

33 
	~"cÚŒŞËr_hªdË.h
"

34 
	~"cÚŒŞ_di¥©ch.h
"

35 
	~"p_äame.h
"

37 
Çme¥aû
 
	gtšÿn


40 
usšg
 
Çme¥aû
 
	g¹c
;

41 
şass
 
	gCÚŒŞLi¡’”
 :

42 
public
 
IpİCÚŒŞËrLšk
,

43 
public
 
	gDi¥©chToLi¡’”Inf
,

44 
public
 
	gsig¦Ù
::
has_¦Ùs
<>,

45 
public
 
	gRuÂabË


47 
	gpublic
:

48 
CÚŒŞLi¡’”
(
unique_±r
<
CÚŒŞDi¥©ch
> 
cÚŒŞ_di¥©ch
);

49 ~
CÚŒŞLi¡’”
();

50 
R—dPack‘HªdËr
(

51 
AsyncPack‘Sock‘
 * 
sock‘
,

52 cÚ¡ * 
d©a
,

53 
size_t
 
Ën
,

54 cÚ¡ 
Sock‘Add»ss
 & 
»mÙe_addr
,

55 cÚ¡ 
Pack‘Time
 & 
±ime
);

57 
D–iv”
(

58 
TšÿnCÚŒŞ
 & 
ù¾_»¥
è
	gov”ride
;

59 
D–iv”
(

60 
unique_±r
<
TšÿnCÚŒŞ
> 
ù¾_»¥
è
	gov”ride
;

63 
C»©eIpİCÚŒŞËrLšk
(

64 
unique_±r
<
Sock‘Add»ss
> 
cÚŒŞËr_addr


65 è
	gov”ride
;

66 
	gIpİCÚŒŞËrLšk
 & 
G‘IpİCÚŒŞËrLšk
(è
	gov”ride


68  *
	gthis
;

72 
Run
(
Th»ad
* 
th»ad
è
	gov”ride
;

74 
	g´iv©e
:

75 
unique_±r
<
CÚŒŞDi¥©ch
> 
ù¾_di¥©ch_
;

76 
	gunique_±r
<
	gAsyncPack‘Sock‘
> 
	grcv_sock‘_
;

77 
	gunique_±r
<
	gAsyncUDPSock‘
> 
	g¢d_sock‘_
;

78 
	gunique_±r
<
	gSock‘Add»ss
> 
	gù¾_addr_
;

79 
Pack‘O±iÚs
 
	g·ck‘_İtiÚs_
;

80 
	g¡d
::
mu‹x
 
skt_mu‹x_
;

	@include/controller_handle.h

23 #iâdeà
TINCAN_CONTROLLER_HANDLE_H_


24 
	#TINCAN_CONTROLLER_HANDLE_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"tšÿn_cÚŒŞ.h
"

28 
Çme¥aû
 
	gtšÿn
 {

29 şas 
	cIpİCÚŒŞËrLšk


31 
	gpublic
:

32 
vœtu®
 ~
IpİCÚŒŞËrLšk
() = ;

33 
vœtu®
 
D–iv”
(

34 
TšÿnCÚŒŞ
 & 
ù¾_»¥
) = 0;

36 
vœtu®
 
D–iv”
(

37 
unique_±r
<
TšÿnCÚŒŞ
> 
ù¾_»¥
) = 0;

40 şas 
	cDi¥©chToLi¡’”Inf


42 
	gpublic
:

43 
vœtu®
 ~
Di¥©chToLi¡’”Inf
() = ;

44 
vœtu®
 
C»©eIpİCÚŒŞËrLšk
(

45 
unique_±r
<
Sock‘Add»ss
> 
cÚŒŞËr_addr
) = 0;

46 
vœtu®
 
	gIpİCÚŒŞËrLšk
 & 
G‘IpİCÚŒŞËrLšk
() = 0;

49 şas 
	cTšÿnDi¥©chIÁ”çû


51 
	gpublic
:

52 
vœtu®
 ~
TšÿnDi¥©chIÁ”çû
() = ;

54 
vœtu®
 
C»©eTuÂ–
(

55 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
,

56 
JsÚ
::
V®ue
 & 
Šl_šfo
) = 0;

58 
vœtu®
 
C»©eVlšk
(

59 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
,

60 cÚ¡ 
TšÿnCÚŒŞ
 & 
cÚŒŞ
) = 0;

62 
vœtu®
 
InjeùF¿me
(

63 cÚ¡ 
JsÚ
::
V®ue
 & 
äame_desc
) = 0;

65 
vœtu®
 
Qu”yLškSts
(

66 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
,

67 
JsÚ
::
V®ue
 & 
node_šfo
) = 0;

69 
vœtu®
 
Qu”yTuÂ–Info
(

70 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
,

71 
JsÚ
::
V®ue
 & 
¡©e_d©a
) = 0;

73 
vœtu®
 
Qu”yLškCas
(

74 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
,

75 
JsÚ
::
V®ue
 & 
ÿs_šfo
) = 0;

77 
vœtu®
 
RemoveTuÂ–
(

78 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
) = 0;

80 
vœtu®
 
RemoveVlšk
(

81 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
) = 0;

83 
vœtu®
 
S’dIcc
(

84 cÚ¡ 
JsÚ
::
V®ue
 & 
icc_desc
) = 0;

86 
vœtu®
 
S‘IpİCÚŒŞËrLšk
(

87 
IpİCÚŒŞËrLšk
 * 
ù¾_lšk
) = 0;

89 
vœtu®
 
Upd©eRou‹TabË
(

90 cÚ¡ 
JsÚ
::
V®ue
 & 
¹s_desc
) = 0;

	@include/linux/lnx_exception.h

23 
	~"tšÿn_ba£.h
"

24 
	~<”ºo.h
>

25 
Çme¥aû
 
	gtšÿn


27 
Çme¥aû
 
	glšux


29 
	#LNXEXCEPT
(
Ex‹ndedE¼ÜInfo
è
	`LnxExû±iÚ
(Ex‹ndedE¼ÜInfo, 
__FILE__
, 
__LINE__
)

	)

30 şas 
	cLnxExû±iÚ
 : 
vœtu®
 
public
 
exû±iÚ


32 
´Ùeùed
:

33 
¡ršg
 
emsg
;

34 
	gpublic
:

35 
LnxExû±iÚ
(cÚ¡ 
¡ršg
 &
¬g
, cÚ¡ *
fe
, 
lše
)

37 
o¡ršg¡»am
 
	go¡r
;

38 
	go¡r
 << 
	gfe
 << ":" << 
	glše
 << ": " << 
	g¬g
 << "@" << 
¡»¼Ü
(
”ºo
);

39 
	gemsg
 = 
o¡r
.
¡r
();

42 
LnxExû±iÚ
()

45 ~
LnxExû±iÚ
()

48 cÚ¡ * 
wh©
(ècÚ¡ 
_GLIBCXX_USE_NOEXCEPT
 
	gov”ride


50  
	gemsg
.
c_¡r
();

	@include/linux/tapdev_lnx.h

23 #iâdeà
TINCAN_TAPDEV_LNX_H_


24 
	#TINCAN_TAPDEV_LNX_H_


	)

25 #ià
defšed
 (
_IPOP_LINUX
)

27 
	~"async_io.h
"

28 
	~"pdev_šf.h
"

29 
	~"tšÿn_ba£.h
"

31 
	~"web¹c/¹c_ba£/loggšg.h
"

32 
	~"web¹c/¹c_ba£/th»ad.h
"

33 
	~"web¹c/¹c_ba£/sig¦Ù.h
"

35 
	~<sys/ioùl.h
>

36 
	~<fú.h
>

37 
	~<sys/ioùl.h
>

38 
	~<sys/ty³s.h
>

39 
	~<sys/sock‘.h
>

40 
	~<Ãt/if.h
>

41 
	~<lšux/if_tun.h
>

42 
	~<Ãt/rou‹.h
>

43 
	~<¬·/š‘.h
>

44 
	~<uni¡d.h
>

46 
Çme¥aû
 
	gtšÿn


49 
Çme¥aû
 
	glšux


51 
usšg
 
	g¹c
::
Mes§ge
;

52 
usšg
 
	g¹c
::
Mes§geD©a
;

53 
usšg
 
	g¹c
::
Mes§geHªdËr
;

54 
şass
 
	gT­DevLnx
 :

55 
public
 
T­DevInf
,

56 
public
 
	gMes§geHªdËr


58 
	gpublic
:

59 
T­DevLnx
();

60 
	gvœtu®
 ~
T­DevLnx
();

61 
	gsig¦Ù
::
sigÇl1
<
AsyncIo
 *> 
»ad_com¶‘iÚ_
;

62 
	gsig¦Ù
::
sigÇl1
<
AsyncIo
 *> 
wr™e_com¶‘iÚ_
;

63 
O³n
(

64 cÚ¡ 
T­DesütÜ
 & 
p_desc
è
	gov”ride
;

65 
Clo£
(è
	gov”ride
;

66 
ušt32_t
 
R—d
(
AsyncIo
& 
aio_rd
è
	gov”ride
;

67 
ušt32_t
 
Wr™e
(
AsyncIo
& 
aio_wr
è
	gov”ride
;

68 
ušt16_t
 
Mtu
(è
	gov”ride
;

69 
Up
(è
	gov”ride
;

70 
Down
(è
	gov”ride
;

71 
MacAdd»ssTy³
 
MacAdd»ss
(è
	gov”ride
;

72 
IP4Add»ssTy³
 
Ip4
(è
	gov”ride
;

73 
	g´Ùeùed
:

74 
OnMes§ge
(
Mes§ge
 * 
msg
è
ov”ride
;

75 
	g´iv©e
:

76 
unique_±r
<
¹c
::
Th»ad
> 
»ad”_
;

77 
	gunique_±r
<
	g¹c
::
Th»ad
> 
wr™”_
;

78 
iäeq
 
	giä_
;

79 
	gfd_
;

80 
IP4Add»ssTy³
 
	g4_
;

81 
MacAdd»ssTy³
 
	gmac_
;

83 
boŞ
 
	gis_good_
;

84 
S‘FÏgs
(
a
, 
b
);

85 
PËnToIpv4Mask
(
a
, 
sockaddr
 *
b
);

	@include/multi_link_tunnel.h

23 #iâdeà
TINCAN_VIRTUAL_NETWORK_H_


24 
	#TINCAN_VIRTUAL_NETWORK_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"basic_tuÂ–.h
"

27 
Çme¥aû
 
	gtšÿn


29 şas 
	cMuÉiLškTuÂ–
 :

30 
public
 
BasicTuÂ–


32 
public
:

34 
MuÉiLškTuÂ–
(

35 
unique_±r
<
TuÂ–DesütÜ
> 
desütÜ
,

36 
IpİCÚŒŞËrLšk
 * 
ù¾_hªdË
);

38 ~
MuÉiLškTuÂ–
();

40 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
C»©eVlšk
(

41 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

42 
unique_±r
<
P“rDesütÜ
> 
³”_desc
è
	gov”ride
;

44 
Qu”yInfo
(

45 
JsÚ
::
V®ue
 & 
Šl_šfo
è
ov”ride
;

47 
Qu”yLškCas
(

48 cÚ¡ 
¡ršg
 & 
vlšk_id
,

49 
JsÚ
::
V®ue
 & 
ÿs_šfo
è
ov”ride
;

51 
Qu”yLškIds
(

52 
veùÜ
<
¡ršg
> & 
lšk_ids
è
	gov”ride
;

54 
Qu”yLškInfo
(

55 cÚ¡ 
¡ršg
 & 
vlšk_id
,

56 
JsÚ
::
V®ue
 & 
vlšk_šfo
è
ov”ride
;

58 
Shutdown
(è
	gov”ride
;

60 
S’dIcc
(

61 cÚ¡ 
¡ršg
 & 
»c›Á_mac
,

62 cÚ¡ 
¡ršg
 & 
d©a
è
	gov”ride
;

64 
S¹
(è
	gov”ride
;

66 
RemoveLšk
(

67 cÚ¡ 
¡ršg
 & 
vlšk_id
è
	gov”ride
;

69 
Upd©eRou‹TabË
(

70 cÚ¡ 
JsÚ
::
V®ue
 & 
¹_desü
è
ov”ride
;

73 
VlškR—dCom¶‘e
(

74 
ušt8_t
 * 
d©a
,

75 
ušt32_t
 
d©a_Ën
,

76 
Vœtu®Lšk
 & 
vlšk
è
	gov”ride
;

79 
T­R—dCom¶‘e
(

80 
AsyncIo
 * 
aio_rd
);

81 
T­Wr™eCom¶‘e
(

82 
AsyncIo
 * 
aio_wr
è
	gov”ride
;

84 
	g´iv©e
:

85 
unique_±r
<
P“rN‘wÜk
> 
³”_ÃtwÜk_
;

86 
	g¹c
::
Th»ad
 
³”_Ãt_th»ad_
;

	@include/peer_descriptor.h

23 #ià!
defšed
(
TINCAN_PEER_DESCRIPTOR_H_
)

24 
	#TINCAN_PEER_DESCRIPTOR_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
Çme¥aû
 
	gtšÿn


29 
	sP“rDesütÜ


31 
¡ršg
 
	guid
;

32 
¡ršg
 
	gv4
;

33 
¡ršg
 
	gfšg”´št
;

34 
¡ršg
 
	gmac_add»ss
;

35 
¡ršg
 
	gÿs
;

	@include/peer_network.h

23 #ià!
defšed
(
_TINCAN_PEER_NETWORK_H_
)

24 
	#_TINCAN_PEER_NETWORK_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"vœtu®_lšk.h
"

27 
	~<¥¬£µ/¥p.h
>

29 
usšg
 
	g¥p
::
¥¬£_hash_m­
;

31 
Çme¥aû
 
	gtšÿn


33 şas 
	cP“rN‘wÜk
 :

34 
public
 
RuÂabË


36 
public
:

37 
P“rN‘wÜk
();

38 ~
P“rN‘wÜk
();

39 
Add
(
sh¬ed_±r
<
Vœtu®Lšk
> 
vlšk
);

40 
CË¬
();

41 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
G‘Rou‹
(cÚ¡ 
MacAdd»ssTy³
 & 
mac
);

42 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
G‘Vlšk
(cÚ¡ 
¡ršg
 & 
mac
);

43 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
G‘Vlšk
(cÚ¡ 
MacAdd»ssTy³
 & 
mac
);

44 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
G‘VlškById
(cÚ¡ 
¡ršg
 & 
lšk_id
);

45 
boŞ
 
Exi¡s
(cÚ¡ 
¡ršg
 & 
lšk_id
);

46 
boŞ
 
IsAdjaûÁ
(cÚ¡ 
¡ršg
 & 
mac
);

47 
boŞ
 
IsAdjaûÁ
(cÚ¡ 
MacAdd»ssTy³
& 
mac
);

48 
boŞ
 
IsRou‹Exi¡s
(cÚ¡ 
MacAdd»ssTy³
& 
mac
);

49 
	gveùÜ
<
	g¡ršg
> 
Qu”yVlšks
();

50 
Remove
(cÚ¡ 
¡ršg
 & 
lšk_id
);

51 
Upd©eRou‹TabË
(
MacAdd»ssTy³
 & 
de¡
, MacAdd»ssTy³ & 
rou‹
);

52 
	g´iv©e
:

53 
	sMacAdd»ssHash”


55 
size_t
 
İ”©Ü
()(cÚ¡ 
MacAdd»ssTy³
& 
mac
) const

57 
size_t
 
h
 = 0;

58 autØ
	ge
 : 
mac
)

60 
h
 ^ğ
hash
<
ušt8_t
>{}(
e
)+0x9e3779b9 + (h << 6) + (h >> 2);

62  
	gh
;

65 
	sWidth6t8


67 
size_t
 
İ”©Ü
()(cÚ¡ 
	gMacAdd»ssTy³
& 
	gmac
) const

69 
size_t
 
	gh
 = 0;

70 
memıy
(&
h
, 
mac
.
d©a
(), 6);

71  
	gh
;

74 
	sHubEx


76 
HubEx
(è: 
acûs£d
(
¡—dy_şock
::
now
())

78 
sh¬ed_±r
<
Vœtu®Lšk
> 
vl
;

79 
	g¡—dy_şock
::
time_pošt
 
acûs£d
;

81 
mu‹x
 
	gmac_m­_mtx_
;

82 
	gunÜd”ed_m­
<
	g¡ršg
, 
	gsh¬ed_±r
<
	gVœtu®Lšk
>> 
	glšk_m­_
;

84 
	g¥¬£_hash_m­
<
	gMacAdd»ssTy³
, 
	gsh¬ed_±r
<
	gVœtu®Lšk
>, 
	gMacAdd»ssHash”
>
	gmac_m­_
;

85 
	gunÜd”ed_m­
<
	gMacAdd»ssTy³
, 
	gHubEx
, 
	gMacAdd»ssHash”
> 
	gmac_rou‹s_
;

86 
Run
(
Th»ad
* 
th»ad
è
	gov”ride
;

87 
mli£cÚds
 cÚ¡ 
	gsÿv’ge_š‹rv®
;

	@include/single_link_tunnel.h

23 #iâdeà
SINGLE_LINK_TUNNEL_H_


24 
	#SINGLE_LINK_TUNNEL_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"basic_tuÂ–.h
"

28 
Çme¥aû
 
	gtšÿn


30 şas 
	cSšgËLškTuÂ–
 :

31 
public
 
BasicTuÂ–


33 
public
:

34 
SšgËLškTuÂ–
(

35 
unique_±r
<
TuÂ–DesütÜ
> 
desütÜ
,

36 
IpİCÚŒŞËrLšk
 * 
ù¾_hªdË
);

37 
	gvœtu®
 ~
SšgËLškTuÂ–
() = ;

39 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
C»©eVlšk
(

40 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

41 
unique_±r
<
P“rDesütÜ
> 
³”_desc
è
	gov”ride
;

43 
Qu”yInfo
(

44 
JsÚ
::
V®ue
 & 
Šl_šfo
è
ov”ride
;

46 
Qu”yLškCas
(

47 cÚ¡ 
¡ršg
 & 
vlšk_id
,

48 
JsÚ
::
V®ue
 & 
ÿs_šfo
è
ov”ride
;

50 
Qu”yLškIds
(

51 
veùÜ
<
¡ršg
> & 
lšk_ids
è
	gov”ride
;

53 
Qu”yLškInfo
(

54 cÚ¡ 
¡ršg
 & 
vlšk_id
,

55 
JsÚ
::
V®ue
 & 
vlšk_šfo
è
ov”ride
;

57 
S’dIcc
(

58 cÚ¡ 
¡ršg
 & 
»c›Á_mac
,

59 cÚ¡ 
¡ršg
 & 
d©a
è
	gov”ride
;

63 
Shutdown
(è
	gov”ride
;

65 
S¹Io
(è
	gov”ride
;

67 
StİIo
(è
	gov”ride
;

69 
RemoveLšk
(

70 cÚ¡ 
¡ršg
 & 
vlšk_id
è
	gov”ride
;

72 
Upd©eRou‹TabË
(

73 cÚ¡ 
JsÚ
::
V®ue
 & 
¹_desü
è
ov”ride
;

77 
VlškR—dCom¶‘e
(

78 
ušt8_t
 * 
d©a
,

79 
ušt32_t
 
d©a_Ën
,

80 
Vœtu®Lšk
 & 
vlšk
è
	gov”ride
;

83 
T­R—dCom¶‘e
(

84 
AsyncIo
 * 
aio_rd
);

85 
T­Wr™eCom¶‘e
(

86 
AsyncIo
 * 
aio_wr
è
	gov”ride
;

88 
	g´iv©e
:

89 
sh¬ed_±r
<
Vœtu®Lšk
> 
vlšk_
;

	@include/tap_frame.h

23 #iâdeà
TINCAN_TAP_FRAME_H_


24 
	#TINCAN_TAP_FRAME_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"async_io.h
"

27 
Çme¥aû
 
	gtšÿn


29 
TšÿnP¬am‘”s
 

;

36 
usšg
 
	gT­F¿meBufãr
 = 
¬¿y
<
ušt8_t
, 
	g
.
	gkT­BufãrSize
>;

45 şas 
	cT­F¿me
 : 
vœtu®
 
public
 
AsyncIo


47 
ä›nd
 
şass
 
T­F¿meCache
;

48 
ä›nd
 
şass
 
	gT­F¿mePrİ”t›s
;

49 
	gpublic
:

50 
T­F¿me
();

52 
T­F¿me
(cÚ¡ T­F¿m& 
rhs
);

54 
T­F¿me
(T­F¿m&& 
rhs
);

57 
T­F¿me
(
ušt8_t
* 
d©a
, 
ušt32_t
 
Ën
);

59 
	gvœtu®
 ~
T­F¿me
();

62 
	gT­F¿me
 &
	gİ”©Ü
ğ(
T­F¿me
 & 
rhs
);

64 
	gT­F¿me
 &
	gİ”©Ü
ğ(
T­F¿me
 && 
rhs
);

67 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
T­F¿me
 & 
rhs
) const;

69 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
T­F¿me
 & 
rhs
) const;

71 
boŞ
 
	gİ”©Ü
 !() const;

74 
	gušt8_t
 & 
	gİ”©Ü
[](
ušt32_t
 
	gšdex
);

76 cÚ¡ 
	gušt8_t
 & 
	gİ”©Ü
[](
ušt32_t
 cÚ¡ 
	gšdex
) const;

78 
	gT­F¿me
 & 
In™Ÿlize
();

80 
	gT­F¿me
 & 
In™Ÿlize
(

81 
ušt8_t
 * 
bufãr_to_Œªsãr
,

82 
ušt32_t
 
by‹s_to_Œªsãr
,

83 
AIO_OP
 
æags
 = 
AIO_READ
,

84 
ušt32_t
 
by‹s_Œªsã¼ed
 = 0);

86 
H—d”
(
ušt16_t
 
v®
);

88 
ušt8_t
 * 
Begš
();

90 
ušt8_t
 * 
End
();

92 
ušt32_t
 
L’gth
();

94 
ušt32_t
 
C­ac™y
() const;

96 
ušt8_t
 * 
Paylßd
();

98 
ušt8_t
 * 
PaylßdEnd
();

100 
ušt32_t
 
PaylßdL’gth
();

102 
PaylßdL’gth
(
ušt32_t
 
Ëngth
);

104 
ušt32_t
 
PaylßdC­ac™y
();

106 
Dump
(cÚ¡ 
¡ršg
 & 
Ïb–
);

107 
	g´Ùeùed
:

108 
T­F¿meBufãr
 * 
tfb_
;

109 
ušt32_t
 
	g¶_Ën_
;

114 şas 
	cIccMes§ge
 :

115 
public
 
T­F¿me


117 
public
:

118 
Mes§ge
(

119 
ušt8_t
 * 
š_buf
,

120 
ušt32_t
 
buf_Ën
);

124 şas 
	cDtfMes§ge
 :

125 
public
 
T­F¿me


127 
public
:

128 
Mes§ge
(

129 
ušt8_t
 * 
š_buf
,

130 
ušt32_t
 
buf_Ën
);

133 şas 
	cFwdMes§ge
 :

134 
public
 
T­F¿me


136 
public
:

137 
Mes§ge
(

138 
ušt8_t
 * 
š_buf
,

139 
ušt32_t
 
buf_Ën
);

144 şas 
	cT­F¿mePrİ”t›s


146 
	gpublic
:

147 
T­F¿mePrİ”t›s
(
T­F¿me
 & 
tf
) :

148 
tf_
(
tf
)

151 
boŞ
 
IsIccMsg
() const

153 
ušt16_t
 
magic
 = 

.
kIccMagic
;

154  
memcmp
(
tf_
.
Begš
(), &
magic
, 

.
kT­H—d”Size
) == 0;

156 
boŞ
 
IsFwdMsg
() const

158 
ušt16_t
 
	gmagic
 = 

.
kFwdMagic
;

159  
memcmp
(
tf_
.
Begš
(), &
magic
, 

.
kT­H—d”Size
) == 0;

161 
boŞ
 
IsDtfMsg
() const

163 
ušt16_t
 
	gmagic
 = 

.
kDtfMagic
;

164  
memcmp
(
tf_
.
Begš
(), &
magic
, 

.
kT­H—d”Size
) == 0;

166 
boŞ
 
IsIp4
()

168 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

169 
IpOff£ts
 
	gp
 = 
‘h
.
Paylßd
();

170  *(
	gušt16_t
*)
	g‘h
.
Ty³
(è=ğ0x0008 && *
p
.
V”siÚ
() >> 4 == 4;

173 
boŞ
 
IsIp6
()

175 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

176 
IpOff£ts
 
	gp
 = 
‘h
.
Paylßd
();

177  *(
	gušt16_t
*)
	g‘h
.
Ty³
(è=ğ0x0008 && *
p
.
V”siÚ
() >> 4 == 6;

180 
boŞ
 
IsA½Reque¡
()

182 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

183  *(
	gušt16_t
*)
	g‘h
.
Ty³
(è=ğ0x0608 && (*(
‘h
.
Paylßd
()+7) == 0x01);

186 
boŞ
 
IsA½Re¥Ú£
()

188 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

189  *(
	gušt16_t
*)
	g‘h
.
Ty³
(è=ğ0x0608 && (*(
‘h
.
Paylßd
() + 7) == 0x02);

192 
boŞ
 
IsEth”ÃtBrßdÿ¡
()

194 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

195  
memcmp
(
‘h
.
De¡š©iÚMac
(), "\xFF\xFF\xFF\xFF\xFF\xFF", 6) == 0;

198 
	gIP4Add»ssTy³
 & 
De¡š©iÚIp4Add»ss
()

200 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

201 
IpOff£ts
 
	gp
 = 
‘h
.
Paylßd
();

202  *(
	gIP4Add»ssTy³
*)
	gp
.
De¡š©iÚIp
();

205 
	gIP4Add»ssTy³
 & 
SourûIp4Add»ss
()

207 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

208 
IpOff£ts
 
	gp
 = 
‘h
.
Paylßd
();

209  *(
	gIP4Add»ssTy³
*)
	gp
.
SourûIp
();

212 
	gIP4Add»ssTy³
 & 
A½De¡š©iÚIp4Add»ss
()

214 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

215 
A½Off£ts
 
	g¬p
 = 
‘h
.
Paylßd
();

216  *(
	gIP4Add»ssTy³
*)
	g¬p
.
De¡š©iÚIp
();

219 
	gIP4Add»ssTy³
 & 
A½SourûIp4Add»ss
()

221 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

222 
A½Off£ts
 
	g¬p
 = 
‘h
.
Paylßd
();

223  *(
	gIP4Add»ssTy³
*)
	g¬p
.
SourûIp
();

226 
	gMacAdd»ssTy³
 & 
De¡š©iÚMac
()

228 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

229  *(
	gMacAdd»ssTy³
 *)(
	g‘h
.
De¡š©iÚMac
());

232 
	gMacAdd»ssTy³
 & 
SourûMac
()

234 
EthOff£ts
 
	g‘h
 = 
tf_
.
Paylßd
();

235  *(
	gMacAdd»ssTy³
 *)(
	g‘h
.
SourûMac
());

238 
	g´iv©e
:

239 
T­F¿me
 & 
tf_
;

243 şas 
	cIP4Add»ssM­³r


245 
	gpublic
:

246 
IP4Add»ssM­³r
(

247 
T­F¿me
 & 
tf
,

248 
T­F¿mePrİ”t›s
 & 
å
) :

249 
tf_
(
tf
), 
å_
(
å
)

252 
CheckAndP©ch
(

253 cÚ¡ 
IP4Add»ssTy³
& 
tuÂ–_4_¤c
,

254 cÚ¡ 
IP4Add»ssTy³
& 
loÿl_4
)

256 ià(
	gå_
.
IsA½Re¥Ú£
(è|| fp_.
IsA½Reque¡
())

259 
	gIP4Add»ssTy³
& 
	g¬p_pkt_¤c_
 = 
å_
.
A½SourûIp4Add»ss
();

260 
	gIP4Add»ssTy³
& 
	g¬p_pkt_des_
 = 
å_
.
A½De¡š©iÚIp4Add»ss
();

261 ià(
	g¬p_pkt_¤c_
 !ğ
tuÂ–_4_¤c
)

263 
¬p_pkt_¤c_
 = 
tuÂ–_4_¤c
;

264 
	g¬p_pkt_des_
 = 
loÿl_4
;

267 ià(
	gå_
.
IsIp4
())

270 
	gIP4Add»ssTy³
& 
	g_pkt_¤c
 = 
å_
.
SourûIp4Add»ss
();

271 
	gIP4Add»ssTy³
& 
	g_pkt_des
 = 
å_
.
De¡š©iÚIp4Add»ss
();

272 ià(
	g_pkt_¤c
 !ğ
tuÂ–_4_¤c
)

274 
_pkt_¤c
 = 
tuÂ–_4_¤c
;

275 
	g_pkt_des
 = 
loÿl_4
;

280 
	g´iv©e
:

281 
T­F¿me
 & 
tf_
;

282 
	gT­F¿mePrİ”t›s
 & 
	gå_
;

	@include/tapdev.h

23 #iâdeà
TINCAN_TAPDEV_H_


24 
	#TINCAN_TAPDEV_H_


	)

26 #ià
defšed
(
_IPOP_LINUX
)

27 
	~"lšux/pdev_Êx.h
"

28 #–ià
defšed
(
_IPOP_WIN
)

29 
	~"wšdows/pdev_wš.h
"

32 
Çme¥aû
 
	gtšÿn
 {

34 #ià
defšed
(
_IPOP_LINUX
)

35 
usšg
 
	gT­Dev
 = 
lšux
::
T­DevLnx
;

36 #–ià
defšed
(
_IPOP_WIN
)

37 
usšg
 
	gT­Dev
 = 
wšdows
::
T­DevWš
;

	@include/tapdev_inf.h

23 #iâdeà
TINCAN_TAPDEV_INF_H_


24 
	#TINCAN_TAPDEV_INF_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"async_io.h
"

27 
	~"p_äame.h
"

28 
	~"web¹c/¹c_ba£/th»ad.h
"

30 
Çme¥aû
 
	gtšÿn


32 
usšg
 
	g¹c
::
Mes§ge
;

33 
usšg
 
	g¹c
::
Mes§geD©a
;

34 
usšg
 
	g¹c
::
Mes§geHªdËr
;

36 
	sT­DesütÜ


38 
¡ršg
 
	gÇme
;

39 
¡ršg
 
	g4
;

40 
ušt32_t
 
	g´efix4
;

41 
ušt32_t
 
	gmtu4
;

42 
¡ršg
 
	g6
;

43 
ušt32_t
 
	g´efix6
;

44 
ušt32_t
 
	gmtu6
;

46 şas 
	cT­DevInf


48 
	gpublic
:

49 
	eMSG_ID


51 
MSGID_READ
,

52 
	gMSGID_WRITE
,

54 şas 
	cT­Mes§geD©a
 :

55 
public
 
Mes§geD©a


57 
public
:

58 
AsyncIo
 * 
aio_
;

61 
	gvœtu®
 ~
T­DevInf
() = ;

62 
vœtu®
 
O³n
(

63 cÚ¡ 
T­DesütÜ
 & 
p_desc
) = 0;

65 
vœtu®
 
Clo£
() = 0;

67 
vœtu®
 
Up
() = 0;

69 
vœtu®
 
Down
() = 0;

71 
vœtu®
 
ušt32_t
 
R—d
(

72 
AsyncIo
 & 
aio_rd
) = 0;

74 
vœtu®
 
ušt32_t
 
Wr™e
(

75 
AsyncIo
 & 
aio_wr
) = 0;

77 
vœtu®
 
MacAdd»ssTy³
 
MacAdd»ss
() = 0;

79 
vœtu®
 
IP4Add»ssTy³
 
Ip4
() = 0;

81 
vœtu®
 
ušt16_t
 
Mtu
() = 0;

	@include/tincan.h

23 #iâdeà
TINCAN_TINCAN_H_


24 
	#TINCAN_TINCAN_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"web¹c/¹c_ba£/ev’t.h
"

27 
	~"cÚŒŞ_li¡’”.h
"

28 
	~"cÚŒŞ_di¥©ch.h
"

29 
	~"sšgË_lšk_tuÂ–.h
"

30 
	~"muÉi_lšk_tuÂ–.h
"

32 
Çme¥aû
 
	gtšÿn
 {

33 
şass
 
	gTšÿn
 :

34 
public
 
TšÿnDi¥©chIÁ”çû
,

35 
public
 
	gsig¦Ù
::
has_¦Ùs
<>

37 
public
:

38 
Tšÿn
();

39 ~
Tšÿn
();

43 
C»©eVlšk
(

44 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
,

45 cÚ¡ 
TšÿnCÚŒŞ
 & 
cÚŒŞ
è
	gov”ride
;

47 
C»©eTuÂ–
(

48 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
,

49 
JsÚ
::
V®ue
 & 
Šl_šfo
è
ov”ride
;

51 
InjeùF¿me
(

52 cÚ¡ 
JsÚ
::
V®ue
 & 
äame_desc
è
ov”ride
;

54 
Qu”yLškSts
(

55 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
,

56 
JsÚ
::
V®ue
 & 
node_šfo
è
ov”ride
;

58 
Qu”yTuÂ–Info
(

59 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
,

60 
JsÚ
::
V®ue
 & 
node_šfo
è
ov”ride
;

62 
RemoveTuÂ–
(

63 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
è
ov”ride
;

65 
RemoveVlšk
(

66 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
è
ov”ride
;

68 
S’dIcc
(

69 cÚ¡ 
JsÚ
::
V®ue
 & 
icc_desc
è
ov”ride
;

71 
S‘IpİCÚŒŞËrLšk
(

72 
IpİCÚŒŞËrLšk
 * 
ù¾_hªdË
è
	gov”ride
;

74 
Upd©eRou‹TabË
(

75 cÚ¡ 
JsÚ
::
V®ue
 & 
¹s_desc
è
ov”ride
;

78 
OnLoÿlCasUpd©ed
(

79 
¡ršg
 
lšk_id
,

80 
¡ršg
 
lÿs
);

82 
Qu”yLškCas
(

83 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
,

84 
JsÚ
::
V®ue
 & 
ÿs_šfo
);

86 
Run
();

87 
	g´iv©e
:

88 
boŞ
 
IsTuÂ–Exis™
(

89 cÚ¡ 
¡ršg
 & 
Šl_id
);

91 
	gBasicTuÂ–
 & 
TuÂ–FromId
(

92 cÚ¡ 
¡ršg
 & 
Šl_id
);

94 
OnStİ
();

95 
Shutdown
();

97 #ià
defšed
(
_IPOP_WIN
)

98 
BOOL
 
__¡dÿÎ
 
CÚŒŞHªdËr
(

99 
DWORD
 
CŒlTy³
);

102 
	gveùÜ
<
	gunique_±r
<
	gBasicTuÂ–
>> 
	gtuÂ–s_
;

103 
IpİCÚŒŞËrLšk
 * 
	gù¾_lšk_
;

104 
	gm­
<
	g¡ršg
, 
	gunique_±r
<
	gTšÿnCÚŒŞ
>> 
	gš´ogess_cÚŒŞs_
;

105 
Th»ad
 
	gùl_th»ad_
;

106 
	gsh¬ed_±r
<
	gCÚŒŞLi¡’”
> 
	gù¾_li¡’”_
;

107 
Tšÿn
 * 
	g£lf_
;

108 
	g¡d
::
mu‹x
 
tuÂ–s_mu‹x_
;

109 
	g¡d
::
mu‹x
 
š´ogess_cÚŒŞs_mu‹x_
;

110 
	g¹c
::
Ev’t
 
ex™_ev’t_
;

	@include/tincan_base.h

23 #iâdeà
TINCAN_BASE_H_


24 
	#TINCAN_BASE_H_


	)

25 
	~<ÿs£¹
>

26 
	~<c¡ddef
>

27 
	~<c¡dio
>

28 
	~<c¡ršg
>

29 
	~<c¡dlib
>

30 
	~<c¡dšt
>

31 
	~<¬¿y
>

32 
	~<chrÚo
>

33 
	~<exû±iÚ
>

34 
	~<iomª
>

35 
	~<io¡»am
>

36 
	~<li¡
>

37 
	~<m­
>

38 
	~<memÜy
>

39 
	~<mu‹x
>

40 
	~<s¡»am
>

41 
	~<¡ack
>

42 
	~<¡ršg
>

43 
	~<ut™y
>

44 
	~<unÜd”ed_m­
>

45 
	~<veùÜ
>

46 
Çme¥aû
 
	gtšÿn


48 
usšg
 
	gMacAdd»ssTy³
 = 
¡d
::
¬¿y
<
ušt8_t
, 6>;

49 
usšg
 
	gIP4Add»ssTy³
 = 
¡d
::
¬¿y
<
ušt8_t
, 4>;

51 
usšg
 
	g¡d
::
¬¿y
;

52 
usšg
 
	g¡d
::
chrÚo
::
mli£cÚds
;

53 
usšg
 
	g¡d
::
chrÚo
::
¡—dy_şock
;

54 
usšg
 
	g¡d
::
cout
;

55 
usšg
 
	g¡d
::
’dl
;

56 
usšg
 
	g¡d
::
exû±iÚ
;

57 
usšg
 
	g¡d
::
hash
;

58 
usšg
 
	g¡d
::
i¡ršg¡»am
;

59 
usšg
 
	g¡d
::
li¡
;

60 
usšg
 
	g¡d
::
lock_gu¬d
;

61 
usšg
 
	g¡d
::
make_·œ
;

62 
usšg
 
	g¡d
::
make_sh¬ed
;

63 
usšg
 
	g¡d
::
make_unique
;

64 
usšg
 
	g¡d
::
m­
;

65 
usšg
 
	g¡d
::
memıy
;

66 
usšg
 
	g¡d
::
mli
;

67 
usšg
 
	g¡d
::
move
;

68 
usšg
 
	g¡d
::
mu‹x
;

69 
usšg
 
	g¡d
::
·œ
;

70 
usšg
 
	g¡d
::
o¡ršg¡»am
;

71 
usšg
 
	g¡d
::
out_of_¿nge
;

72 
usšg
 
	g¡d
::
sh¬ed_±r
;

73 
usšg
 
	g¡d
::
¡ack
;

74 
usšg
 
	g¡d
::
¡ršg
;

75 
usšg
 
	g¡d
::
¡ršg¡»am
;

76 
usšg
 
	g¡d
::
unique_±r
;

77 
usšg
 
	g¡d
::
unÜd”ed_m­
;

78 
usšg
 
	g¡d
::
veùÜ
;

81 
	sTšÿnP¬am‘”s


83 
	gpublic
:

84 
TšÿnP¬am‘”s
()

85 : 
kV”siÚCheck
(
çl£
), 
kN“dsH–p
(çl£), 
kUdpPÜt
(5800), 
kLškCÚcu¼’tAIO
(2)

88 
P¬£CmdlšeArgs
(

89 
¬gc
,

90 **
¬gs
)

92 
	gi
 = 1; i < 
	g¬gc
; i++)

94 ià(
¡ºcmp
(
¬gs
[
i
], "-p=", 3) == 0)

96 
i¡ršg¡»am
 
¡»am
(
¬gs
[
i
]);

97 
	g¡»am
.
ignÜe
(3);

98 
	gpÜt
;

99 
	gc
;

100 ià(!(
	g¡»am
 >> 
	gpÜt
è|| sŒ—m.
g‘
(
c
))

102 
	gkN“dsH–p
 = 
Œue
;

107 ià(
	gpÜt
 >ğ0 && 
pÜt
 <ğ
UINT16_MAX
)

109 
kUdpPÜt
 = 
¡©ic_ÿ¡
<
ušt16_t
>(
pÜt
);

113 
	gkN“dsH–p
 = 
Œue
;

118 ià(
¡ºcmp
(
¬gs
[
i
], "-i=", 3) == 0)

120 
i¡ršg¡»am
 
¡»am
(
¬gs
[
i
]);

121 
	g¡»am
.
ignÜe
(3);

122 
	gcouÁ
;

123 
	gc
;

124 ià(!(
	g¡»am
 >> 
	gcouÁ
è|| sŒ—m.
g‘
(
c
))

126 
	gkN“dsH–p
 = 
Œue
;

131 ià(
	gcouÁ
 > 32)

133 
	gkLškCÚcu¼’tAIO
 = 32;

135 ià(
	gcouÁ
 < 0)

137 
	gkN“dsH–p
 = 
Œue
;

142 
	gkLškCÚcu¼’tAIO
 = 
¡©ic_ÿ¡
<
ušt8_t
>(
couÁ
);

146 ià(
¡ºcmp
(
¬gs
[
i
], "-v", 2) == 0)

148 
kV”siÚCheck
 = 
Œue
;

152 
	gkN“dsH–p
 = 
Œue
;

157 cÚ¡ 
ušt16_t
 
	gkTšÿnV”Mjr
 = 3;

158 cÚ¡ 
ušt16_t
 
	gkTšÿnV”MÄ
 = 0;

159 cÚ¡ 
ušt16_t
 
	gkTšÿnV”Rev
 = 0;

160 cÚ¡ 
ušt8_t
 
	gkTšÿnCÚŒŞV”
 = 5;

161 cÚ¡ 
ušt8_t
 
	gkTšÿnLškV”
 = 1;

162 cÚ¡ 
ušt16_t
 
	gkMaxMtuSize
 = 1500;

163 cÚ¡ 
ušt16_t
 
	gkT­H—d”Size
 = 2;

164 cÚ¡ 
ušt16_t
 
	gkEthH—d”Size
 = 14;

165 cÚ¡ 
ušt16_t
 
	gkEth”ÃtSize
 = 
kEthH—d”Size
 + 
kMaxMtuSize
;

166 cÚ¡ 
ušt16_t
 
	gkT­BufãrSize
 = 
kT­H—d”Size
 + 
kEth”ÃtSize
;

167 cÚ¡ 
ušt8_t
 
	gkFT_DTF
 = 0x0A;

168 cÚ¡ 
ušt8_t
 
	gkFT_FWD
 = 0x0B;

169 cÚ¡ 
ušt8_t
 
	gkFT_ICC
 = 0x0C;

170 cÚ¡ 
ušt16_t
 
	gkDtfMagic
 = 0x0A01;

171 cÚ¡ 
ušt16_t
 
	gkFwdMagic
 = 0x0B01;

172 cÚ¡ 
ušt16_t
 
	gkIccMagic
 = 0x0C01;

173 cÚ¡ 
	gkCªdid©eD–im
 = ':';

174 cÚ¡ * cÚ¡ 
	gkIûUäag
 = "_001IPOPICEUFRAG";

175 cÚ¡ * cÚ¡ 
	gkIûPwd
 = "_00000001IPOPICEPASSWORD";

176 cÚ¡ * cÚ¡ 
	gkLoÿlHo¡
 = "127.0.0.1";

177 cÚ¡ * cÚ¡ 
	gkLoÿlHo¡6
 = "::1";

178 
boŞ
 
	gkV”siÚCheck
;

179 
boŞ
 
	gkN“dsH–p
;

180 
ušt16_t
 
	gkUdpPÜt
;

181 
ušt8_t
 
	gkLškCÚcu¼’tAIO
;

184 
	g‹m¶©e
<
ty³Çme
 
	gIÅutI‹r
>

185 
¡ršg
 
By‹A¼ayToSŒšg
(

186 
IÅutI‹r
 
fœ¡
,

187 
IÅutI‹r
 
Ï¡
,

188 
ušt32_t
 
lše_b»aks
 = 0,

189 
boŞ
 
u£_£p
 = 
çl£
,

190 
£p
 = ':',

191 
boŞ
 
u£_uµ”ÿ£
 = 
Œue
)

193 
as£¹
((*
fœ¡
) == 1);

194 
o¡ršg¡»am
 
	goss
;

195 
	goss
 << 
	g¡d
::
hex
 << 
¡d
::
£tfl
('0');

196 if(
	gu£_uµ”ÿ£
)

197 
	goss
 << 
	g¡d
::
uµ”ÿ£
;

198 
	gi
 = 0;

199 
	gfœ¡
 !ğ
Ï¡
)

201 
oss
 << 
¡d
::
£tw
(2è<< 
¡©ic_ÿ¡
<>(*
fœ¡
++);

202 if(
	gu£_£p
 && 
	gfœ¡
 !ğ
Ï¡
)

203 
oss
 << 
£p
;

204 if(
	glše_b»aks
 && !(++
	gi
 %†še_b»aks)è
	goss
 << 
	g’dl
;

206  
	goss
.
¡r
();

209 
	g‹m¶©e
<
ty³Çme
 
	gOuutI‹r
>

210 
size_t
 
SŒšgToBy‹A¼ay
(

211 cÚ¡ 
¡ršg
 & 
¤c
,

212 
OuutI‹r
 
fœ¡
,

213 
OuutI‹r
 
Ï¡
,

214 
boŞ
 
£p_´e£Á
 = 
çl£
)

216 
as£¹
((*
fœ¡
) == 1);

217 
size_t
 
	gcouÁ
 = 0;

218 
i¡ršg¡»am
 
iss
(
¤c
);

219 
	gv®
[3];

220 
	gfœ¡
 !ğ
Ï¡
 && 
iss
.
³ek
(è!ğ
¡d
::
i¡ršg¡»am
::
Œa™s_ty³
::
eof
())

222 
size_t
 
nb
 = 0;

223 
	giss
.
g‘
(
v®
, 3);

224 (*
	gfœ¡
++èğ(
ušt8_t
)
¡d
::
¡oi
(
v®
, &
nb
, 16);

225 
	gcouÁ
++;

226 if(
	g£p_´e£Á
)

227 
	giss
.
g‘
();

229  
	gcouÁ
;

233 şas 
	cA½Off£ts


235 
	gpublic
:

236 
A½Off£ts
(
ušt8_t
 * 
¬p_·ck‘
) :

237 
pkt_
(
¬p_·ck‘
)

239 
ušt8_t
* 
H¬dw¬eTy³
()

241  
pkt_
;

243 
ušt8_t
* 
PrÙocŞL’
()

245  &
	gpkt_
[5];

247 
ušt8_t
* 
A½O³¿tiÚ
()

249  &
	gpkt_
[6];

251 
ušt8_t
* 
SourûIp
()

253  &
	gpkt_
[14];

255 
ušt8_t
* 
De¡š©iÚIp
()

257  &
	gpkt_
[24];

259 
	g´iv©e
:

260 
ušt8_t
 * 
pkt_
;

264 şas 
	cIpOff£ts


266 
	gpublic
:

267 
IpOff£ts
(
ušt8_t
 * 
_·ck‘
) :

268 
pkt_
(
_·ck‘
)

270 
ušt8_t
* 
V”siÚ
()

272  
pkt_
;

274 
ušt8_t
* 
IpH—d”L’
()

276  
	gpkt_
;

278 
ušt8_t
* 
TÙ®L’gth
()

280  &
	gpkt_
[2];

282 
ušt8_t
* 
T
()

284  &
	gpkt_
[8];

286 
ušt8_t
* 
SourûIp
()

288  &
	gpkt_
[12];

290 
ušt8_t
* 
De¡š©iÚIp
()

292  &
	gpkt_
[16];

294 
ušt8_t
* 
Paylßd
()

296  &
	gpkt_
[24];

298 
	g´iv©e
:

299 
ušt8_t
 * 
pkt_
;

302 şas 
	cEthOff£ts


304 
	gpublic
:

305 
EthOff£ts
(
ušt8_t
 * 
‘h_äame
) :

306 
äm_
(
‘h_äame
)

308 
ušt8_t
* 
De¡š©iÚMac
()

310  
äm_
;

312 
ušt8_t
* 
SourûMac
()

314  &
	gäm_
[6];

316 
ušt8_t
* 
Ty³
()

318  &
	gäm_
[12];

320 
ušt8_t
* 
Paylßd
()

322  &
	gäm_
[14];

324 
	g´iv©e
:

325 
ušt8_t
 * 
äm_
;

	@include/tincan_control.h

23 #iâdeà
TINCAN_TINCAN_CONTROL_H_


24 
	#TINCAN_TINCAN_CONTROL_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"web¹c/¹c_ba£/jsÚ.h
"

27 
	~"web¹c/¹c_ba£/sock‘_add»ss.h
"

29 
Çme¥aû
 
	gtšÿn
 {

30 
usšg
 
Çme¥aû
 
	g¹c
;

32 şas 
	cTšÿnCÚŒŞ


34 
	gpublic
:

35 
	eCÚŒŞTy³Enum


37 
CTTšÿnReque¡
,

38 
	gCTTšÿnRe¥Ú£
,

39 
	gCTInv®id
,

40 
	gCTMax
 = 
CTInv®id
,

42 cÚ¡ 
	g¬¿y
<cÚ¡ *, 3> 
	gCÚŒŞTy³SŒšgs
 = { {"TincanRequest", "TincanResponse", "controlype invalid"} };

44 
TšÿnCÚŒŞ
();

45 
TšÿnCÚŒŞ
(
unique_±r
<
JsÚ
::
V®ue
> 
»q
);

46 
TšÿnCÚŒŞ
(
unique_±r
<
JsÚ
::
V®ue
> 
»q
, unique_±r<JsÚ::V®ue> 
»¥
);

47 
TšÿnCÚŒŞ
(cÚ¡ * cÚ¡ 
»q_d©a
, cÚ¡ 
size_t
 
Ën
);

48 
TšÿnCÚŒŞ
(cÚ¡ TšÿnCÚŒŞ & 
ù¾
);

49 
TšÿnCÚŒŞ
(TšÿnCÚŒŞ && 
ù¾
);

50 ~
TšÿnCÚŒŞ
();

51 
	gTšÿnCÚŒŞ
& 
	gİ”©Ü
ğ(
TšÿnCÚŒŞ
 & 
rhs
);

52 
	gTšÿnCÚŒŞ
& 
	gİ”©Ü
ğ(
TšÿnCÚŒŞ
 && 
rhs
);

54 
	gJsÚ
::
V®ue
 & 
G‘Reque¡
();

55 
S‘Reque¡
(
unique_±r
<
JsÚ
::
V®ue
> 
»q
);

57 
	gJsÚ
::
V®ue
 & 
G‘Re¥Ú£
();

58 
S‘Re¥Ú£
(
unique_±r
<
JsÚ
::
V®ue
> 
»¥
);

59 
S‘Re¥Ú£
(cÚ¡ 
¡ršg
 & 
»¥_msg
, 
boŞ
 
sucûss
);

61 
¡ršg
 
G‘Commªd
() const;

62 
S‘Commªd
(
¡ršg
 
cmd
);

64 
ušt64_t
 
G‘T¿n§ùiÚId
() const;

65 
S‘T¿n§ùiÚId
(
ušt64_t
 
g
);

67 
CÚŒŞTy³Enum
 
G‘CÚŒŞTy³
() const;

68 
S‘CÚŒŞTy³
(
CÚŒŞTy³Enum
 
ty³
);

70 
¡ršg
 
StyËdSŒšg
();

72 
ušt64_t
 
NextTagV®ue
()

74 
ušt64_t
 
	gtšÿn_cÚŒŞ_g_v®ue__
 = 0;

75  ++
	gtšÿn_cÚŒŞ_g_v®ue__
;

78 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Commªd
;

79 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
CAS
;

80 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
CÚŒŞËd
;

81 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
CÚŒŞlšg
;

82 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
CÚŒŞTy³
;

83 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
C»©eCŒlRe¥Lšk
;

84 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
C»©eTuÂ–
;

85 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
D©a
;

86 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Echo
;

87 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Enüy±iÚEÇbËd
;

88 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
FPR
;

89 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
ICC
;

90 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
IûRŞe
;

91 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
IgnÜedN‘IÁ”çûs
;

92 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
T­Name
;

93 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
IP4P»fixL’
;

94 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
IPOP
;

95 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
LškId
;

96 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
LškS‹Chªge
;

97 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Lev–
;

98 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
MAC
;

99 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Mes§ge
;

100 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
MTU4
;

101 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
NodeId
;

102 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
P“rInfo
;

103 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
PrÙocŞV”siÚ
;

104 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Qu”yTuÂ–Info
;

105 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Qu”yCªdid©eAdd»ssS‘
;

106 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Rec›Á
;

107 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Rec›ÁMac
;

108 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
RemoveTuÂ–
;

109 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
ReqRou‹Upd©e
;

110 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Reque¡
;

111 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Re¥Ú£
;

112 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
RŞe
;

113 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Upd©eRou‹TabË
;

114 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
S‘IgnÜedN‘IÁ”çûs
;

115 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
S‘LoggšgLev–
;

116 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Sts
;

117 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Stus
;

118 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Sucûss
;

119 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnReque¡
;

120 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnRe¥Ú£
;

121 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
T¿n§ùiÚId
;

122 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TuÂ–Id
;

123 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Ty³
;

124 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
VIP4
;

125 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
VIP6
;

126 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
UID
;

127 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
VÃtDesütiÚ
;

128 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
Vlšks
;

129 
	g´iv©e
:

130 
ušt32_t
 
´Ùo_v”_
;

131 
ušt64_t
 
	gg_
;

132 
CÚŒŞTy³Enum
 
	gty³_
;

133 
	gJsÚ
::
V®ue
 * 
diù_»q_
;

134 
	gJsÚ
::
V®ue
 * 
diù_»¥_
;

	@include/tincan_exception.h

23 #iâdeà
TINCAN_EXCEPTION_H_


24 
	#TINCAN_EXCEPTION_H_


	)

26 #ià
defšed
(
_IPOP_LINUX
)

27 
	~"lšux/Êx_exû±iÚ.h
"

28 #–ià
defšed
(
_IPOP_OSX
)

29 
	~"mac/mac_exû±iÚ.h
"

30 #–ià
defšed
(
_IPOP_WIN
)

31 
	~"wšdows/wš_exû±iÚ.h
"

34 
Çme¥aû
 
	gtšÿn
 {

35 #ià
defšed
(
_IPOP_LINUX
)

36 
	#TCEXCEPT
(
Ex‹ndedE¼ÜInfo
è
lšux
::
	`LNXEXCEPT
(Ex‹ndedE¼ÜInfo)

	)

37 #–ià
defšed
(
_IPOP_OSX
)

38 
	#TCEXCEPT
(
Ex‹ndedE¼ÜInfo
è
osx
::
	`OSXEXCEPT
(Ex‹ndedE¼ÜInfo)

	)

39 #–ià
defšed
(
_IPOP_WIN
)

40 
	#TCEXCEPT
(
Ex‹ndedE¼ÜInfo
è
wšdows
::
	`WINEXCEPT
(Ex‹ndedE¼ÜInfo)

	)

	@include/tunnel_descriptor.h

23 #iâdeà
TINCAN_TUNNEL_DESCRIPTOR_H_


24 
	#TINCAN_TUNNEL_DESCRIPTOR_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"tuº_desütÜ.h
"

27 
Çme¥aû
 
	gtšÿn


29 
	sTuÂ–DesütÜ


31 
¡ršg
 
	guid
;

32 
¡ršg
 
	gnode_id
;

33 
	gveùÜ
<
	g¡ršg
> 
	g¡un_£rv”s
;

34 
	gveùÜ
<
	gTuºDesütÜ
> 
	gtuº_descs
;

35 
boŞ
 
	g’abË__m­pšg
;

36 
boŞ
 
	gdi§bË_’üy±iÚ
;

	@include/turn_descriptor.h

23 #ià!
defšed
(
TINCAN_TURN_DESCRIPTOR_H_
)

24 
	#TINCAN_TURN_DESCRIPTOR_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
Çme¥aû
 
	gtšÿn


29 
	sTuºDesütÜ


31 
¡ršg
 
	g£rv”_ho¡Çme
;

32 
¡ršg
 
	gu£ºame
;

33 
¡ršg
 
	g·sswÜd
;

35 
TuºDesütÜ
(
¡ršg
 
£rv”_ho¡Çme_
, sŒšg 
u£ºame_
, sŒšg 
·sswÜd_
) :

36 
£rv”_ho¡Çme
(
£rv”_ho¡Çme_
), 
u£ºame
(
u£ºame_
), 
·sswÜd
(
·sswÜd_
)

	@include/virtual_link.h

23 #iâdeà
TINCAN_VIRTUAL_LINK_H_


24 
	#TINCAN_VIRTUAL_LINK_H_


	)

25 
	~"tšÿn_ba£.h
"

26 
	~"web¹c/¹c_ba£/async_·ck‘_sock‘.h
"

27 
	~"web¹c/¹c_ba£/jsÚ.h
"

28 
	~"web¹c/¹c_ba£/ÃtwÜk.h
"

29 
	~"web¹c/¹c_ba£/s¦_fšg”´št.h
"

30 
	~"web¹c/¹c_ba£/th»ad.h
"

31 
	~"web¹c/p2p/ba£/basic_·ck‘_sock‘_çùÜy.h
"

32 
	~"web¹c/p2p/ba£/ds_Œª¥Üt.h
"

33 
	~"web¹c/p2p/ba£/ds_Œª¥Üt_çùÜy.h
"

34 
	~"web¹c/p2p/ba£/ds_Œª¥Üt_š‹º®.h
"

35 
	~"pc/j£p_Œª¥Üt_cÚŒŞËr.h
"

36 
	~"web¹c/p2p/ba£/·ck‘_Œª¥Üt_š‹º®.h
"

37 
	~"web¹c/p2p/ba£/p2p_Œª¥Üt_chªÃl.h
"

38 
	~"web¹c/p2p/ş›Á/basic_pÜt_®loÿtÜ.h
"

39 
	~"p_äame.h
"

40 
	~"³”_desütÜ.h
"

41 
	~"tuº_desütÜ.h
"

43 
Çme¥aû
 
	gtšÿn


45 
usšg
 
Çme¥aû
 
	g¹c
;

46 
usšg
 
	güick‘
::
T¿n¥ÜtCÚŒŞËr
;

47 
usšg
 
	güick‘
::
T¿n¥ÜtChªÃlIm¶
;

48 
usšg
 
	güick‘
::
T¿n¥ÜtChªÃl
;

49 
usšg
 
	güick‘
::
CÚÃùiÚRŞe
;

50 
usšg
 
	g¹c
::
Pack‘T¿n¥ÜtIÁ”çû
;

52 
şass
 
	gP“rN‘wÜk
;

54 
	sVlškDesütÜ


56 
boŞ
 
	gds_’abËd
;

57 
¡ršg
 
	guid
;

58 
	gveùÜ
<
	g¡ršg
> 
	g¡un_£rv”s
;

59 
	gveùÜ
<
	gTuºDesütÜ
> 
	gtuº_descs
;

62 
şass
 
	gVœtu®Lšk
 :

63 
public
 
sig¦Ù
::
has_¦Ùs
<>

65 
public
:

66 
ä›nd
 
P“rN‘wÜk
;

67 
Vœtu®Lšk
(

68 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

69 
unique_±r
<
P“rDesütÜ
> 
³”_desc
,

70 
¹c
::
Th»ad
* 
sigÇlšg_th»ad
,

71 
¹c
::
Th»ad
* 
ÃtwÜk_th»ad
);

72 ~
Vœtu®Lšk
();

74 
¡ršg
 
Name
();

76 
In™Ÿlize
(

77 
BasicN‘wÜkMªag”
 & 
ÃtwÜk_mªag”
,

78 
unique_±r
<
SSLId’t™y
>
s¦id
,

79 
SSLFšg”´št
 cÚ¡ & 
loÿl_fšg”´št
,

80 
üick‘
::
IûRŞe
 
iû_rŞe
);

82 
	gP“rDesütÜ
& 
P“rInfo
()

84  *
	g³”_desc_
.
g‘
();

87 
S¹CÚÃùiÚs
();

89 
DiscÚÃù
();

91 
boŞ
 
IsR—dy
();

93 
T¿nsm™
(
T­F¿me
 & 
äame
);

95 
¡ršg
 
Cªdid©es
();

97 
¡ršg
 
P“rCªdid©es
();

99 
P“rCªdid©es
(cÚ¡ 
¡ršg
 & 
³”_ÿs
);

101 
¡ršg
 
Id
()

103  
	gvlšk_desc_
->
	guid
;

105 
G‘Sts
(
JsÚ
::
V®ue
 & 
šfos
);

107 
	güick‘
::
IûRŞe
 IceRole()

109  
iû_rŞe_
;

112 
boŞ
 
IsG©h”šgCom¶‘e
()

114  
	gg©h”_¡©e_
 =ğ
üick‘
::
kIûG©h”šgCom¶‘e
;

117 
	gsig¦Ù
::
sigÇl1
<
¡ršg
, 
	gsšgË_th»aded
> 
	gSigÇlLškUp
;

118 
	gsig¦Ù
::
sigÇl1
<
¡ršg
, 
	gsšgË_th»aded
> 
	gSigÇlLškDown
;

119 
	gsig¦Ù
::
sigÇl2
<
¡ršg
, 
	g¡ršg
> 
	gSigÇlLoÿlCasR—dy
;

120 
	gsig¦Ù
::
sigÇl3
<
ušt8_t
 *, 
	gušt32_t
, 
	gVœtu®Lšk
&> 
	gSigÇlMes§geReûived
;

121 
	g´iv©e
:

122 
S‘upTURN
(
veùÜ
<
TuºDesütÜ
>);

124 
OnCªdid©esG©h”ed
(

125 cÚ¡ 
¡ršg
 & 
Œª¥Üt_Çme
,

126 cÚ¡ 
üick‘
::
Cªdid©es
 & 
ÿndid©es
);

128 
OnG©h”šgS‹
(

129 
üick‘
::
IûG©h”šgS‹
 
g©h”_¡©e
);

131 
OnWr™—bËS‹
(

132 
Pack‘T¿n¥ÜtIÁ”çû
 * 
Œª¥Üt
);

134 
Regi¡”LškEv’tHªdËrs
();

136 
AddRemÙeCªdid©es
(

137 cÚ¡ 
¡ršg
 & 
ÿndid©es
);

139 
S‘upICE
(

140 
SSLFšg”´št
 cÚ¡ & 
loÿl_fšg”´št
);

142 
OnR—dPack‘
(

143 
Pack‘T¿n¥ÜtIÁ”çû
* 
Œª¥Üt
,

144 cÚ¡ * 
d©a
,

145 
size_t
 
Ën
,

146 cÚ¡ 
Pack‘Time
 & 
±ime
,

147 
æags
);

149 
OnS’tPack‘
(

150 
Pack‘T¿n¥ÜtIÁ”çû
 * 
Œª¥Üt
,

151 cÚ¡ 
S’tPack‘
 & 
·ck‘
);

153 
	gunique_±r
<
	gVlškDesütÜ
> 
	gvlšk_desc_
;

154 
	gunique_±r
<
	gP“rDesütÜ
> 
	g³”_desc_
;

155 
	g¡d
::
mu‹x
 
ÿs_mu‹x_
;

156 
	güick‘
::
Cªdid©es
 
loÿl_ÿndid©es_
;

157 cÚ¡ 
ušt64_t
 
	gt›b»ak”_
;

158 
	güick‘
::
IûRŞe
 
iû_rŞe_
;

159 
CÚÃùiÚRŞe
 
	gcÚn_rŞe_
;

160 
T¿n¥ÜtChªÃl
 * 
	gchªÃl_
;

161 
	gunique_±r
<
	güick‘
::
T¿n¥ÜtDesütiÚ
> 
loÿl_desütiÚ_
;

162 
	gunique_±r
<
	güick‘
::
T¿n¥ÜtDesütiÚ
> 
»mÙe_desütiÚ_
;

163 
	gunique_±r
<
	gSSLFšg”´št
> 
	g»mÙe_fšg”´št_
;

164 
¡ršg
 
	gcÚ‹Á_Çme_
;

165 
Pack‘O±iÚs
 
	g·ck‘_İtiÚs_
;

166 
BasicPack‘Sock‘FaùÜy
 
	g·ck‘_çùÜy_
;

167 
	gunique_±r
<
	güick‘
::
BasicPÜtAÎoÿtÜ
> 
pÜt_®loÿtÜ_
;

168 
	gunique_±r
<
	güick‘
::
T¿n¥ÜtCÚŒŞËr
> 
Œª¥Üt_ùÌ_
;

170 
	güick‘
::
IûG©h”šgS‹
 
g©h”_¡©e_
;

171 
boŞ
 
	gis_v®id_
;

172 
	g¹c
::
Th»ad
* 
sigÇlšg_th»ad_
;

173 
	g¹c
::
Th»ad
* 
ÃtwÜk_th»ad_
;

	@include/windows/tapdev_win.h

24 #iâdeà
TINCAN_TAPDEV_WIN_H_


25 
	#TINCAN_TAPDEV_WIN_H_


	)

26 #ià
defšed
(
_IPOP_WIN
)

27 
	~"tšÿn_ba£.h
"

28 
	~"web¹c/¹c_ba£/loggšg.h
"

29 
	~"web¹c/¹c_ba£/sig¦Ù.h
"

30 
	~<Wšsock2.h
>

31 
	~"async_io.h
"

32 
	~"pdev_šf.h
"

34 
Çme¥aû
 
	gtšÿn


36 
Çme¥aû
 
	gwšdows


43 
şass
 
	gT­DevWš
 :

44 
public
 
T­DevInf
,

45 
public
 
	gMes§geHªdËr


47 
	gpublic
:

48 
	sIoTh»adDesütÜ


50 
HANDLE
 
hªdË_
;

51 
HANDLE
 
	gex™_ev_
;

52 
HANDLE
 
	gcm¶_´t_hdl_
;

53 
DWORD
 
	gid_
;

54 
ušt16_t
 
	gnum_
;

55 
IoTh»adDesütÜ
() :

56 
hªdË_
(
INVALID_HANDLE_VALUE
),

57 
cm¶_´t_hdl_
(0),

58 
id_
(0), 
num_
(0)

60 
	gex™_ev_
 = 
C»©eEv’t
(
NULL
, 
FALSE
, FALSE, NULL);

62 ~
IoTh»adDesütÜ
()

64 
Clo£HªdË
(
ex™_ev_
);

65 
Clo£HªdË
(
hªdË_
);

67 
DWORD
 
__¡dÿÎ
 
IoCom¶‘iÚTh»ad
(* 
·¿m
);

70 
	sIoTh»adPoŞ


72 
IoTh»adPoŞ
(
ušt8_t
 
max_th»ads
 = 1) :

73 
»f_
(0),

74 
num_th»ads_
(0),

75 
max_th»ads_
(
max_th»ads
), 
is_®loc
(
çl£
)

77 ~
IoTh»adPoŞ
()

79 if(
	gis_®loc
)

80 
F»e
();

82 
boŞ
 
AÎoc
()

84 
	gio_th»ads_
 = 
Ãw
 
IoTh»adDesütÜ
[
max_th»ads_
];

85 
ušt16_t
 
	gi
 = 0; i < 
	gmax_th»ads_
; i++)

87 
	gio_th»ads_
[
i
].
	gnum_
 = i;

88 
	gio_th»ads_
[
i
].
	ghªdË_
 = 
C»©eTh»ad
(0, 0,

89 
IoTh»adDesütÜ
::
IoCom¶‘iÚTh»ad
, (*)&
io_th»ads_
[
i
],

90 
CREATE_SUSPENDED
, &
io_th»ads_
[
i
].
id_
);

91 ++
	gnum_th»ads_
;

93 
	gis_®loc
 = 
Œue
;

94  
	gis_®loc
;

96 
F»e
()

98 
ušt16_t
 
	gi
 = 0; i < 
	gmax_th»ads_
; i++)

100 
S‘Ev’t
(
io_th»ads_
[
i
].
ex™_ev_
);

101 
Po¡QueuedCom¶‘iÚStus
(
io_th»ads_
[
i
].
cm¶_´t_hdl_
, 0,

102 (
DWORD
)
NULL
, NULL);

103 
ResumeTh»ad
(
io_th»ads_
[
i
].
hªdË_
);

106 
Wa™FÜMuÉËObjeùs
(
num_th»ads_
, (cÚ¡ 
HANDLE
*)
io_th»ads_
,

107 
TRUE
, 10000);

108 
	gd–‘e
[]
	gio_th»ads_
;

109 
	gis_®loc
 = 
çl£
;

111 
A‰ach
(
HANDLE
 
com¶‘iÚ_pÜt_hªdË
)

113 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
iÙ_mu‹x_
);

114 if(0 =ğ
»f_
++)

116 
ušt16_t
 
i
 = 0; 
	gi
 < 
	gmax_th»ads_
; i++)

118 
	gio_th»ads_
[
i
].
	gcm¶_´t_hdl_
 = 
com¶‘iÚ_pÜt_hªdË
;

119 
ResumeTh»ad
(
io_th»ads_
[
i
].
hªdË_
);

123 
R–—£
()

125 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
iÙ_mu‹x_
);

126 if(0 =ğ--
»f_
)

128 
ušt16_t
 
i
 = 0; 
	gi
 < 
	gmax_th»ads_
; i++)

130 
Su¥’dTh»ad
(
io_th»ads_
[
i
].
hªdË_
);

131 
	gio_th»ads_
[
i
].
	gcm¶_´t_hdl_
 = 0;

135 
IoTh»adDesütÜ
* 
	gio_th»ads_
;

136 
ušt16_t
 
	g»f_
;

137 
ušt16_t
 
	gnum_th»ads_
;

138 
ušt16_t
 
	gmax_th»ads_
;

139 
mu‹x
 
	giÙ_mu‹x_
;

140 
boŞ
 
	gis_®loc
;

143 
T­DevWš
();

145 
	gvœtu®
 ~
T­DevWš
();

147 
O³n
(

148 cÚ¡ 
T­DesütÜ
 & 
p_desc
è
	gov”ride
;

150 
Clo£
(è
	gov”ride
;

152 
Up
(è
	gov”ride
;

154 
Down
(è
	gov”ride
;

156 
ušt32_t
 
R—d
(

157 
AsyncIo
 & 
aio_rd
è
	gov”ride
;

159 
ušt32_t
 
Wr™e
(

160 
AsyncIo
 & 
aio_wr
è
	gov”ride
;

162 
MacAdd»ssTy³
 
MacAdd»ss
(è
	gov”ride
;

164 
IP4Add»ssTy³
 
Ip4
(è
	gov”ride
;

166 
ušt16_t
 
Mtu
(è
	gov”ride
;

169 
Com¶‘iÚPÜtHªdË
(
HANDLE
 
hªdË
)

171 
	gcm¶_´t_hªdË_
 = 
hªdË
;

173 
HANDLE
 
Com¶‘iÚPÜtHªdË
()

175  
	gcm¶_´t_hªdË_
;

177 
HANDLE
 
DeviûHªdË
()

179  
	gdev_hªdË_
;

182 
ušt32_t
 
MedŸStus
();

184 
	gsig¦Ù
::
sigÇl1
<
AsyncIo
 *> 
»ad_com¶‘iÚ_
;

185 
	gsig¦Ù
::
sigÇl1
<
AsyncIo
 *> 
wr™e_com¶‘iÚ_
;

186 
	g´Ùeùed
:

187 
N‘DeviûNameToGuid
(

188 cÚ¡ 
¡ršg
 & 
Çme
,

189 
¡ršg
 & 
guid
);

190 
G‘MacAdd»ss
();

191 
OnMes§ge
(

192 
Mes§ge
 * 
msg
è
	gov”ride
;

194 cÚ¡ * cÚ¡ 
	gNETWORK_PATH_
;

195 cÚ¡ * cÚ¡ 
	gUSER_MODE_DEVICE_DIR_
;

196 cÚ¡ * cÚ¡ 
	gTAP_SUFFIX_
;

197 
MacAdd»ssTy³
 
	gmac_add»ss_
;

198 
DWORD
 
	gmac_Ën_
;

199 
¡ršg
 
	gp_Çme_
;

200 
HANDLE
 
	gcm¶_´t_hªdË_
;

201 
HANDLE
 
	gdev_hªdË_
;

202 
mu‹x
 
	grw_mu‹x_
;

203 
IoTh»adPoŞ
 
	gio_th»ad_poŞ_
;

204 
DWORD
 
	gmedŸ_¡©us_
;

205 
IP4Add»ssTy³
 
	g4_
;

206 
	g¹c
::
Th»ad
 
wr™”_
;

	@include/windows/win_exception.h

32 #iâdeà
TINCAN_WIN_EXCEPTION_H_


33 
	#TINCAN_WIN_EXCEPTION_H_


	)

34 #ià
defšed
(
_IPOP_WIN
)

35 
	~"tšÿn_ba£.h
"

36 
	~<Wšsock2.h
>

37 
Çme¥aû
 
	gtšÿn


39 
Çme¥aû
 
	gwšdows


41 
	#WINEXCEPT
(
Ex‹ndedE¼ÜInfo
)\

42 
	`WšExû±iÚ
(
Ex‹ndedE¼ÜInfo
, 
__FILE__
, 
__LINE__
, 
	`G‘La¡E¼Ü
())

	)

43 şas 
	cWšExû±iÚ
 : 
vœtu®
 
public
 
exû±iÚ


45 
´iv©e
:

46 
mHo¡E¼ÜCode
;

47 
	gmSourûLše
;

48 cÚ¡ 
¡ršg
 
	gmSourûFe
;

49 cÚ¡ 
¡ršg
 
	gmEx‹ndedE¼ÜInfo
;

50 
¡ršg¡»am
 
	gss
;

51 
	g´Ùeùed
:

52 
¡ršg
 
mMsg
;

53 
	gWšExû±iÚ
::
T¿n¦©eE¼ÜCode
() {

54 
ss
 << "Exû±iÚ@ " << 
mSourûFe
 << " (" << 
mSourûLše
 << "è" << 
’dl


55 << 
mEx‹ndedE¼ÜInfo
 << 
’dl
;

56 if(
	gERROR_SUCCESS
 !ğ
mHo¡E¼ÜCode
)

58 
LPSTR
 
MsgBuf
 = 
NULL
;

59 
DWORD
 
	gdw
 = 
FÜm©Mes§geA
(

60 
FORMAT_MESSAGE_ALLOCATE_BUFFER
 | 
FORMAT_MESSAGE_FROM_SYSTEM
 | 
FORMAT_MESSAGE_IGNORE_INSERTS
,

61 
NULL
,

62 
mHo¡E¼ÜCode
,

63 
MAKELANGID
(
LANG_NEUTRAL
, 
SUBLANG_DEFAULT
),

64 (
LPSTR
)&
MsgBuf
,

66 
NULL
);

67 if(
	gdw
 && 
	gMsgBuf
) {

68 
	gss
 << " Sy¡emƒ¼Ü: " << 
	gmHo¡E¼ÜCode
 << "-" << 
	gMsgBuf
 << 
	g’dl
;

69 
LoÿlF»e
(
MsgBuf
);

70 
	gMsgBuf
 = 
NULL
;

74 
	gpublic
:

75 
WšExû±iÚ
(

76 cÚ¡ *cÚ¡ & 
Ex‹ndedE¼ÜInfo
,

77 cÚ¡ *cÚ¡ & 
SourûFe
,

78 cÚ¡ 
SourûLše
,

79 cÚ¡ 
E¼ÜCode
) :

80 
exû±iÚ
(),

81 
mHo¡E¼ÜCode
(
E¼ÜCode
),

82 
mSourûLše
(
SourûLše
),

83 
mSourûFe
(
SourûFe
),

84 
mEx‹ndedE¼ÜInfo
(
Ex‹ndedE¼ÜInfo
) {

85 
T¿n¦©eE¼ÜCode
();

86 
	gmMsg
 = 
ss
.
¡r
();

89 
AddMes§ge
Ğ
¡ršg
 && 
Msg
) {

90 
	gss
 << 
	gMsg
 << 
	g’dl
;

93 cÚ¡ * 
	gWšExû±iÚ
::
wh©
() const {

94  
mMsg
.
c_¡r
();

	@src/basic_tunnel.cc

23 
	~"basic_tuÂ–.h
"

24 
	~"web¹c/¹c_ba£/thœd_·¹y/ba£64/ba£64.h
"

25 
	~"tšÿn_cÚŒŞ.h
"

26 
Çme¥aû
 
	gtšÿn


28 
TšÿnP¬am‘”s
 

;

29 
	gBasicTuÂ–
::
BasicTuÂ–
(

30 
unique_±r
<
TuÂ–DesütÜ
> 
desütÜ
,

31 
IpİCÚŒŞËrLšk
 * 
ù¾_hªdË
) :

32 
tdev_
(
nuÎ±r
),

33 
desütÜ_
(
move
(
desütÜ
)),

34 
ù¾_lšk_
(
ù¾_hªdË
)

36 
	gtdev_
 = 
make_unique
<
T­Dev
>();

39 
	gBasicTuÂ–
::~
BasicTuÂ–
()

43 
BasicTuÂ–
::
CÚfigu»
(

44 
unique_±r
<
T­DesütÜ
> 
p_desc
,

45 cÚ¡ 
veùÜ
<
¡ršg
>& 
ignÜed_li¡
)

47 
	gp_desc_
 = 
move
(
p_desc
);

49 
	gtdev_
->
O³n
(*
p_desc_
.
g‘
());

51 
¡ršg
 
	gs¦id_Çme
 = 
desütÜ_
->
node_id
 + desütÜ_->
uid
;

52 
	gs¦id_
.
»£t
(
SSLId’t™y
::
G’”©e
(
s¦id_Çme
, 
¹c
::
KT_RSA
));

53 if(!
	gs¦id_
)

54 
throw
 
TCEXCEPT
("Failedo generate SSL Identity");

55 
	gloÿl_fšg”´št_
.
»£t
(

56 
SSLFšg”´št
::
C»©e
(
¹c
::
DIGEST_SHA_1
, 
s¦id_
.
g‘
()));

57 if(!
	gloÿl_fšg”´št_
)

58 
throw
 
TCEXCEPT
("Failedo createhe†ocal finger…rint");

59 
S‘IgnÜedN‘wÜkIÁ”çûs
(
ignÜed_li¡
);

63 
	gBasicTuÂ–
::
S¹
()

65 
Ãt_wÜk”_
.
S¹
();

66 
	gsig_wÜk”_
.
S¹
();

67 
	gtdev_
->
	g»ad_com¶‘iÚ_
.
cÚÃù
(
this
, &
BasicTuÂ–
::
T­R—dCom¶‘e
);

68 
	gtdev_
->
	gwr™e_com¶‘iÚ_
.
cÚÃù
(
this
, &
BasicTuÂ–
::
T­Wr™eCom¶‘e
);

72 
	gBasicTuÂ–
::
Shutdown
()

74 
Ãt_wÜk”_
.
Qu™
();

75 
	gsig_wÜk”_
.
Qu™
();

76 
	gtdev_
->
Down
();

77 
	gtdev_
->
Clo£
();

80 
	gunique_±r
<
	gVœtu®Lšk
>

81 
	gBasicTuÂ–
::
C»©eVlšk
(

82 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

83 
unique_±r
<
P“rDesütÜ
> 
³”_desc
,

84 
üick‘
::
IûRŞe
 
iû_rŞe
)

86 
vlšk_desc
->
¡un_£rv”s
 = 
desütÜ_
->stun_servers;

87 
	gvlšk_desc
->
	gtuº_descs
 = 
desütÜ_
->
tuº_descs
;

88 
	gunique_±r
<
	gVœtu®Lšk
> 
	gvl
 = 
make_unique
<
Vœtu®Lšk
>(

89 
move
(
vlšk_desc
), move(
³”_desc
), &
	gsig_wÜk”_
, &
	gÃt_wÜk”_
);

90 
	gunique_±r
<
	gSSLId’t™y
> 
s¦id_cİy
(
s¦id_
->
G‘Reã»nû
());

91 
	gvl
->
In™Ÿlize
(
Ãt_mªag”_
, 
move
(
s¦id_cİy
), *
loÿl_fšg”´št_
.
g‘
(),

92 
iû_rŞe
);

93 
	gvl
->
	gSigÇlMes§geReûived
.
cÚÃù
(
this
, &
BasicTuÂ–
::
VlškR—dCom¶‘e
);

94 
	gvl
->
	gSigÇlLškUp
.
cÚÃù
(
this
, &
BasicTuÂ–
::
VLškUp
);

95 
	gvl
->
	gSigÇlLškDown
.
cÚÃù
(
this
, &
BasicTuÂ–
::
VLškDown
);

96 ià(
	gvl
->
P“rCªdid©es
().
Ëngth
() != 0)

97 
vl
->
S¹CÚÃùiÚs
();

99  
	gvl
;

103 
	gBasicTuÂ–
::
VLškUp
(

104 
¡ršg
 
vlšk_id
)

106 
S¹Io
();

107 
	gunique_±r
<
	gTšÿnCÚŒŞ
> 
	gù¾
 = 
make_unique
<
TšÿnCÚŒŞ
>();

108 
	gù¾
->
S‘CÚŒŞTy³
(
TšÿnCÚŒŞ
::
CTTšÿnReque¡
);

109 
	gJsÚ
::
V®ue
 & 
»q
 = 
ù¾
->
G‘Reque¡
();

110 
	g»q
[
TšÿnCÚŒŞ
::
Commªd
] = TšÿnCÚŒŞ::
LškS‹Chªge
;

111 
	g»q
[
TšÿnCÚŒŞ
::
TuÂ–Id
] = 
desütÜ_
->
uid
;

112 
	g»q
[
TšÿnCÚŒŞ
::
LškId
] = 
vlšk_id
;

113 
	g»q
[
TšÿnCÚŒŞ
::
D©a
] = "LINK_STATE_UP";

114 
	gù¾_lšk_
->
D–iv”
(
move
(
ù¾
));

118 
	gBasicTuÂ–
::
VLškDown
(

119 
¡ršg
 
vlšk_id
)

122 
unique_±r
<
TšÿnCÚŒŞ
> 
ù¾
 = 
make_unique
<TincanControl>();

123 
	gù¾
->
S‘CÚŒŞTy³
(
TšÿnCÚŒŞ
::
CTTšÿnReque¡
);

124 
	gJsÚ
::
V®ue
 & 
»q
 = 
ù¾
->
G‘Reque¡
();

125 
	g»q
[
TšÿnCÚŒŞ
::
Commªd
] = TšÿnCÚŒŞ::
LškS‹Chªge
;

126 
	g»q
[
TšÿnCÚŒŞ
::
TuÂ–Id
] = 
desütÜ_
->
uid
;

127 
	g»q
[
TšÿnCÚŒŞ
::
LškId
] = 
vlšk_id
;

128 
	g»q
[
TšÿnCÚŒŞ
::
D©a
] = "LINK_STATE_DOWN";

129 
	gù¾_lšk_
->
D–iv”
(
move
(
ù¾
));

133 
	gBasicTuÂ–
::
S¹Io
()

135 
ušt8_t
 
i
 = 0; 
	gi
 < 
	g
.
	gkLškCÚcu¼’tAIO
; i++)

137 
	gunique_±r
<
	gT­F¿me
> 
	gtf
 = 
make_unique
<
T­F¿me
>();

138 
	gtf
->
In™Ÿlize
();

139 
	gtf
->
BufãrToT¿nsãr
(
tf
->
Paylßd
());

140 
	gtf
->
By‹sToT¿nsãr
(
tf
->
PaylßdC­ac™y
());

141 if(0 =ğ
tdev_
->
R—d
(*
tf
))

142 
tf
.
»Ëa£
();

144 
LOG
(
LS_ERROR
) << "A TAP„ead operation failedo start!";

148 
	gTuÂ–DesütÜ
 &

149 
	gBasicTuÂ–
::
DesütÜ
()

151  *
desütÜ_
.
g‘
();

154 
¡ršg


155 
	gBasicTuÂ–
::
Name
()

157  
desütÜ_
->
uid
;

160 
¡ršg


161 
	gBasicTuÂ–
::
MacAdd»ss
()

163 
MacAdd»ssTy³
 
mac
 = 
tdev_
->
MacAdd»ss
();

164  
By‹A¼ayToSŒšg
(
mac
.
begš
(), mac.
’d
(), 0);

167 
¡ršg


168 
	gBasicTuÂ–
::
Fšg”´št
()

170  
loÿl_fšg”´št_
->
ToSŒšg
();

174 
	gBasicTuÂ–
::
S‘IgnÜedN‘wÜkIÁ”çûs
(

175 cÚ¡ 
veùÜ
<
¡ršg
>& 
ignÜed_li¡
)

177 
Ãt_mªag”_
.
£t_ÃtwÜk_ignÜe_li¡
(
ignÜed_li¡
);

180 
	gBasicTuÂ–
::
OnMes§ge
(
Mes§ge
 * 
msg
)

182 
msg
->
mes§ge_id
)

184 
MSGID_TRANSMIT
:

186 
unique_±r
<
T­F¿me
> 
äame
 = 
move
(((
T¿nsm™MsgD©a
*)
msg
->
pd©a
)->
äm
);

187 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
	gvl
 = ((
T¿nsm™MsgD©a
*)
msg
->
pd©a
)->
vl
;

188 
	gvl
->
T¿nsm™
(*
äame
);

189 
d–‘e
 
	gmsg
->
	gpd©a
;

190 
	gäame
->
In™Ÿlize
(
äame
->
Paylßd
(), f¿me->
PaylßdC­ac™y
());

191 if(0 =ğ
tdev_
->
R—d
(*
äame
))

192 
äame
.
»Ëa£
();

195 
	gMSGID_SEND_ICC
:

197 
unique_±r
<
T­F¿me
> 
äame
 = 
move
(((
T¿nsm™MsgD©a
*)
msg
->
pd©a
)->
äm
);

198 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
	gvl
 = ((
T¿nsm™MsgD©a
*)
msg
->
pd©a
)->
vl
;

199 
	gvl
->
T¿nsm™
(*
äame
);

202 
d–‘e
 
	gmsg
->
	gpd©a
;

205 
	gMSGID_QUERY_NODE_INFO
:

207 
sh¬ed_±r
<
Vœtu®Lšk
> 
vl
 = ((
LškInfoMsgD©a
*)
msg
->
pd©a
)->vl;

208 
	gvl
->
G‘Sts
(((
LškInfoMsgD©a
*)
msg
->
pd©a
)->
šfo
);

209 ((
	gLškInfoMsgD©a
*)
	gmsg
->
	gpd©a
)->
	gmsg_ev’t
.
S‘
();

212 
	gMSGID_FWD_FRAME
:

213 
MSGID_FWD_FRAME_RD
:

215 
unique_±r
<
T­F¿me
> 
äame
 = 
move
(((
T¿nsm™MsgD©a
*)
msg
->
pd©a
)->
äm
);

216 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
	gvl
 = ((
T¿nsm™MsgD©a
*)
msg
->
pd©a
)->
vl
;

217 
	gvl
->
T¿nsm™
(*
äame
);

219 if(
	gmsg
->
	gmes§ge_id
 =ğ
MSGID_FWD_FRAME_RD
)

221 
äame
->
In™Ÿlize
(äame->
Paylßd
(), f¿me->
PaylßdC­ac™y
());

222 if(0 =ğ
tdev_
->
R—d
(*
äame
))

223 
äame
.
»Ëa£
();

225 
d–‘e
 
	gmsg
->
	gpd©a
;

228 
	gMSGID_DISC_LINK
:

230 
sh¬ed_±r
<
Vœtu®Lšk
> 
vl
 = ((
LškMsgD©a
*)
msg
->
pd©a
)->vl;

231 
	gvl
->
DiscÚÃù
();

232 ((
	gLškInfoMsgD©a
*)
	gmsg
->
	gpd©a
)->
	gmsg_ev’t
.
S‘
();

239 
	gBasicTuÂ–
::
InjeùFame
(

240 
¡ršg
 && 
d©a
)

242 
unique_±r
<
T­F¿me
> 
tf
 = 
make_unique
<TapFrame>();

243 
	gtf
->
In™Ÿlize
();

244 if(
	gd©a
.
Ëngth
(è> 2 * 
	g
.
	gkT­BufãrSize
)

246 
¡ršg¡»am
 
	goss
;

247 
	goss
 << "Injeù F¿mİ”©iÚ faed - f¿msiz" << 
	gd©a
.
Ëngth
() / 2

248 << " i Ïrg”hª maximum‡cû±ed " << 
	g
.
	gkT­BufãrSize
;

249 
throw
 
TCEXCEPT
(
oss
.
¡r
().
c_¡r
());

251 
size_t
 
	gËn
 = 
SŒšgToBy‹A¼ay
(
d©a
, 
tf
->
Paylßd
(),f->
End
());

252 if(
	gËn
 !ğ
d©a
.
Ëngth
() / 2)

253 
throw
 
TCEXCEPT
("Inject Frame operation failed - ICC decode failure");

254 
	gtf
->
S‘Wr™eOp
();

255 
	gtf
->
PaylßdL’gth
((
ušt32_t
)
Ën
);

256 
	gtf
->
BufãrToT¿nsãr
(
tf
->
Paylßd
());

257 
	gtf
->
By‹sT¿nsã¼ed
((
ušt32_t
)
Ën
);

258 
	gtf
->
By‹sToT¿nsãr
((
ušt32_t
)
Ën
);

259 
	gtdev_
->
Wr™e
(*
tf
.
»Ëa£
());

	@src/control_dispatch.cc

23 
	~"cÚŒŞ_di¥©ch.h
"

24 
	~"web¹c/¹c_ba£/¡ršgs/jsÚ.h
"

25 
	~"tšÿn_exû±iÚ.h
"

26 
	~"tuÂ–_desütÜ.h
"

28 
Çme¥aû
 
	gtšÿn


30 
usšg
 
Çme¥aû
 
	g¹c
;

31 
	gCÚŒŞDi¥©ch
::
CÚŒŞDi¥©ch
() :

32 
dtŞ_
(
nuÎ±r
),

33 
ù¾_lšk_
(
Ãw
 
DiscÚÃùedCÚŒŞËrHªdË
())

35 
	gcÚŒŞ_m­_
 = {

36 { "CÚfigu»Loggšg", &
CÚŒŞDi¥©ch
::
CÚfigu»Loggšg
 },

37 { "C»©eCŒlRe¥Lšk", &
CÚŒŞDi¥©ch
::
C»©eIpİCÚŒŞËrRe¥Lšk
 },

38 { "C»©eLšk", &
CÚŒŞDi¥©ch
::
C»©eLšk
 },

39 { "C»©eTuÂ–", &
CÚŒŞDi¥©ch
::
C»©eTuÂ–
 },

40 { "Echo", &
CÚŒŞDi¥©ch
::
Echo
 },

41 { "S’dIcc", &
CÚŒŞDi¥©ch
::
S’dIcc
 },

42 { "InjeùF¿me", &
CÚŒŞDi¥©ch
::
InjeùF¿me
 },

43 { "Qu”yCªdid©eAdd»ssS‘", &
CÚŒŞDi¥©ch
::
Qu”yCªdid©eAdd»ssS‘
 },

44 { "Qu”yLškSts", &
CÚŒŞDi¥©ch
::
Qu”yLškSts
 },

45 { "Qu”yTuÂ–Info", &
CÚŒŞDi¥©ch
::
Qu”yTuÂ–Info
 },

46 { "RemoveTuÂ–", &
CÚŒŞDi¥©ch
::
RemoveTuÂ–
 },

47 { "RemoveLšk", &
CÚŒŞDi¥©ch
::
RemoveLšk
 },

48 { "Upd©eM­", &
CÚŒŞDi¥©ch
::
Upd©eRou‹TabË
 },

51 
	gCÚŒŞDi¥©ch
::~
CÚŒŞDi¥©ch
()

53 
LogMes§ge
::
RemoveLogToSŒ—m
(
log_sšk_
.
g‘
());

57 
	gCÚŒŞDi¥©ch
::
İ”©Ü
 (è(
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

59 
Œy
 {

60 
cÚŒŞ
.
G‘CÚŒŞTy³
()) {

61 
TšÿnCÚŒŞ
::
CTTšÿnReque¡
:

62 (
this
->*
cÚŒŞ_m­_
.
©
(
cÚŒŞ
.
G‘Commªd
()))(control);

64 
	gTšÿnCÚŒŞ
::
CTTšÿnRe¥Ú£
:

68 
LOG
(
LS_WARNING
) << "Unrecognized controlype„eceived‡nd discarded.";

72 
ÿtch
(
out_of_¿nge
 & 
e
) {

73 
LOG
(
LS_WARNING
) << "An invalid IPOP control operation was„eceived‡nd "

74 "disÿrded: " << 
	gcÚŒŞ
.
StyËdSŒšg
(è<< "Exû±iÚ=" << 
	ge
.
wh©
();

76 
ÿtch
(
exû±iÚ
 & 
e
)

78 
LOG
(
LS_WARNING
è<< 
	ge
.
wh©
();

82 
	gCÚŒŞDi¥©ch
::
S‘Di¥©chToTšÿnInf
(

83 
TšÿnDi¥©chIÁ”çû
 * 
dtÙ
)

85 
tšÿn_
 = 
dtÙ
;

88 
	gCÚŒŞDi¥©ch
::
S‘Di¥©chToLi¡’”Inf
(

89 
Di¥©chToLi¡’”Inf
 * 
dtŞ
)

91 
dtŞ_
 = 
dtŞ
;

95 
	gCÚŒŞDi¥©ch
::
CÚfigu»Loggšg
(

96 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

98 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

99 
¡ršg
 
	glog_lvl
 = 
»q
[
TšÿnCÚŒŞ
::
Lev–
].
asSŒšg
();

100 
¡ršg
 
msg
("Tincan†ogging successfully configured.");

101 
boŞ
 
	g¡©us
 = 
Œue
;

102 
	gŒy


104 
o¡ršg¡»am
 
	goss
;

105 
	g¡d
::
ŒªsfÜm
(
log_lvl
.
begš
(),†og_lvl.
’d
(),†og_lvl.begin(),

106 [=](
c
è{ 
¡©ic_ÿ¡
<>(::
tŞow”
(c));});

107 
	goss
 << "t¡am°" << "th»ad " << 
	glog_lvl
.
c_¡r
();

108 
	gLogMes§ge
::
CÚfigu»Loggšg
(
oss
.
¡r
().
c_¡r
());

109 
	gLogMes§ge
::
LogToDebug
(
LS_WARNING
);

110 
	gLogMes§ge
::
S‘LogToStd”r
(
Œue
);

111 if(
	g»q
["Deviû"].
asSŒšg
(è=ğ"AÎ" || 
»q
["Device"].asString() == "File")

113 
LogMes§ge
::
S‘LogToStd”r
(
çl£
);

114 
¡ršg
 
	gdœ
 = 
»q
["DœeùÜy"].
asSŒšg
();

115 
	g¹c
::
P©hÇme
 
²
(
dœ
);

116 if(!
	gFesy¡em
::
IsFŞd”
(
²
))

117 
Fesy¡em
::
C»©eFŞd”
(
²
);

118 
¡ršg
 
	gâ
 = 
»q
["F’ame"].
asSŒšg
();

119 
size_t
 
	gmax_sz
 = 
»q
["MaxFeSize"].
asUIÁ64
();

120 
size_t
 
	gnum_æs
 = 
»q
["MaxArchives"].
asUIÁ64
();

121 
	glog_sšk_
 = 
make_unique
<
FeRÙ©šgLogSšk
>(
dœ
, 
	gâ
, 
	gmax_sz
, 
	gnum_æs
);

122 
	glog_sšk_
->
In™
();

123 
	glog_lvl
 = 
»q
[
TšÿnCÚŒŞ
::
Lev–
].
asSŒšg
();

124 
	gLogMes§ge
::
AddLogToSŒ—m
(
log_sšk_
.
g‘
(), 
G‘LogLev–
(
log_lvl
));

126 if(
	g»q
["Deviû"].
asSŒšg
() == "All" ||

127 
»q
["Deviû"].
asSŒšg
() == "Console")

129 if(
»q
["CÚsŞeLev–"].
asSŒšg
().
Ëngth
() > 0)

130 
log_lvl
 = 
»q
["CÚsŞeLev–"].
asSŒšg
();

131 if(
	g»q
[
TšÿnCÚŒŞ
::
Lev–
].
asSŒšg
().
Ëngth
() > 0)

132 
log_lvl
 = 
»q
[
TšÿnCÚŒŞ
::
Lev–
].
asSŒšg
();

133 
	gLogMes§ge
::
LogToDebug
(
G‘LogLev–
(
log_lvl
));

134 
	gLogMes§ge
::
S‘LogToStd”r
(
Œue
);

136 } 
ÿtch
(
exû±iÚ
 &)

138 
	gLogMes§ge
::
LogToDebug
(
LS_WARNING
);

139 
	gLogMes§ge
::
S‘LogToStd”r
(
Œue
);

140 
	gmsg
 = "The configure†ogging operation failed. Using Console/WARNING";

141 
LOG
(
LS_WARNING
è<< 
	gmsg
;

142 
	g¡©us
 = 
çl£
;

144 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
¡©us
);

145 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

149 
	gCÚŒŞDi¥©ch
::
C»©eLšk
(

150 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

152 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

153 
¡ršg
 
msg
("Connectiono…eer‚ode in…rogress.");

154 
boŞ
 
	g¡©us
 = 
çl£
;

155 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

156 
	gŒy


158 
	gtšÿn_
->
C»©eVlšk
(
»q
, 
cÚŒŞ
);

159 
	g¡©us
 = 
Œue
;

160 } 
ÿtch
(
exû±iÚ
 & 
e
)

162 
	gmsg
 = "CreateLink failed.";

163 
LOG
(
LS_WARNING
è<< 
	ge
.
wh©
() << ". Control Data=\n" <<

164 
	gcÚŒŞ
.
StyËdSŒšg
();

166 if(!
	g¡©us
)

168 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
¡©us
);

169 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

173 
	gCÚŒŞDi¥©ch
::
C»©eIpİCÚŒŞËrRe¥Lšk
(

174 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

176 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

177 
¡ršg
 
	g
 = 
»q
["IP"].
asSŒšg
();

178 
	gpÜt
 = 
»q
["PÜt"].
asIÁ
();

179 
¡ršg
 
msg
("Controllerƒndpoint successfully created.");

180 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

181 
	gŒy


183 
	gunique_±r
<
	gSock‘Add»ss
> 
ù¾_addr
(
Ãw
 
Sock‘Add»ss
(

, 
pÜt
));

184 
	gdtŞ_
->
C»©eIpİCÚŒŞËrLšk
(
move
(
ù¾_addr
));

185 
d–‘e
 
	gù¾_lšk_
;

186 
	gù¾_lšk_
 = &
dtŞ_
->
G‘IpİCÚŒŞËrLšk
();

187 
	gtšÿn_
->
S‘IpİCÚŒŞËrLšk
(
ù¾_lšk_
);

188 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
Œue
);

189 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

191 
ÿtch
(
exû±iÚ
 & 
e
)

195 
LOG
(
LS_ERROR
è<< 
	ge
.
wh©
() << ". Control Data=\n" <<

196 
	gcÚŒŞ
.
StyËdSŒšg
();

201 
	gCÚŒŞDi¥©ch
::
C»©eTuÂ–
(

202 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

204 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

205 
	gunique_±r
<
	gJsÚ
::
V®ue
> 
»¥
 = 
make_unique
<
JsÚ
::V®ue>(JsÚ::
objeùV®ue
);

206 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

207 
	gŒy


209 
	gtšÿn_
->
C»©eTuÂ–
(
»q
, (*
»¥
)["Message"]);

210 (*
	g»¥
)["Sucûss"] = 
Œue
;

211 } 
ÿtch
(
exû±iÚ
 & 
e
)

213 
¡ršg
 
	g”_msg
 = "The CreateTunnel operation failed.";

214 
LOG
(
LS_ERROR
è<< 
	g”_msg
 << 
	ge
.
wh©
() << ". Control Data=\n" <<

215 
	gcÚŒŞ
.
StyËdSŒšg
();

216 (*
	g»¥
)["Mes§ge"] = 
”_msg
;

217 (*
	g»¥
)["Sucûss"] = 
çl£
;

219 
	gcÚŒŞ
.
S‘Re¥Ú£
(
move
(
»¥
));

220 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

223 
	gCÚŒŞDi¥©ch
::
Echo
(
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

225 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

226 
¡ršg
 
	gmsg
 = 
»q
[
TšÿnCÚŒŞ
::
Mes§ge
].
asSŒšg
();

227 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
Œue
);

228 
	gcÚŒŞ
.
S‘CÚŒŞTy³
(
TšÿnCÚŒŞ
::
CTTšÿnRe¥Ú£
);

229 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

232 
LoggšgSev”™y


233 
	gCÚŒŞDi¥©ch
::
G‘LogLev–
(

234 cÚ¡ 
¡ršg
 & 
log_Ëv–
)

236 
LoggšgSev”™y
 
lv
 = 
LS_WARNING
;

237 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

238 ià(
	glog_Ëv–
 == "NONE")

239 
lv
 = 
¹c
::
LS_NONE
;

240 ià(
	glog_Ëv–
 == "ERROR")

241 
lv
 = 
¹c
::
LS_ERROR
;

242 ià(
	glog_Ëv–
 == "WARNING")

243 
lv
 = 
¹c
::
LS_WARNING
;

244 ià(
	glog_Ëv–
 =ğ"INFO" || 
log_Ëv–
 == "VERBOSE" ||†og_level == "DEBUG")

245 
lv
 = 
¹c
::
LS_INFO
;

246 ià(
	glog_Ëv–
 == "SENSITIVE")

247 
lv
 = 
¹c
::
LS_SENSITIVE
;

248 ià(
	glog_Ëv–
 == "LS_VERBOSE")

249 
lv
 = 
¹c
::
LS_VERBOSE
;

252 
¡ršg
 
	gmsg
 = "An invalid†og†evel was specified = ";

253 
LOG
(
LS_WARNING
è<< 
	gmsg
 << 
	glog_Ëv–
 << ". Defaultingo WARNING";

255  
	glv
;

259 
	gCÚŒŞDi¥©ch
::
InjeùF¿me
(

260 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

262 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

263 
¡ršg
 
	gmsg
 = "InjectFrame failed.";

264 
boŞ
 
	g¡©us
 = 
çl£
;

265 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

266 
	gŒy


268 
	gtšÿn_
->
InjeùF¿me
(
»q
);

269 
	gmsg
 = "InjectFrame succeeded.";

270 
	g¡©us
 = 
Œue
;

271 } 
ÿtch
(
exû±iÚ
 & 
e
)

273 
LOG
(
LS_WARNING
è<< 
	ge
.
wh©
() << ". Control Data=\n" <<

274 
	gcÚŒŞ
.
StyËdSŒšg
();

276 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
¡©us
);

277 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

281 
	gCÚŒŞDi¥©ch
::
Qu”yCªdid©eAdd»ssS‘
(

282 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

284 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
(), 
	gÿs_šfo
;

285 
¡ršg
 
	g»¥
;

286 
boŞ
 
	g¡©us
 = 
çl£
;

287 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

288 
	gŒy


290 
	gtšÿn_
->
Qu”yLškCas
(
»q
, 
ÿs_šfo
);

291 
	g»¥
 = 
ÿs_šfo
.
toStyËdSŒšg
();

292 
	g¡©us
 = 
Œue
;

293 } 
ÿtch
(
exû±iÚ
 & 
e
)

295 
	g»¥
 = "The QueryCandidateAddressSet operation failed. ";

296 
LOG
(
LS_WARNING
è<< 
	g»¥
 << 
	ge
.
wh©
() << ". Control Data=\n" <<

297 
	gcÚŒŞ
.
StyËdSŒšg
();

299 
	gcÚŒŞ
.
S‘Re¥Ú£
(
»¥
, 
¡©us
);

300 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

304 
	gCÚŒŞDi¥©ch
::
Qu”yLškSts
(

305 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

307 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

308 
	gunique_±r
<
	gJsÚ
::
V®ue
> 
»¥
 = 
make_unique
<
JsÚ
::V®ue>(JsÚ::
objeùV®ue
);

309 (*
	g»¥
)["Sucûss"] = 
çl£
;

310 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

311 
	gŒy


313 
	gtšÿn_
->
Qu”yLškSts
(
»q
, (*
»¥
)["Message"]);

314 (*
	g»¥
)["Sucûss"] = 
Œue
;

315 } 
ÿtch
(
exû±iÚ
 & 
e
)

317 
¡ršg
 
	g”_msg
 = "The QueryLinkStats operation failed. ";

318 
LOG
(
LS_WARNING
è<< 
	g”_msg
 << 
	ge
.
wh©
() << ". Control Data=\n" <<

319 
	gcÚŒŞ
.
StyËdSŒšg
();

320 (*
	g»¥
)["Mes§ge"] = 
”_msg
;

321 (*
	g»¥
)["Sucûss"] = 
çl£
;

323 
	gcÚŒŞ
.
S‘Re¥Ú£
(
move
(
»¥
));

324 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

328 
	gCÚŒŞDi¥©ch
::
Qu”yTuÂ–Info
(

329 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

331 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
(), 
	gnode_šfo
;

332 
¡ršg
 
»¥
("The QueryTunnelInfo operation succeeded");

333 
boŞ
 
	g¡©us
 = 
çl£
;

334 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

335 
	gŒy


337 
	gtšÿn_
->
Qu”yTuÂ–Info
(
»q
, 
node_šfo
);

338 
	g»¥
 = 
node_šfo
.
toStyËdSŒšg
();

339 
	g¡©us
 = 
Œue
;

340 } 
ÿtch
(
exû±iÚ
 & 
e
)

342 
	g»¥
 = "The QueryTunnelInfo operation failed. ";

343 
	g»¥
.
­³nd
(
e
.
wh©
());

344 
LOG
(
LS_WARNING
è<< 
	g»¥
 << 
	ge
.
wh©
() << ". Control Data=\n" <<

345 
	gcÚŒŞ
.
StyËdSŒšg
();

347 
	gcÚŒŞ
.
S‘Re¥Ú£
(
»¥
, 
¡©us
);

348 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

353 
	gCÚŒŞDi¥©ch
::
RemoveLšk
(

354 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

356 
boŞ
 
¡©us
 = 
çl£
;

357 
	gJsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

358 
¡ršg
 
msg
("The RemoveLink operation succeeded");

359 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

360 
	gŒy


362 
	gtšÿn_
->
RemoveVlšk
(
»q
);

363 
	g¡©us
 = 
Œue
;

364 } 
ÿtch
(
exû±iÚ
 & 
e
)

366 
	gmsg
 = "The RemoveLink operation failed.";

367 
LOG
(
LS_WARNING
è<< 
	ge
.
wh©
() << ". Control Data=\n" <<

368 
	gcÚŒŞ
.
StyËdSŒšg
();

370 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
¡©us
);

371 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

375 
	gCÚŒŞDi¥©ch
::
RemoveTuÂ–
(

376 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

378 
boŞ
 
¡©us
 = 
çl£
;

379 
	gJsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

380 
¡ršg
 
msg
("The RemoveTunnel operation ");

381 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

382 
	gŒy


384 
	gtšÿn_
->
RemoveTuÂ–
(
»q
);

385 
	g¡©us
 = 
Œue
;

386 
	gmsg
.
­³nd
("succeeded.");

387 } 
ÿtch
(
exû±iÚ
 & 
e
)

389 
	gmsg
 = "failed.";

390 
LOG
(
LS_WARNING
è<< 
	ge
.
wh©
() << ". Control Data=\n" <<

391 
	gcÚŒŞ
.
StyËdSŒšg
();

393 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
¡©us
);

394 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

398 
	gCÚŒŞDi¥©ch
::
S’dIcc
(

399 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

401 
JsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

402 
¡ršg
 
msg
("The ICC operation succeeded");

403 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

404 
	gŒy


406 
	gtšÿn_
->
S’dIcc
(
»q
);

407 } 
ÿtch
(
exû±iÚ
 & 
e
)

409 
	gmsg
 = "The ICC operation failed.";

410 
LOG
(
LS_WARNING
è<< 
	ge
.
wh©
() << ". Control Data=\n" <<

411 
	gcÚŒŞ
.
StyËdSŒšg
();

412 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
çl£
);

413 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

418 
	gCÚŒŞDi¥©ch
::
Upd©eRou‹TabË
(

419 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

421 
boŞ
 
¡©us
 = 
çl£
;

422 
	gJsÚ
::
V®ue
 & 
»q
 = 
cÚŒŞ
.
G‘Reque¡
();

423 
¡ršg
 
	gmsg
 = "The Add Routes operation failed.";

424 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
di¥_mu‹x_
);

425 
	gŒy


427 
	gtšÿn_
->
Upd©eRou‹TabË
(
»q
);

428 
	g¡©us
 = 
Œue
;

429 
	gmsg
 = "The Add Routes opertation completed successfully.";

430 } 
ÿtch
(
exû±iÚ
 & 
e
)

432 
LOG
(
LS_WARNING
è<< 
	ge
.
wh©
() << ". Control Data=\n" <<

433 
	gcÚŒŞ
.
StyËdSŒšg
();

435 
	gcÚŒŞ
.
S‘Re¥Ú£
(
msg
, 
¡©us
);

436 
	gù¾_lšk_
->
D–iv”
(
cÚŒŞ
);

	@src/control_listener.cc

23 
	~"web¹c/¹c_ba£/Ãt_h–³r.h
"

24 
	~"cÚŒŞ_li¡’”.h
"

25 
	~"tšÿn_exû±iÚ.h
"

26 
Çme¥aû
 
	gtšÿn


28 
usšg
 
Çme¥aû
 
	g¹c
;

29 
	gCÚŒŞLi¡’”
::
CÚŒŞLi¡’”
(
unique_±r
<
CÚŒŞDi¥©ch
> 
cÚŒŞ_di¥©ch
):

30 
ù¾_di¥©ch_
(
move
(
cÚŒŞ_di¥©ch
)),

31 
·ck‘_İtiÚs_
(
DSCP_DEFAULT
)

33 
	gù¾_di¥©ch_
->
S‘Di¥©chToLi¡’”Inf
(
this
);

36 
	gCÚŒŞLi¡’”
::~
CÚŒŞLi¡’”
()

40 
CÚŒŞLi¡’”
::
R—dPack‘HªdËr
(

41 
AsyncPack‘Sock‘
 *,

42 cÚ¡ * 
d©a
,

43 
size_t
 
Ën
,

44 cÚ¡ 
Sock‘Add»ss
 &,

45 cÚ¡ 
Pack‘Time
 &)

47 
	gŒy
 {

48 
TšÿnCÚŒŞ
 
ù¾
(
d©a
, 
Ën
);

49 
LOG
(
LS_INFO
è<< "Reûived CONTROL: " << 
	gù¾
.
StyËdSŒšg
();

50 (*
	gù¾_di¥©ch_
)(
	gù¾
);

52 
ÿtch
(
exû±iÚ
 & 
e
) {

53 
LOG
(
LS_WARNING
è<< "A cÚŒŞ faedØexecu‹." << 
	g’dl


54 << 
¡ršg
(
d©a
, 
Ën
è<< 
	g’dl


55 << 
	ge
.
wh©
();

61 
	gCÚŒŞLi¡’”
::
D–iv”
(

62 
TšÿnCÚŒŞ
 & 
ù¾_»¥
)

64 
¡d
::
¡ršg
 
msg
 = 
ù¾_»¥
.
StyËdSŒšg
();

65 
LOG
(
LS_INFO
è<< "S’dšg CONTROL: " << 
	gmsg
;

66 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
skt_mu‹x_
);

67 
	g¢d_sock‘_
->
S’dTo
(
msg
.
c_¡r
(), msg.
Ëngth
(), *
ù¾_addr_
, 
·ck‘_İtiÚs_
);

70 
	gCÚŒŞLi¡’”
::
D–iv”
(

71 
unique_±r
<
TšÿnCÚŒŞ
> 
ù¾_»¥
)

73 
D–iv”
(*
ù¾_»¥
.
g‘
());

78 
	gCÚŒŞLi¡’”
::
C»©eIpİCÚŒŞËrLšk
(

79 
unique_±r
<
Sock‘Add»ss
> 
cÚŒŞËr_addr
)

81 
lock_gu¬d
<
mu‹x
> 
lg
(
skt_mu‹x_
);

82 
	gù¾_addr_
 = 
move
(
cÚŒŞËr_addr
);

83 
Sock‘FaùÜy
* 
	gsf
 = 
Th»ad
::
Cu¼’t
()->
sock‘£rv”
();

84 
	g¢d_sock‘_
 = 
make_unique
<
AsyncUDPSock‘
>(

85 
sf
->
C»©eAsyncSock‘
(
ù¾_addr_
->
çmy
(), 
SOCK_DGRAM
));

89 
	gCÚŒŞLi¡’”
::
Run
(

90 
Th»ad
* 
th»ad
)

92 
BasicPack‘Sock‘FaùÜy
 
·ck‘_çùÜy
;

93 
	grcv_sock‘_
.
»£t
(
·ck‘_çùÜy
.
C»©eUdpSock‘
(

94 
Sock‘Add»ss
(

.
kLoÿlHo¡
,p.
kUdpPÜt
), 0, 0));

95 ià(!
	grcv_sock‘_
)

96 
throw
 
TCEXCEPT
("Failedo create control†istener socket");

97 
LOG
(
LS_INFO
è<< "TšÿÀli¡’šg oÀ" << 
	g
.
	gkLoÿlHo¡
 << " UDP…Üˆ" <<p.
	gkUdpPÜt
;

98 
	grcv_sock‘_
->
	gSigÇlR—dPack‘
.
cÚÃù
(
this
,

99 &
CÚŒŞLi¡’”
::
R—dPack‘HªdËr
);

100 
	gth»ad
->
ProûssMes§ges
(-1);

	@src/linux/tapdev_lnx.cc

24 #ià
defšed
 (
_IPOP_LINUX
)

25 
	~"pdev_Êx.h
"

26 
	~"tšÿn_exû±iÚ.h
"

27 
	~<sys/ty³s.h
>

28 
	~<sys/sock‘.h
>

30 
Çme¥aû
 
	gtšÿn


32 
Çme¥aû
 
	glšux


35 cÚ¡ * cÚ¡ 
	gTUN_PATH
 = "/dev/net/tun";

37 
	gT­DevLnx
::
T­DevLnx
() :

38 
fd_
(-1),

39 
is_good_
(
çl£
)

41 
mem£t
(&
iä_
, 0x0, (ifr_));

44 
	gT­DevLnx
::~
T­DevLnx
()

46 ià(
fd_
 > -1)

47 
şo£
(
fd_
);

50 
	gT­DevLnx
::
O³n
(

51 cÚ¡ 
T­DesütÜ
 & 
p_desc
)

53 
¡ršg
 
emsg
("The Tap device open operation failed - ");

55 if((
	gfd_
 = 
İ’
(
TUN_PATH
, 
O_RDWR
)) < 0)

56 
throw
 
TCEXCEPT
(
emsg
.
c_¡r
());

57 
	giä_
.
	giä_æags
 = 
IFF_TAP
 | 
IFF_NO_PI
;

58 if(
	gp_desc
.
	gÇme
.
Ëngth
(è>ğ
IFNAMSIZ
)

60 
emsg
.
­³nd
("the‚ame†ength is†ongerhan maximum‡llowed.");

61 
throw
 
TCEXCEPT
(
emsg
.
c_¡r
());

63 
¡ºıy
(
iä_
.
iä_Çme
, 
p_desc
.
Çme
.
c_¡r
(),­_desc.Çme.
Ëngth
());

64 
	giä_
.
	giä_Çme
[
p_desc
.
Çme
.
Ëngth
()] = 0;

66 if(
ioùl
(
fd_
, 
TUNSETIFF
, (*)&
iä_
) < 0)

68 
	gemsg
.
­³nd
("the device could‚ot be created.");

69 
throw
 
TCEXCEPT
(
emsg
.
c_¡r
());

71 
	gcfg_skt
;

72 if((
	gcfg_skt
 = 
sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0)

74 
	gemsg
.
­³nd
("a socket bind failed.");

75 
throw
 
TCEXCEPT
(
emsg
.
c_¡r
());

78 if((
ioùl
(
cfg_skt
, 
SIOCGIFHWADDR
, &
iä_
)) < 0)

80 
	gemsg
.
­³nd
("retrievinghe device mac‡ddress failed");

81 
şo£
(
cfg_skt
);

82 
throw
 
TCEXCEPT
(
emsg
.
c_¡r
());

84 
memıy
(
mac_
.
d©a
(), 
iä_
.
iä_hwaddr
.
§_d©a
, 6);

86 ià(
ioùl
(
cfg_skt
, 
SIOCGIFFLAGS
, &
iä_
) < 0)

88 
şo£
(
cfg_skt
);

89 
throw
 
TCEXCEPT
(
emsg
.
c_¡r
());

92 
şo£
(
cfg_skt
);

95 
	gT­DevLnx
::
Clo£
()

97 
şo£
(
fd_
);

98 
	gfd_
 = -1;

101 
	gT­DevLnx
::
PËnToIpv4Mask
(

102 
´efix_Ën
,

103 
sockaddr
 * 
wr™eback
)

105 
ušt32_t
 
	gÃt_mask_št
 = ~(0uè<< (32 - 
´efix_Ën
);

106 
	gÃt_mask_št
 = 
htÚl
(
Ãt_mask_št
);

107 
sockaddr_š
 
	gÃtmask
 = {

108 .
sš_çmy
 = 
AF_INET
,

109 .
	gsš_pÜt
 = 0

111 
š_addr
 
	gÃtmask_addr
 = { .
s_addr
 = 
Ãt_mask_št
 };

112 
	gÃtmask
.
	gsš_addr
 = 
Ãtmask_addr
;

114 
memıy
(
wr™eback
, &
Ãtmask
, (
sockaddr
));

127 
	gT­DevLnx
::
S‘FÏgs
(

128 
’abË
,

129 
di§bË
)

131 
	gcfg_skt
;

132 
¡ršg
 
emsg
("The TAP device set flags operation failed");

133 ià((
	gcfg_skt
 = 
sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0)

135 
	gemsg
.
­³nd
("a socket bind failed.");

137 
LOG
(
LS_ERROR
è<< 
	gemsg
;

141 
	giä_
.
	giä_æags
 |ğ
’abË
;

142 
	giä_
.
	giä_æags
 &ğ~
di§bË
;

144 ià(
ioùl
(
cfg_skt
, 
SIOCSIFFLAGS
, &
iä_
) < 0)

146 
şo£
(
cfg_skt
);

148 
LOG
(
LS_ERROR
è<< 
	gemsg
;

150 
şo£
(
cfg_skt
);

153 
ušt32_t
 
	gT­DevLnx
::
R—d
(
AsyncIo
& 
aio_rd
)

155 if(!
is_good_
 || 
»ad”_
->
IsQu™tšg
())

157 
T­Mes§geD©a
 *
	g_
 = 
Ãw
 TapMessageData;

158 
	g_
->
	gaio_
 = &
aio_rd
;

159 
	g»ad”_
->
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_READ
, 
_
);

163 
ušt32_t
 
	gT­DevLnx
::
Wr™e
(
AsyncIo
& 
aio_wr
)

165 if(!
is_good_
 || 
wr™”_
->
IsQu™tšg
())

167 
T­Mes§geD©a
 *
	g_
 = 
Ãw
 TapMessageData;

168 
	g_
->
	gaio_
 = &
aio_wr
;

169 
	gwr™”_
->
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_WRITE
, 
_
);

173 
ušt16_t
 
	gT­DevLnx
::
T­DevLnx
::
Mtu
()

175  
iä_
.
iä_mtu
;

178 
MacAdd»ssTy³
 
	gT­DevLnx
::
MacAdd»ss
()

180  
mac_
;

183 
	gT­DevLnx
::
Up
()

185 ià(
is_good_
)

187 
	gis_good_
 = 
Œue
;

188 
S‘FÏgs
(
IFF_UP
, 0);

189 ià(
	gwr™”_
)

191 
	gwr™”_
->
Qu™
();

192 
	gwr™”_
.
»£t
();

194 ià(
	g»ad”_
)

196 
	g»ad”_
->
Qu™
();

197 
	g»ad”_
.
»£t
();

199 
	g»ad”_
 = 
make_unique
<
¹c
::
Th»ad
>();

200 
	g»ad”_
->
S¹
();

201 
	gwr™”_
 = 
make_unique
<
¹c
::
Th»ad
>();

202 
	gwr™”_
->
S¹
();

205 
	gT­DevLnx
::
Down
()

207 
is_good_
 = 
çl£
;

208 if(
	gwr™”_
)

209 
	gwr™”_
->
Qu™
();

210 if(
	g»ad”_
)

211 
	g»ad”_
->
Qu™
();

212 
	g»ad”_
.
»£t
();

213 
	gwr™”_
.
»£t
();

214 
S‘FÏgs
(0, 
IFF_UP
);

216 
LOG
(
LS_INFO
) << "TAP device state seto DOWN";

220 
	gT­DevLnx
::
OnMes§ge
(
Mes§ge
 * 
msg
)

222 
msg
->
mes§ge_id
)

224 
MSGID_READ
:

226 
AsyncIo
* 
aio_»ad
 = ((
T­Mes§geD©a
*)
msg
->
pd©a
)->
aio_
;

227 ià(
	gis_good_
) {

228 
	gÄ—d
 = 
»ad
(
fd_
, 
aio_»ad
->
BufãrToT¿nsãr
(),‡io_»ad->
By‹sToT¿nsãr
());

229 
	gaio_»ad
->
	ggood_
 = (
Ä—d
 >= 0);

230 
	gaio_»ad
->
By‹sT¿nsã¼ed
(
Ä—d
);

231 
»ad_com¶‘iÚ_
(
aio_»ad
);

235 
LOG
(
LS_INFO
) << "TAP shutting down, dropping IO.";

236 
d–‘e
 
	gaio_»ad
;

240 
	gMSGID_WRITE
:

242 
AsyncIo
* 
aio_wr™e
 = ((
T­Mes§geD©a
*)
msg
->
pd©a
)->
aio_
;

243 
	gnwr™e
 = 
wr™e
(
fd_
, 
aio_wr™e
->
BufãrToT¿nsãr
(),‡io_wr™e->
By‹sToT¿nsãr
());

244 if(
	gnwr™e
 < 0)

246 
LOG
(
LS_WARNING
) << "A TAP Write operation failed.";

247 
	gaio_wr™e
->
	ggood_
 = 
çl£
;

251 
	gaio_wr™e
->
	ggood_
 = 
Œue
;

253 
	gaio_wr™e
->
By‹sT¿nsã¼ed
(
nwr™e
);

254 
wr™e_com¶‘iÚ_
(
aio_wr™e
);

258 
d–‘e
 (
T­Mes§geD©a
*)
	gmsg
->
	gpd©a
;

261 
IP4Add»ssTy³


262 
	gT­DevLnx
::
Ip4
()

264  
4_
;

	@src/multi_link_tunnel.cc

23 
	~"muÉi_lšk_tuÂ–.h
"

24 
	~"web¹c/¹c_ba£/thœd_·¹y/ba£64/ba£64.h
"

25 
	~"tšÿn_cÚŒŞ.h
"

26 
Çme¥aû
 
	gtšÿn


28 
TšÿnP¬am‘”s
 

;

29 
	gMuÉiLškTuÂ–
::
MuÉiLškTuÂ–
(

30 
unique_±r
<
TuÂ–DesütÜ
> 
desütÜ
,

31 
IpİCÚŒŞËrLšk
 * 
ù¾_hªdË
) :

32 
BasicTuÂ–
(
move
(
desütÜ
), 
ù¾_hªdË
)

34 
	g³”_ÃtwÜk_
 = 
make_unique
<
P“rN‘wÜk
>();

37 
	gMuÉiLškTuÂ–
::~
MuÉiLškTuÂ–
()

40 
sh¬ed_±r
<
Vœtu®Lšk
>

41 
MuÉiLškTuÂ–
::
C»©eVlšk
(

42 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

43 
unique_±r
<
P“rDesütÜ
> 
³”_desc
)

45 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
	gvl
;

49 if(
	g³”_ÃtwÜk_
->
Exi¡s
(
vlšk_desc
->
uid
))

51 
	gvl
 = 
³”_ÃtwÜk_
->
G‘VlškById
(
vlšk_desc
->
uid
);

52 
	gvl
->
P“rCªdid©es
(
³”_desc
->
ÿs
);

53 
	gvl
->
S¹CÚÃùiÚs
();

54 
LOG
(
LS_INFO
è<< "Added„emÙCASØvlšk w/…“¸" << 
	g³”_desc
->
	guid
;

58 
	güick‘
::
IûRŞe
 
œ
 = 
üick‘
::
ICEROLE_CONTROLLED
;

59 if(
	gloÿl_fšg”´št_
->
ToSŒšg
(è< 
	g³”_desc
->
	gfšg”´št
)

60 
	gœ
 = 
üick‘
::
ICEROLE_CONTROLLING
;

61 
¡ršg
 
	grŞes
[] = { "CONTROLLING", "CONTROLLED" };

62 
LOG
(
LS_INFO
è<< "C»©šg " << 
	grŞes
[
œ
] << " vlšk w/…“¸" << 
	g³”_desc
->
	guid
;

63 
	gvl
 = 
BasicTuÂ–
::
C»©eVlšk
(
move
(
vlšk_desc
), move(
³”_desc
), 
œ
);

64 
	g³”_ÃtwÜk_
->
Add
(
vl
);

66  
	gvl
;

70 
	gMuÉiLškTuÂ–
::
S¹
()

72 
BasicTuÂ–
::
S¹
();

73 
	gtdev_
->
Up
();

74 
	g³”_Ãt_th»ad_
.
S¹
(
³”_ÃtwÜk_
.
g‘
());

78 
	gMuÉiLškTuÂ–
::
Shutdown
()

80 
BasicTuÂ–
::
Shutdown
();

81 
	g³”_Ãt_th»ad_
.
Qu™
();

82 
	g³”_ÃtwÜk_
->
CË¬
();

86 
	gMuÉiLškTuÂ–
::
Upd©eRou‹TabË
(

87 cÚ¡ 
JsÚ
::
V®ue
 & 
¹_desü
)

93 
MuÉiLškTuÂ–
::
RemoveLšk
(

94 cÚ¡ 
¡ršg
 & 
vlšk_id
)

96 
³”_ÃtwÜk_
->
Remove
(
vlšk_id
);

99 
	gMuÉiLškTuÂ–
::
Qu”yInfo
(

100 
JsÚ
::
V®ue
 & 
Šl_šfo
)

102 
Šl_šfo
[
TšÿnCÚŒŞ
::
TuÂ–Id
] = 
desütÜ_
->
uid
;

103 
	gŠl_šfo
[
TšÿnCÚŒŞ
::
FPR
] = 
Fšg”´št
();

104 
	gŠl_šfo
[
TšÿnCÚŒŞ
::
T­Name
] = 
p_desc_
->
Çme
;

105 
	gŠl_šfo
[
TšÿnCÚŒŞ
::
MAC
] = 
MacAdd»ss
();

107 
	gŠl_šfo
[
TšÿnCÚŒŞ
::
Vlšks
] = 
JsÚ
::
V®ue
(JsÚ::
¬¿yV®ue
);

108 
	gveùÜ
<
	g¡ršg
> 
	gvlids
 = 
³”_ÃtwÜk_
->
Qu”yVlšks
();

109 autØ
	gvl
: 
vlids
)

111 
Šl_šfo
[
TšÿnCÚŒŞ
::
Vlšks
].
­³nd
(
vl
);

115 
	gMuÉiLškTuÂ–
::
Qu”yLškCas
(

116 cÚ¡ 
¡ršg
 & 
vlšk_id
,

117 
JsÚ
::
V®ue
 & 
ÿs_šfo
)

119 if(
³”_ÃtwÜk_
->
Exi¡s
(
vlšk_id
))

121 
sh¬ed_±r
<
Vœtu®Lšk
> 
vl
 = 
³”_ÃtwÜk_
->
G‘Vlšk
(
vlšk_id
);

122 if(
	gvl
->
IûRŞe
(è=ğ
üick‘
::
ICEROLE_CONTROLLING
)

123 
ÿs_šfo
[
TšÿnCÚŒŞ
::
IûRŞe
] = TšÿnCÚŒŞ::
CÚŒŞlšg
.
c_¡r
();

124 if(
	gvl
->
IûRŞe
(è=ğ
üick‘
::
ICEROLE_CONTROLLED
)

125 
ÿs_šfo
[
TšÿnCÚŒŞ
::
IûRŞe
] = TšÿnCÚŒŞ::
CÚŒŞËd
.
c_¡r
();

127 
	gÿs_šfo
[
TšÿnCÚŒŞ
::
CAS
] = 
vl
->
Cªdid©es
();

132 
	gMuÉiLškTuÂ–
::
Qu”yLškIds


133 (
veùÜ
<
¡ršg
>& 
lšk_ids
)

135 
lšk_ids
 = 
³”_ÃtwÜk_
->
Qu”yVlšks
();

139 
	gMuÉiLškTuÂ–
::
Qu”yLškInfo
(

140 cÚ¡ 
¡ršg
 & 
vlšk_id
,

141 
JsÚ
::
V®ue
 & 
vlšk_šfo
)

143 if(
³”_ÃtwÜk_
->
Exi¡s
(
vlšk_id
))

145 
sh¬ed_±r
<
Vœtu®Lšk
> 
vl
 = 
³”_ÃtwÜk_
->
G‘VlškById
(
vlšk_id
);

146 if(
	gvl
->
IûRŞe
(è=ğ
üick‘
::
ICEROLE_CONTROLLING
)

147 
vlšk_šfo
[
TšÿnCÚŒŞ
::
IûRŞe
] = TšÿnCÚŒŞ::
CÚŒŞlšg
;

149 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
IûRŞe
] = TšÿnCÚŒŞ::
CÚŒŞËd
;

150 if(
	gvl
 && vl->
IsR—dy
())

152 
LškInfoMsgD©a
 
	gmd
;

153 
	gmd
.
	gvl
 = 
vl
;

154 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_QUERY_NODE_INFO
, &
md
);

155 
	gmd
.
	gmsg_ev’t
.
Wa™
(
Ev’t
::
kFÜev”
);

156 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Sts
].
sw­
(
md
.
šfo
);

157 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Stus
] = "ONLINE";

161 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Stus
] = "OFFLINE";

162 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Sts
] = 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
);

167 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Stus
] = "UNKNOWN";

168 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Sts
] = 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
);

173 
	gMuÉiLškTuÂ–
::
S’dIcc
(

174 cÚ¡ 
¡ršg
 & 
vlšk_id
,

175 cÚ¡ 
¡ršg
 & 
d©a
)

177 if(!
	g³”_ÃtwÜk_
->
Exi¡s
(
vlšk_id
))

178 
throw
 
TCEXCEPT
("No vlinkƒxists byhe specified id");

180 
	gunique_±r
<
	gIccMes§ge
> 
	gicc
 = 
make_unique
<
IccMes§ge
>();

181 
	gicc
->
Mes§ge
((
ušt8_t
*)
d©a
.
c_¡r
(), (
ušt16_t
)d©a.
Ëngth
());

182 
	gunique_±r
<
	gT¿nsm™MsgD©a
> 
	gmd
 = 
make_unique
<
T¿nsm™MsgD©a
>();

183 
	gmd
->
	gäm
 = 
move
(
icc
);

184 
	gmd
->
	gvl
 = 
³”_ÃtwÜk_
->
G‘VlškById
(
vlšk_id
);

185 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_SEND_ICC
, 
md
.
»Ëa£
());

203 
	gMuÉiLškTuÂ–
::
VlškR—dCom¶‘e
(

204 
ušt8_t
 * 
d©a
,

205 
ušt32_t
 
d©a_Ën
,

206 
Vœtu®Lšk
 & 
vlšk
)

208 
	gunique_±r
<
	gT­F¿me
> 
	gäame
 = 
make_unique
<
T­F¿me
>(
d©a
, 
	gd©a_Ën
);

209 
T­F¿mePrİ”t›s
 
å
(*
äame
);

210 if(
	gå
.
IsIccMsg
())

212 
	gunique_±r
<
	gTšÿnCÚŒŞ
> 
	gù¾
 = 
make_unique
<
TšÿnCÚŒŞ
>();

213 
	gù¾
->
S‘CÚŒŞTy³
(
TšÿnCÚŒŞ
::
CTTšÿnReque¡
);

214 
	gJsÚ
::
V®ue
 & 
»q
 = 
ù¾
->
G‘Reque¡
();

215 
	g»q
[
TšÿnCÚŒŞ
::
Commªd
] = TšÿnCÚŒŞ::
ICC
;

216 
	g»q
[
TšÿnCÚŒŞ
::
TuÂ–Id
] = 
desütÜ_
->
uid
;

217 
	g»q
[
TšÿnCÚŒŞ
::
LškId
] = 
vlšk
.
Id
();

218 
	g»q
[
TšÿnCÚŒŞ
::
D©a
] = 
¡ršg
((*)
äame
->
Paylßd
(),

219 
äame
->
PaylßdL’gth
());

220 
	gù¾_lšk_
->
D–iv”
(
move
(
ù¾
));

222 if(
	gå
.
IsFwdMsg
())

224 if(
	g³”_ÃtwÜk_
->
IsRou‹Exi¡s
(
å
.
De¡š©iÚMac
()))

226 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
	gvl
 = 
³”_ÃtwÜk_
->
G‘Rou‹
(
å
.
De¡š©iÚMac
());

227 
T¿nsm™MsgD©a
 *
	gmd
 = 
Ãw
 TransmitMsgData;

228 
	gmd
->
	gäm
 = 
move
(
äame
);

229 
	gmd
->
	gvl
 = 
vl
;

230 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_FWD_FRAME
, 
md
);

234 
	gunique_±r
<
	gTšÿnCÚŒŞ
> 
	gù¾
 = 
make_unique
<
TšÿnCÚŒŞ
>();

235 
	gù¾
->
S‘CÚŒŞTy³
(
TšÿnCÚŒŞ
::
CTTšÿnReque¡
);

236 
	gJsÚ
::
V®ue
 & 
»q
 = 
ù¾
->
G‘Reque¡
();

237 
	g»q
[
TšÿnCÚŒŞ
::
Commªd
] = TšÿnCÚŒŞ::
ReqRou‹Upd©e
;

238 
	g»q
[
TšÿnCÚŒŞ
::
TuÂ–Id
] = 
desütÜ_
->
uid
;

239 
	g»q
[
TšÿnCÚŒŞ
::
D©a
] = 
By‹A¼ayToSŒšg
(
äame
->
Paylßd
(),

240 
äame
->
PaylßdEnd
());

241 
	gù¾_lšk_
->
D–iv”
(
move
(
ù¾
));

244 ià(
	gå
.
IsDtfMsg
())

246 
	gäame
->
Dump
("Frame from vlink");

247 
	gäame
->
BufãrToT¿nsãr
(
äame
->
Paylßd
());

248 
	gäame
->
By‹sToT¿nsãr
(
äame
->
PaylßdL’gth
());

249 
	gäame
->
S‘Wr™eOp
();

250 
	gtdev_
->
Wr™e
(*
äame
.
»Ëa£
());

254 
LOG
(
LS_ERROR
) << "Unknown frameype„eceived!";

255 
	gäame
->
Dump
("Invalid header");

275 
	gMuÉiLškTuÂ–
::
T­R—dCom¶‘e
(

276 
AsyncIo
 * 
aio_rd
)

278 
T­F¿me
 * 
äame
 = 
¡©ic_ÿ¡
<T­F¿me*>(
aio_rd
->
cÚ‹xt_
);

279 if(!
	gaio_rd
->
	ggood_
)

281 
	gäame
->
In™Ÿlize
();

282 
	gäame
->
BufãrToT¿nsãr
(
äame
->
Paylßd
());

283 
	gäame
->
By‹sToT¿nsãr
(
äame
->
PaylßdC­ac™y
());

284 if(0 !ğ
tdev_
->
R—d
(*
äame
))

285 
d–‘e
 
äame
;

288 
	gäame
->
PaylßdL’gth
(
äame
->
By‹sT¿nsã¼ed
());

289 
T­F¿mePrİ”t›s
 
å
(*
äame
);

290 
MacAdd»ssTy³
 
	gmac
 = 
å
.
De¡š©iÚMac
();

291 
	gäame
->
BufãrToT¿nsãr
(
äame
->
Begš
());

292 
	gäame
->
By‹sToT¿nsãr
(
äame
->
L’gth
());

293 if(
	g³”_ÃtwÜk_
->
IsAdjaûÁ
(
mac
))

295 
	gäame
->
H—d”
(

.
kDtfMagic
);

297 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
	gvl
 = 
³”_ÃtwÜk_
->
G‘Vlšk
(
mac
);

298 
T¿nsm™MsgD©a
 *
	gmd
 = 
Ãw
 TransmitMsgData;

299 
	gmd
->
	gäm
.
»£t
(
äame
);

300 
	gmd
->
	gvl
 = 
vl
;

301 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_TRANSMIT
, 
md
);

303 if(
	g³”_ÃtwÜk_
->
IsRou‹Exi¡s
(
mac
))

305 
	gäame
->
H—d”
(

.
kFwdMagic
);

307 
T¿nsm™MsgD©a
 *
	gmd
 = 
Ãw
 TransmitMsgData;

308 
	gmd
->
	gäm
.
»£t
(
äame
);

309 
	gmd
->
	gvl
 = 
³”_ÃtwÜk_
->
G‘Rou‹
(
mac
);

310 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_FWD_FRAME
, 
md
);

314 
	gäame
->
H—d”
(

.
kIccMagic
);

316 
	gunique_±r
<
	gTšÿnCÚŒŞ
> 
	gù¾
 = 
make_unique
<
TšÿnCÚŒŞ
>();

317 
	gù¾
->
S‘CÚŒŞTy³
(
TšÿnCÚŒŞ
::
CTTšÿnReque¡
);

318 
	gJsÚ
::
V®ue
 & 
»q
 = 
ù¾
->
G‘Reque¡
();

319 
	g»q
[
TšÿnCÚŒŞ
::
Commªd
] = TšÿnCÚŒŞ::
ReqRou‹Upd©e
;

320 
	g»q
[
TšÿnCÚŒŞ
::
TuÂ–Id
] = 
desütÜ_
->
uid
;

321 
	g»q
[
TšÿnCÚŒŞ
::
D©a
] = 
By‹A¼ayToSŒšg
(
äame
->
Paylßd
(),

322 
äame
->
PaylßdEnd
());

323 
	gù¾_lšk_
->
D–iv”
(
move
(
ù¾
));

325 
	gäame
->
In™Ÿlize
(
äame
->
Paylßd
(), f¿me->
PaylßdC­ac™y
());

326 if(0 !ğ
tdev_
->
R—d
(*
äame
))

327 
d–‘e
 
äame
;

332 
	gMuÉiLškTuÂ–
::
T­Wr™eCom¶‘e
(

333 
AsyncIo
 * 
aio_wr
)

335 
T­F¿me
 * 
äame
 = 
¡©ic_ÿ¡
<T­F¿me*>(
aio_wr
->
cÚ‹xt_
);

336 if(
	gäame
->
IsGood
())

337 
	gäame
->
Dump
("TAP Write Completed");

339 
LOG
(
LS_WARNING
) << "Tap Write FAILED completion";

340 
d–‘e
 
	gäame
;

	@src/peer_network.cc

23 
	~"³”_ÃtwÜk.h
"

24 
	~"tšÿn_exû±iÚ.h
"

25 
Çme¥aû
 
	gtšÿn


27 
	gP“rN‘wÜk
::
P“rN‘wÜk
() :

28 
sÿv’ge_š‹rv®
(120000)

31 
P“rN‘wÜk
::~PeerNetwork()

33 
CË¬
();

39 
	gP“rN‘wÜk
::
Add
(
sh¬ed_±r
<
Vœtu®Lšk
> 
vlšk
)

41 
vlšk
->
is_v®id_
 = 
Œue
;

42 
MacAdd»ssTy³
 
	gmac
;

43 
size_t
 
	gút
 = 
SŒšgToBy‹A¼ay
(

44 
vlšk
->
P“rInfo
().
mac_add»ss
, 
mac
.
begš
(), mac.
’d
());

45 if(
	gút
 != 6)

47 
¡ršg
 
emsg
 = "Convertinghe MACo binary failed,he input string is: ";

48 
	gemsg
.
­³nd
(
vlšk
->
P“rInfo
().
mac_add»ss
);

49 
throw
 
TCEXCEPT
(
emsg
.
c_¡r
());

52 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
mac_m­_mtx_
);

53 if(
	gmac_m­_
.
couÁ
(
mac
) == 1)

55 
LOG
(
LS_INFO
è<< "EÁry " << 
vlšk
->
P“rInfo
().
mac_add»ss
 <<

58 
	gmac_m­_
[
mac
] = 
vlšk
;

59 
	glšk_m­_
[
vlšk
->
Id
()] = vlink;

63 
	gP“rN‘wÜk
::
CË¬
()

65 
lock_gu¬d
<
mu‹x
> 
lgm
(
mac_m­_mtx_
);

66 
	gmac_rou‹s_
.
ş—r
();

67 
	gmac_m­_
.
ş—r
();

68 
	glšk_m­_
.
ş—r
();

71 
	gsh¬ed_±r
<
	gVœtu®Lšk
>

72 
	gP“rN‘wÜk
::
G‘Rou‹
(

73 cÚ¡ 
MacAdd»ssTy³
& 
mac
)

75 
lock_gu¬d
<
mu‹x
> 
lgm
(
mac_m­_mtx_
);

76 
	gHubEx
 & 
	ghux
 = 
mac_rou‹s_
.
©
(
mac
);

77 
	ghux
.
	gacûs£d
 = 
¡—dy_şock
::
now
();

78  
	ghux
.
	gvl
;

81 
	gsh¬ed_±r
<
	gVœtu®Lšk
>

82 
	gP“rN‘wÜk
::
G‘Vlšk
(

83 cÚ¡ 
¡ršg
 & 
mac
)

85 
MacAdd»ssTy³
 
mac_¬r
;

86 
SŒšgToBy‹A¼ay
(
mac
, 
mac_¬r
.
begš
(), mac_¬r.
’d
());

87  
G‘Vlšk
(
mac_¬r
);

90 
	gsh¬ed_±r
<
	gVœtu®Lšk
>

91 
	gP“rN‘wÜk
::
G‘Vlšk
(

92 cÚ¡ 
MacAdd»ssTy³
& 
mac
)

94 
lock_gu¬d
<
mu‹x
> 
lgm
(
mac_m­_mtx_
);

95  
	gmac_m­_
.
©
(
mac
);

98 
	gsh¬ed_±r
<
	gVœtu®Lšk
>

99 
	gP“rN‘wÜk
::
G‘VlškById
(

100 cÚ¡ 
¡ršg
 & 
lšk_id
)

102 
lock_gu¬d
<
mu‹x
> 
lgm
(
mac_m­_mtx_
);

103  
	glšk_m­_
.
©
(
lšk_id
);

106 
boŞ


107 
	gP“rN‘wÜk
::
Exi¡s
(

108 cÚ¡ 
¡ršg
 & 
lšk_id
)

110 
lock_gu¬d
<
mu‹x
> 
lgm
(
mac_m­_mtx_
);

111  (
	glšk_m­_
.
couÁ
(
lšk_id
) == 1);

114 
boŞ


115 
	gP“rN‘wÜk
::
IsAdjaûÁ
(

116 cÚ¡ 
¡ršg
 & 
mac
)

118 
MacAdd»ssTy³
 
mac_¬r
;

119 
SŒšgToBy‹A¼ay
(
mac
, 
mac_¬r
.
begš
(), mac_¬r.
’d
());

120  
IsAdjaûÁ
(
mac_¬r
);

123 
boŞ


124 
	gP“rN‘wÜk
::
IsAdjaûÁ
(

125 cÚ¡ 
MacAdd»ssTy³
& 
mac
)

127 
lock_gu¬d
<
mu‹x
> 
lgm
(
mac_m­_mtx_
);

128  (
	gmac_m­_
.
couÁ
(
mac
) == 1);

131 
boŞ


132 
	gP“rN‘wÜk
::
IsRou‹Exi¡s
(

133 cÚ¡ 
MacAdd»ssTy³
& 
mac
)

135 
boŞ
 
rv
 = 
çl£
;

136 
	glock_gu¬d
<
	gmu‹x
> 
lgm
(
mac_m­_mtx_
);

137 if(
	gmac_rou‹s_
.
couÁ
(
mac
) == 1)

139 if(
mac_rou‹s_
.
©
(
mac
).
vl
->
is_v®id_
)

140 
rv
 = 
Œue
;

142 
	gmac_rou‹s_
.
”a£
(
mac
);

144  
	grv
;

147 
	gveùÜ
<
	g¡ršg
>

148 
	gP“rN‘wÜk
::
Qu”yVlšks
()

150 
veùÜ
<
¡ršg
> 
vlids
;

151 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
mac_m­_mtx_
);

152 autØ
	gvl
 : 
mac_m­_
)

154 
vlids
.
push_back
(
vl
.
£cÚd
->
Id
());

156  
	gvlids
;

164 
	gP“rN‘wÜk
::
Remove
(

165 cÚ¡ 
¡ršg
 & 
lšk_id
)

167 
Œy


169 
lock_gu¬d
<
mu‹x
> 
lg
(
mac_m­_mtx_
);

170 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
	gvl
 = 
lšk_m­_
.
©
(
lšk_id
);

171 
	gvl
->
	gis_v®id_
 = 
çl£
;

174 
MacAdd»ssTy³
 
	gmac
;

175 
SŒšgToBy‹A¼ay
(
vl
->
P“rInfo
().
mac_add»ss
, 
mac
.
begš
(), mac.
’d
());

176 
	gmac_m­_
.
”a£
(
mac
);

177 
	glšk_m­_
.
”a£
(
vl
->
Id
());

178 } 
ÿtch
(
exû±iÚ
 & 
e
)

180 
LOG
(
LS_WARNING
è<< 
	ge
.
wh©
();

181 } 
ÿtch
(...)

183 
o¡ršg¡»am
 
	goss
;

184 
	goss
 << "FaedØ»movlšk: " << 
	glšk_id
;

185 
LOG
(
LS_WARNING
è<< 
	goss
.
¡r
().
c_¡r
();

190 
	gP“rN‘wÜk
::
Run
(
Th»ad
* 
th»ad
)

192 
¡—dy_şock
::
time_pošt
 
acûs£d
;

193 
mli£cÚds
 
	gexpœy_³riod
 = 3 * 
sÿv’ge_š‹rv®
;

194 
	gth»ad
->
ProûssMes§ges
(()
sÿv’ge_š‹rv®
.
couÁ
()))

196 
	gacûs£d
 = 
¡—dy_şock
::
now
();

197 
	gli¡
<
	gMacAdd»ssTy³
> 
	gml
;

198 
	glock_gu¬d
<
	gmu‹x
> 
lgm
(
mac_m­_mtx_
);

199 autØ& 
	gi
 : 
mac_rou‹s_
)

201 if(!
i
.
£cÚd
.
vl
->
is_v®id_
)

202 
ml
.
push_back
(
i
.
fœ¡
);

205 
	g¡d
::
chrÚo
::
du¿tiÚ
<, 
	gmli
> 
	g–­£d
 = 
¡—dy_şock
::
now
()

206 - 
i
.
£cÚd
.
acûs£d
;

207 if(
	g–­£d
 > 
	gexpœy_³riod
)

208 
	gml
.
push_back
(
i
.
fœ¡
);

211 autØ& 
	gmac
 : 
ml
)

213 
LOG
(
LS_INFO
) << "Scavenging„outeo "

214 << 
By‹A¼ayToSŒšg
(
mac
.
begš
(), mac.
’d
());

215 
	gmac_rou‹s_
.
”a£
(
mac
);

217 if(
LOG_CHECK_LEVEL
(
LS_INFO
))

219 
LOG
(
LS_INFO
) << "PeerNetwork scavengeook "

220 << (
	g¡—dy_şock
::
now
(è- 
acûs£d
).
couÁ
() << "‚anosecs.";

225 
	gP“rN‘wÜk
::
Upd©eRou‹TabË
(

226 
MacAdd»ssTy³
 & 
de¡
,

227 
MacAdd»ssTy³
 & 
rou‹
)

229 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
mac_m­_mtx_
);

239 if(
	gde¡
 =ğ
rou‹
 || 
mac_m­_
.
couÁ
(route) == 0 ||

240 (
mac_m­_
.
couÁ
(
rou‹
è&& !mac_m­_.
©
Ôou‹)->
is_v®id_
))

242 
¡ršg¡»am
 
oss
;

243 
	goss
 << "Attempto‡dd INVALID„oute! DEST=" <<

244 
By‹A¼ayToSŒšg
(
de¡
.
begš
(), de¡.
’d
()) << " ROUTE=" <<

245 
By‹A¼ayToSŒšg
(
rou‹
.
begš
(),„ou‹.
’d
());

246 
throw
 
TCEXCEPT
(
oss
.
¡r
().
c_¡r
());

248 
	gmac_rou‹s_
[
de¡
].
	gvl
 = 
mac_m­_
.
©
(
rou‹
);

249 
	gmac_rou‹s_
[
de¡
].
	gacûs£d
 = 
¡—dy_şock
::
now
();

250 
LOG
(
LS_INFO
) << "Updated„outeo‚ode=" <<

251 
By‹A¼ayToSŒšg
(
de¡
.
begš
(), de¡.
’d
()) << "hrough‚ode=" <<

252 
By‹A¼ayToSŒšg
(
rou‹
.
begš
(),„ou‹.
’d
()) << " vlink obj=" <<

253 
	gmac_rou‹s_
[
de¡
].
	gvl
.
g‘
();

	@src/single_link_tunnel.cc

23 
	~"sšgË_lšk_tuÂ–.h
"

24 
	~"tšÿn_exû±iÚ.h
"

25 
	~"tšÿn_cÚŒŞ.h
"

27 
Çme¥aû
 
	gtšÿn


29 
	gSšgËLškTuÂ–
::
SšgËLškTuÂ–
(

30 
unique_±r
<
TuÂ–DesütÜ
> 
desütÜ
,

31 
IpİCÚŒŞËrLšk
 * 
ù¾_hªdË
) :

32 
BasicTuÂ–
(
move
(
desütÜ
), 
ù¾_hªdË
)

35 
	gsh¬ed_±r
<
	gVœtu®Lšk
>

36 
	gSšgËLškTuÂ–
::
C»©eVlšk
(

37 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

38 
unique_±r
<
P“rDesütÜ
> 
³”_desc
)

40 if(
	gvlšk_
)

42 
	gvlšk_
->
P“rCªdid©es
(
³”_desc
->
ÿs
);

43 
	gvlšk_
->
S¹CÚÃùiÚs
();

44 
LOG
(
LS_INFO
) << "Added„emote CASo vlink w/…eer "

45 << 
	gvlšk_
->
P“rInfo
().
	guid
;

49 
	güick‘
::
IûRŞe
 
œ
 = 
üick‘
::
ICEROLE_CONTROLLED
;

50 if(
	gdesütÜ_
->
	gnode_id
 < 
	g³”_desc
->
	guid
)

51 
	gœ
 = 
üick‘
::
ICEROLE_CONTROLLING
;

52 
¡ršg
 
	grŞes
[] = { "CONTROLLING", "CONTROLLED" };

53 
LOG
(
LS_INFO
è<< "C»©šg " << 
	grŞes
[
œ
] << " vlšk w/…“¸" << 
	g³”_desc
->
	guid
;

54 
	gvlšk_
 = 
BasicTuÂ–
::
C»©eVlšk
(
move
(
vlšk_desc
), move(
³”_desc
), 
œ
);

56  
	gvlšk_
;

59 
	gSšgËLškTuÂ–
::
Qu”yInfo
(

60 
JsÚ
::
V®ue
 & 
Šl_šfo
)

62 
Šl_šfo
[
TšÿnCÚŒŞ
::
TuÂ–Id
] = 
desütÜ_
->
uid
;

63 
	gŠl_šfo
[
TšÿnCÚŒŞ
::
FPR
] = 
Fšg”´št
();

64 
	gŠl_šfo
[
TšÿnCÚŒŞ
::
T­Name
] = 
p_desc_
->
Çme
;

65 
	gŠl_šfo
[
TšÿnCÚŒŞ
::
MAC
] = 
MacAdd»ss
();

66 
	gŠl_šfo
["LškIds"] = 
JsÚ
::
V®ue
(JsÚ::
¬¿yV®ue
);

67 if(
	gvlšk_
)

69 
	gŠl_šfo
["LškIds"].
­³nd
(
vlšk_
->
Id
());

73 
	gSšgËLškTuÂ–
::
Qu”yLškCas
(

74 cÚ¡ 
¡ršg
 & 
vlšk_id
,

75 
JsÚ
::
V®ue
 & 
ÿs_šfo
)

77 if(
vlšk_
)

79 if(
vlšk_
->
IûRŞe
(è=ğ
üick‘
::
ICEROLE_CONTROLLING
)

80 
ÿs_šfo
[
TšÿnCÚŒŞ
::
IûRŞe
] = TšÿnCÚŒŞ::
CÚŒŞlšg
.
c_¡r
();

81 if(
	gvlšk_
->
IûRŞe
(è=ğ
üick‘
::
ICEROLE_CONTROLLED
)

82 
ÿs_šfo
[
TšÿnCÚŒŞ
::
IûRŞe
] = TšÿnCÚŒŞ::
CÚŒŞËd
.
c_¡r
();

84 
	gÿs_šfo
[
TšÿnCÚŒŞ
::
CAS
] = 
vlšk_
->
Cªdid©es
();

88 
	gSšgËLškTuÂ–
::
Qu”yLškIds
(
veùÜ
<
¡ršg
>& 
lšk_ids
)

90 if(
vlšk_
)

91 
lšk_ids
.
push_back
(
vlšk_
->
Id
());

94 
	gSšgËLškTuÂ–
::
Qu”yLškInfo
(

95 cÚ¡ 
¡ršg
 & 
vlšk_id
,

96 
JsÚ
::
V®ue
 & 
vlšk_šfo
)

98 if(
vlšk_
)

100 if(
vlšk_
->
IûRŞe
(è=ğ
üick‘
::
ICEROLE_CONTROLLING
)

101 
vlšk_šfo
[
TšÿnCÚŒŞ
::
IûRŞe
] = TšÿnCÚŒŞ::
CÚŒŞlšg
;

103 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
IûRŞe
] = TšÿnCÚŒŞ::
CÚŒŞËd
;

104 if(
	gvlšk_
->
IsR—dy
())

106 
LškInfoMsgD©a
 
	gmd
;

107 
	gmd
.
	gvl
 = 
vlšk_
;

108 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_QUERY_NODE_INFO
, &
md
);

109 
	gmd
.
	gmsg_ev’t
.
Wa™
(
Ev’t
::
kFÜev”
);

110 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Sts
].
sw­
(
md
.
šfo
);

111 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Stus
] = "ONLINE";

115 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Stus
] = "OFFLINE";

116 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Sts
] = 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
);

121 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Stus
] = "UNKNOWN";

122 
	gvlšk_šfo
[
TšÿnCÚŒŞ
::
Sts
] = 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
);

127 
	gSšgËLškTuÂ–
::
S’dIcc
(

128 cÚ¡ 
¡ršg
 & 
vlšk_id
,

129 cÚ¡ 
¡ršg
 & 
d©a
)

131 if(!
	gvlšk_
 || vlšk_->
Id
(è!ğ
vlšk_id
)

132 
throw
 
TCEXCEPT
("No vlinkƒxists byhe specified id");

133 
	gunique_±r
<
	gIccMes§ge
> 
	gicc
 = 
make_unique
<
IccMes§ge
>();

134 
	gicc
->
Mes§ge
((
ušt8_t
*)
d©a
.
c_¡r
(), (
ušt16_t
)d©a.
Ëngth
());

135 
	gunique_±r
<
	gT¿nsm™MsgD©a
> 
	gmd
 = 
make_unique
<
T¿nsm™MsgD©a
>();

136 
	gmd
->
	gäm
 = 
move
(
icc
);

137 
	gmd
->
	gvl
 = 
vlšk_
;

138 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_SEND_ICC
, 
md
.
»Ëa£
());

142 
	gSšgËLškTuÂ–
::
Shutdown
()

144 if(
vlšk_
 && vlšk_->
IsR—dy
())

146 
LškInfoMsgD©a
 
md
;

147 
	gmd
.
	gvl
 = 
vlšk_
;

148 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_DISC_LINK
, &
md
);

149 
	gmd
.
	gmsg_ev’t
.
Wa™
(
Ev’t
::
kFÜev”
);

151 
	gvlšk_
.
»£t
();

152 
	gBasicTuÂ–
::
Shutdown
();

156 
	gSšgËLškTuÂ–
::
S¹Io
()

158 
tdev_
->
Up
();

159 
	gBasicTuÂ–
::
S¹Io
();

163 
	gSšgËLškTuÂ–
::
StİIo
()

165 
tdev_
->
Down
();

168 
	gSšgËLškTuÂ–
::
RemoveLšk
(

169 cÚ¡ 
¡ršg
 & 
vlšk_id
)

171 if(!
vlšk_
)

173 if(
	gvlšk_
->
Id
(è!ğ
vlšk_id
)

174 
throw
 
TCEXCEPT
("The specified VLink ID does‚ot matchhis Tunnel");

175 if(
	gvlšk_
->
IsR—dy
())

177 
LškInfoMsgD©a
 
	gmd
;

178 
	gmd
.
	gvl
 = 
vlšk_
;

179 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_DISC_LINK
, &
md
);

180 
	gmd
.
	gmsg_ev’t
.
Wa™
(
Ev’t
::
kFÜev”
);

182 
	gvlšk_
.
»£t
();

186 
	gSšgËLškTuÂ–
::
Upd©eRou‹TabË
(

187 cÚ¡ 
JsÚ
::
V®ue
 & 
¹_desü
)

193 
SšgËLškTuÂ–
::
VlškR—dCom¶‘e
(

194 
ušt8_t
 * 
d©a
,

195 
ušt32_t
 
d©a_Ën
,

196 
Vœtu®Lšk
 & 
vlšk
)

198 
	gunique_±r
<
	gT­F¿me
> 
	gäame
 = 
make_unique
<
T­F¿me
>(
d©a
, 
	gd©a_Ën
);

199 
T­F¿mePrİ”t›s
 
å
(*
äame
);

200 if(
	gå
.
IsDtfMsg
())

203 
	gäame
->
BufãrToT¿nsãr
(
äame
->
Paylßd
());

204 
	gäame
->
By‹sToT¿nsãr
(
äame
->
PaylßdL’gth
());

205 
	gäame
->
S‘Wr™eOp
();

206 
	gtdev_
->
Wr™e
(*
äame
.
»Ëa£
());

208 if(
	gå
.
IsIccMsg
())

210 
	gunique_±r
<
	gTšÿnCÚŒŞ
> 
	gù¾
 = 
make_unique
<
TšÿnCÚŒŞ
>();

211 
	gù¾
->
S‘CÚŒŞTy³
(
TšÿnCÚŒŞ
::
CTTšÿnReque¡
);

212 
	gJsÚ
::
V®ue
 & 
»q
 = 
ù¾
->
G‘Reque¡
();

213 
	g»q
[
TšÿnCÚŒŞ
::
Commªd
] = TšÿnCÚŒŞ::
ICC
;

214 
	g»q
[
TšÿnCÚŒŞ
::
TuÂ–Id
] = 
desütÜ_
->
uid
;

215 
	g»q
[
TšÿnCÚŒŞ
::
LškId
] = 
vlšk
.
Id
();

216 
	g»q
[
TšÿnCÚŒŞ
::
D©a
] = 
¡ršg
((*)
äame
->
Paylßd
(),

217 
äame
->
PaylßdL’gth
());

220 
	gù¾_lšk_
->
D–iv”
(
move
(
ù¾
));

224 
LOG
(
LS_ERROR
) << "Unknown frameype„eceived!";

225 
	gäame
->
Dump
("Invalid header");

229 
	gSšgËLškTuÂ–
::
T­R—dCom¶‘e
(

230 
AsyncIo
 * 
aio_rd
)

232 
T­F¿me
 * 
äame
 = 
¡©ic_ÿ¡
<T­F¿me*>(
aio_rd
->
cÚ‹xt_
);

233 ià(!
	gaio_rd
->
	ggood_
 || (aio_rd->
By‹sT¿nsã¼ed
() < 0))

236 
d–‘e
 
	gäame
;

237 
LOG
(
LS_INFO
) << "TAP„ead failure, cancelling IO";

239 if(!
	gvlšk_
)

242 
	gäame
->
In™Ÿlize
();

243 
	gäame
->
BufãrToT¿nsãr
(
äame
->
Paylßd
());

244 
	gäame
->
By‹sToT¿nsãr
(
äame
->
PaylßdC­ac™y
());

245 if(0 !ğ
tdev_
->
R—d
(*
äame
))

248 
d–‘e
 
äame
;

249 
LOG
(
LS_INFO
) << "TAP„ead…ost failed,‚o more‡ttempts will be made";

254 
	gäame
->
PaylßdL’gth
(
äame
->
By‹sT¿nsã¼ed
());

255 
	gäame
->
BufãrToT¿nsãr
(
äame
->
Begš
());

256 
	gäame
->
By‹sToT¿nsãr
(
äame
->
L’gth
());

257 
	gäame
->
H—d”
(

.
kDtfMagic
);

258 
T¿nsm™MsgD©a
 *
	gmd
 = 
Ãw
 TransmitMsgData;

259 
	gmd
->
	gäm
.
»£t
(
äame
);

260 
	gmd
->
	gvl
 = 
vlšk_
;

261 
	gÃt_wÜk”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_TRANSMIT
, 
md
);

265 
	gSšgËLškTuÂ–
::
T­Wr™eCom¶‘e
(

266 
AsyncIo
 * 
aio_wr
)

269 
d–‘e
 
¡©ic_ÿ¡
<
T­F¿me
*>(
aio_wr
->
cÚ‹xt_
);

	@src/tap_frame.cc

23 
	~"p_äame.h
"

24 
	~"tšÿn_exû±iÚ.h
"

25 
Çme¥aû
 
	gtšÿn


27 
	gT­F¿me
::
T­F¿me
() :

28 
AsyncIo
(),

29 
tfb_
(
nuÎ±r
),

30 
¶_Ën_
(0)

32 
	gAsyncIo
::
In™Ÿlize
(
nuÎ±r
, 0, 
this
, 
AIO_READ
, 0);

35 
	gT­F¿me
::
T­F¿me
(cÚ¡ T­F¿m& 
rhs
) :

36 
AsyncIo
(),

37 
tfb_
(
nuÎ±r
),

38 
¶_Ën_
(
rhs
.pl_len_)

40 if(
	grhs
.
	gtfb_
)

42 
	gtfb_
 = 
Ãw
 
T­F¿meBufãr
;

43 
memıy
(
tfb_
->
d©a
(), 
rhs
.tfb_->d©a(),„hs.tfb_->
size
());

44 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 
rhs
.
by‹s_to_Œªsãr_
, 
this
,

45 
rhs
.
æags_
,„hs.
by‹s_Œªsã¼ed_
);

49 
	gT­F¿me
::
T­F¿me
(T­F¿m&& 
rhs
) :

50 
AsyncIo
(),

51 
tfb_
(
rhs
.tfb_),

52 
¶_Ën_
(
rhs
.pl_len_)

54 
	grhs
.
	gtfb_
 = 
nuÎ±r
;

55 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 
rhs
.
by‹s_to_Œªsãr_
, 
this
,

56 
rhs
.
æags_
,„hs.
by‹s_Œªsã¼ed_
);

63 
	gT­F¿me
::
T­F¿me
(

64 
ušt8_t
 * 
š_buf
,

65 
ušt32_t
 
buf_Ën
) :

66 
¶_Ën_
(
buf_Ën
 - 

.
kT­H—d”Size
)

68 if(
buf_Ën
 > 

.
kT­BufãrSize
)

69 
throw
 
TCEXCEPT
("Input data is†argerhanhe maximum‡llowed");

70 
	gtfb_
 = 
Ãw
 
T­F¿meBufãr
;

71 
memıy
(
tfb_
->
d©a
(), 
š_buf
, 
buf_Ën
);

72 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 
buf_Ën
, 
this
, 
AIO_WRITE
, buf_len);

75 
	gT­F¿me
::~
T­F¿me
()

77 
d–‘e
 
tfb_
;

80 
	gT­F¿me
 &

81 
	gT­F¿me
::
İ”©Ü
ğ(
T­F¿me
 & 
rhs
)

83 if(!
tfb_
)

84 
tfb_
 = 
Ãw
 
T­F¿meBufãr
;

85 
memıy
(
tfb_
->
d©a
(),
rhs
.tfb_->d©a(),„hs.tfb_->
size
());

87 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 
rhs
.
by‹s_to_Œªsãr_
, 
this
,

88 
rhs
.
æags_
,„hs.
by‹s_Œªsã¼ed_
);

89 
	g¶_Ën_
 = 
rhs
.
¶_Ën_
;

90  *
	gthis
;

93 
	gT­F¿me
 &

94 
	gT­F¿me
::
İ”©Ü
ğ(
T­F¿me
 && 
rhs
)

96 if(
this
->
tfb_
è
d–‘e
his->tfb_;

97 
	gthis
->
	gtfb_
 = 
rhs
.
tfb_
;

99 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 
rhs
.
by‹s_to_Œªsãr_
, 
this
,

100 
rhs
.
æags_
,„hs.
by‹s_Œªsã¼ed_
);

101 
	g¶_Ën_
 = 
rhs
.
¶_Ën_
;

103 
	grhs
.
	gtfb_
 = 
nuÎ±r
;

104 
	grhs
.
	gbufãr_to_Œªsãr_
 = 
nuÎ±r
;

105 
	grhs
.
	gcÚ‹xt_
 = 
nuÎ±r
;

106 
	grhs
.
	gby‹s_Œªsã¼ed_
 = 0;

107 
	grhs
.
	gby‹s_to_Œªsãr_
 = 0;

108 
	grhs
.
	gæags_
 = 
AIO_WRITE
;

109 
	grhs
.
	g¶_Ën_
 = 0;

110  *
	gthis
;

113 
boŞ


114 
	gT­F¿me
::
İ”©Ü
==(

115 cÚ¡ 
T­F¿me
 & 
rhs
) const

117  (
tfb_
 =ğ
rhs
.tfb_);

120 
boŞ


121 
	gT­F¿me
::
İ”©Ü
!=(

122 cÚ¡ 
T­F¿me
 & 
rhs
) const

124  !(*
this
 =ğ
rhs
);

127 
boŞ


128 
	gT­F¿me
::
İ”©Ü
 !() const

130  
tfb_
 =ğ
nuÎ±r
;

133 
	gušt8_t
 &

134 
	gT­F¿me
::
İ”©Ü
 [](

135 
ušt32_t
 
šdex
)

137 if(!
tfb_
 || 
šdex
 >ğtfb_->
size
())

138 
throw
 
TCEXCEPT
("TapFrameBuffer index out of bounds");

139  (*
	gtfb_
)[
šdex
];

142 cÚ¡ 
	gušt8_t
 &

143 
	gT­F¿me
::
İ”©Ü
 [](

144 cÚ¡ 
ušt32_t
 
šdex
) const

146 if(!
tfb_
 || 
šdex
 >ğtfb_->
size
())

147 
throw
 
TCEXCEPT
("TapFrameBuffer index out of bounds");

148  (*
	gtfb_
)[
šdex
];

151 
	gT­F¿me
 & T­F¿me::
In™Ÿlize
()

153 
¶_Ën_
 = 0;

154 if(!
	gtfb_
)

156 
	gtfb_
 = 
Ãw
 
T­F¿meBufãr
;

158 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 

.
kT­BufãrSize
, 
this
, 
AIO_READ
, 0);

159  *
	gthis
;

162 
	gT­F¿me
 & T­F¿me::
In™Ÿlize
(

163 
ušt8_t
* 
bufãr_to_Œªsãr
,

164 
ušt32_t
 
by‹s_to_Œªsãr
,

165 
AIO_OP
 
æags
,

166 
ušt32_t
 
by‹s_Œªsã¼ed
)

168 
	g¶_Ën_
 = 0;

169 
	gAsyncIo
::
In™Ÿlize
(
bufãr_to_Œªsãr
, 
by‹s_to_Œªsãr
, 
this
, 
æags
,

170 
by‹s_Œªsã¼ed
);

171  *
	gthis
;

174 
	gT­F¿me
::
H—d”
(
ušt16_t
 
v®
)

176 *((
ušt16_t
*)
tfb_
->
d©a
()èğ
v®
;

179 
ušt8_t
 * 
	gT­F¿me
::
Begš
()

181 if(!
tfb_
)

182  
nuÎ±r
;

183  
	gtfb_
->
d©a
();

186 
ušt8_t
 * 
	gT­F¿me
::
End
()

188 if(!
tfb_
)

189  
nuÎ±r
;

190  
	gtfb_
->
d©a
(è+fb_->
size
();

194 
ušt32_t
 
	gT­F¿me
::
L’gth
()

196  

.
kT­H—d”Size
 + 
PaylßdL’gth
();

199 
ušt32_t
 
	gT­F¿me
::
PaylßdL’gth
()

201 if(!
tfb_
 || 
AsyncIo
::
By‹sT¿nsã¼ed
(è<ğ

.
kT­H—d”Size
)

203  
	g¶_Ën_
;

206 
	gT­F¿me
::
PaylßdL’gth
(
ušt32_t
 
Ëngth
)

208 
¶_Ën_
 = 
Ëngth
;

211 
ušt32_t
 
	gT­F¿me
::
PaylßdC­ac™y
()

213 if(!
tfb_
)

215  
	g
.
	gkEth”ÃtSize
;

218 
ušt8_t
 * 
	gT­F¿me
::
Paylßd
()

220 if(!
tfb_
)

221  
nuÎ±r
;

222  &
	gtfb_
->
d©a
()[

.
kT­H—d”Size
];

225 
ušt8_t
 * 
	gT­F¿me
::
PaylßdEnd
()

227  
Paylßd
(è+ 
PaylßdL’gth
();

230 
ušt32_t
 
	gT­F¿me
::
C­ac™y
() const

232 if(!
tfb_
)

234  (
	gušt32_t
)
	gtfb_
->
size
();

237 
	gT­F¿me
::
Dump
(cÚ¡ 
¡ršg
 & 
Ïb–
)

239 if(
LOG_CHECK_LEVEL
(
LS_VERBOSE
))

241 
o¡ršg¡»am
 
oss
;

242 
LOG
(
LS_VERBOSE
è<< 
	gÏb–
 << " header=" <<

243 
By‹A¼ayToSŒšg
(
Begš
(), 
Paylßd
(), 0, 
çl£
è<< 
	g’dl
 <<

244 
By‹A¼ayToSŒšg
(
Paylßd
(), 
PaylßdEnd
(), 16, 
Œue
);

248 
	gIccMes§ge
::
Mes§ge
(

249 
ušt8_t
 * 
š_buf
,

250 
ušt32_t
 
buf_Ën
)

252 if(
	gbuf_Ën
 > 
	g
.
	gkEth”ÃtSize
)

253 
throw
 
TCEXCEPT
("Input data is†argerhanhe maximum‡llowed");

255 if(!
	gtfb_
)

256 
	gtfb_
 = 
Ãw
 
T­F¿meBufãr
;

257 
	g¶_Ën_
 = 
buf_Ën
;

258 
ušt32_t
 
	gnb
 = 
¶_Ën_
 + 

.
kT­H—d”Size
;

259 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 
nb
, 
this
, 
AIO_WRITE
,‚b);

260 
ušt16_t
 
	gmagic
 = 

.
kIccMagic
;

261 
memmove
(
Begš
(), &
magic
, 

.
kT­H—d”Size
);

262 
memmove
(
Paylßd
(), 
š_buf
, 
buf_Ën
);

265 
	gDtfMes§ge
::
Mes§ge
(

266 
ušt8_t
 * 
š_buf
,

267 
ušt32_t
 
buf_Ën
)

269 if(
	gbuf_Ën
 > 
	g
.
	gkEth”ÃtSize
)

270 
throw
 
TCEXCEPT
("Input data is†argerhanhe maximum‡llowed");

272 if(!
	gtfb_
)

273 
	gtfb_
 = 
Ãw
 
T­F¿meBufãr
;

274 
	g¶_Ën_
 = 
buf_Ën
;

275 
ušt32_t
 
	gnb
 = 
¶_Ën_
 + 

.
kT­H—d”Size
;

276 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 
nb
, 
this
, 
AIO_WRITE
,‚b);

277 
ušt16_t
 
	gmagic
 = 

.
kDtfMagic
;

278 
memmove
(
Begš
(), &
magic
, 

.
kT­H—d”Size
);

279 
memmove
(
Paylßd
(), 
š_buf
, 
buf_Ën
);

283 
	gFwdMes§ge
::
Mes§ge
(

284 
ušt8_t
 * 
š_buf
,

285 
ušt32_t
 
buf_Ën
)

287 if(
	gbuf_Ën
 > 
	g
.
	gkEth”ÃtSize
)

288 
throw
 
TCEXCEPT
("Input data is†argerhanhe maximum‡llowed");

289 if(!
	gtfb_
)

290 
	gtfb_
 = 
Ãw
 
T­F¿meBufãr
;

291 
	g¶_Ën_
 = 
buf_Ën
;

292 
ušt32_t
 
	gnb
 = 
¶_Ën_
 + 

.
kT­H—d”Size
;

293 
	gAsyncIo
::
In™Ÿlize
(
tfb_
->
d©a
(), 
nb
, 
this
, 
AIO_WRITE
,‚b);

294 
ušt16_t
 
	gmagic
 = 

.
kFwdMagic
;

295 
memmove
(
Begš
(), &
magic
, 

.
kT­H—d”Size
);

296 
memmove
(
Paylßd
(), 
š_buf
, 
buf_Ën
);

	@src/tincan.cc

24 
	~"tšÿn.h
"

25 
	~"tšÿn_exû±iÚ.h
"

26 
	~"tuº_desütÜ.h
"

27 
Çme¥aû
 
	gtšÿn


29 
	gTšÿn
::
Tšÿn
() :

30 
ex™_ev’t_
(
çl£
, false)

33 
	gTšÿn
::~
Tšÿn
()

38 
Tšÿn
::
S‘IpİCÚŒŞËrLšk
(

40 
IpİCÚŒŞËrLšk
 * 
ù¾_hªdË
)

42 
ù¾_lšk_
 = 
ù¾_hªdË
;

45 
	gTšÿn
::
C»©eTuÂ–
(

46 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
,

47 
JsÚ
::
V®ue
 & 
Šl_šfo
)

49 
unique_±r
<
TuÂ–DesütÜ
> 
td
(
Ãw
 TunnelDescriptor);

50 
	gtd
->
	guid
 = 
Šl_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
();

51 
	gtd
->
	gnode_id
 = 
Šl_desc
[
TšÿnCÚŒŞ
::
NodeId
].
asSŒšg
();

52 if(
IsTuÂ–Exis™
(
td
->
uid
))

53 
throw
 
TCEXCEPT
("The specified Tunnel identifier‡lreadyƒxists");

55 
	gJsÚ
::
V®ue
 
¡un_£rv”s
 = 
Šl_desc
["StunServers"];

56 
	gJsÚ
::
V®ue
::
A¼ayIndex
 
i
 = 0; 
	gi
 < 
	g¡un_£rv”s
.
size
(); ++i)

58 
	gtd
->
	g¡un_£rv”s
.
push_back
(
¡un_£rv”s
[
i
].
asSŒšg
());

61 
	gJsÚ
::
V®ue
 
tuº_£rv”s
 = 
Šl_desc
["TurnServers"];

62 
	gJsÚ
::
V®ue
::
A¼ayIndex
 
i
 = 0; 
	gi
 < 
	gtuº_£rv”s
.
size
(); ++i)

64 
TuºDesütÜ
 
tuº_desc
(

65 
tuº_£rv”s
[
i
]["Add»ss"].
asSŒšg
(),

66 
tuº_£rv”s
[
i
]["U£r"].
asSŒšg
(),

67 
tuº_£rv”s
[
i
]["PasswÜd"].
asSŒšg
());

68 
	gtd
->
	gtuº_descs
.
push_back
(
tuº_desc
);

70 
	gtd
->
	g’abË__m­pšg
 = 
çl£
;

71 
	gunique_±r
<
	gBasicTuÂ–
> 
	gŠl
;

72 if(
	gŠl_desc
[
TšÿnCÚŒŞ
::
Ty³
].
asSŒšg
() == "VNET")

74 
Šl
 = 
make_unique
<
MuÉiLškTuÂ–
>(
move
(
td
), 
	gù¾_lšk_
);

76 if(
	gŠl_desc
[
TšÿnCÚŒŞ
::
Ty³
].
asSŒšg
() == "TUNNEL")

78 
Šl
 = 
make_unique
<
SšgËLškTuÂ–
>(
move
(
td
), 
	gù¾_lšk_
);

81 
throw
 
TCEXCEPT
("Invalid Tunnelype specified");

82 
	gunique_±r
<
	gT­DesütÜ
> 
	gp_desc
 = 
make_unique
<
T­DesütÜ
>();

83 
	gp_desc
->
	gÇme
 = 
Šl_desc
["T­Name"].
asSŒšg
();

84 
	gp_desc
->
	g4
 = 
Šl_desc
["IP4"].
asSŒšg
();

85 
	gp_desc
->
	g´efix4
 = 
Šl_desc
["IP4P»fixL’"].
asUIÁ
();

86 
	gp_desc
->
	gmtu4
 = 
Šl_desc
[
TšÿnCÚŒŞ
::
MTU4
].
asUIÁ
();

88 
	gJsÚ
::
V®ue
 
ÃtwÜk_ignÜe_li¡
 =

89 
Šl_desc
[
TšÿnCÚŒŞ
::
IgnÜedN‘IÁ”çûs
];

90 
	gcouÁ
 = 
ÃtwÜk_ignÜe_li¡
.
size
();

91 
	gveùÜ
<
	g¡ršg
> 
if_li¡
(
couÁ
);

92 
	gi
 = 0; i < 
	gcouÁ
; i++)

94 
	gif_li¡
[
i
] = 
ÃtwÜk_ignÜe_li¡
[i].
asSŒšg
();

96 
	gŠl
->
CÚfigu»
(
move
(
p_desc
), 
if_li¡
);

97 
	gŠl
->
S¹
();

98 
	gŠl
->
Qu”yInfo
(
Šl_šfo
);

99 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
tuÂ–s_mu‹x_
);

100 
	gtuÂ–s_
.
push_back
(
move
(
Šl
));

106 
	gTšÿn
::
C»©eVlšk
(

107 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
,

108 cÚ¡ 
TšÿnCÚŒŞ
 & 
cÚŒŞ
)

110 
	gunique_±r
<
	gVlškDesütÜ
> 
	gvl_desc
 = 
make_unique
<
VlškDesütÜ
>();

111 
	gvl_desc
->
	guid
 = 
lšk_desc
[
TšÿnCÚŒŞ
::
LškId
].
asSŒšg
();

112 
	gunique_±r
<
	gJsÚ
::
V®ue
> 
»¥
 = 
make_unique
<
JsÚ
::V®ue>(JsÚ::
objeùV®ue
);

113 
	gJsÚ
::
V®ue
 & 
Šl_šfo
 = (*
»¥
)[
TšÿnCÚŒŞ
::
Mes§ge
];

114 
¡ršg
 
	gŠl_id
 = 
lšk_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
();

115 if(!
IsTuÂ–Exis™
(
Šl_id
))

117 
C»©eTuÂ–
(
lšk_desc
, 
Šl_šfo
);

121 
TuÂ–FromId
(
Šl_id
).
Qu”yInfo
(
Šl_šfo
);

123 
	gunique_±r
<
	gP“rDesütÜ
> 
	g³”_desc
 = 
make_unique
<
P“rDesütÜ
>();

124 
	g³”_desc
->
	guid
 =

125 
lšk_desc
[
TšÿnCÚŒŞ
::
P“rInfo
][TšÿnCÚŒŞ::
UID
].
asSŒšg
();

126 
	g³”_desc
->
	gv4
 =

127 
lšk_desc
[
TšÿnCÚŒŞ
::
P“rInfo
][TšÿnCÚŒŞ::
VIP4
].
asSŒšg
();

128 
	g³”_desc
->
	gÿs
 =

129 
lšk_desc
[
TšÿnCÚŒŞ
::
P“rInfo
][TšÿnCÚŒŞ::
CAS
].
asSŒšg
();

130 
	g³”_desc
->
	gfšg”´št
 =

131 
lšk_desc
[
TšÿnCÚŒŞ
::
P“rInfo
][TšÿnCÚŒŞ::
FPR
].
asSŒšg
();

132 
	g³”_desc
->
	gmac_add»ss
 =

133 
lšk_desc
[
TšÿnCÚŒŞ
::
P“rInfo
][TšÿnCÚŒŞ::
MAC
].
asSŒšg
();

135 
	gvl_desc
->
	gds_’abËd
 = 
Œue
;

137 
	gBasicTuÂ–
 & 
	gŠl
 = 
TuÂ–FromId
(
Šl_id
);

138 
	gsh¬ed_±r
<
	gVœtu®Lšk
> 
	gvlšk
 =

139 
Šl
.
C»©eVlšk
(
move
(
vl_desc
), move(
³”_desc
));

140 
	gunique_±r
<
	gTšÿnCÚŒŞ
> 
	gù¾
 = 
make_unique
<
TšÿnCÚŒŞ
>(
cÚŒŞ
);

141 if(!
	gvlšk
->
IsG©h”šgCom¶‘e
())

143 
	gù¾
->
S‘Re¥Ú£
(
move
(
»¥
));

144 
	g¡d
::
lock_gu¬d
<
¡d
::
mu‹x
> 
lg
(
š´ogess_cÚŒŞs_mu‹x_
);

145 
	gš´ogess_cÚŒŞs_
[
lšk_desc
[
TšÿnCÚŒŞ
::
LškId
].
asSŒšg
()]

146 ğ
move
(
ù¾
);

148 
	gvlšk
->
	gSigÇlLoÿlCasR—dy
.
cÚÃù
(
this
, &
Tšÿn
::
OnLoÿlCasUpd©ed
);

152 (*
	g»¥
)["Mes§ge"]["CAS"] = 
vlšk
->
Cªdid©es
();

153 (*
	g»¥
)["Sucûss"] = 
Œue
;

154 
	gù¾
->
S‘Re¥Ú£
(
move
(
»¥
));

155 
	gù¾_lšk_
->
D–iv”
(
move
(
ù¾
));

160 
	gTšÿn
::
InjeùF¿me
(

161 cÚ¡ 
JsÚ
::
V®ue
 & 
äame_desc
)

163 cÚ¡ 
¡ršg
 & 
Šl_id
 = 
äame_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
();

164 
	gBasicTuÂ–
 & 
	gŞ
 = 
TuÂ–FromId
(
Šl_id
);

165 
	gŞ
.
InjeùFame
(
äame_desc
[
TšÿnCÚŒŞ
::
D©a
].
asSŒšg
());

169 
	gTšÿn
::
Qu”yLškCas
(

170 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
,

171 
JsÚ
::
V®ue
 & 
ÿs_šfo
)

173 cÚ¡ 
¡ršg
 
Šl_id
 = 
lšk_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
();

174 cÚ¡ 
¡ršg
 
	gvlid
 = 
lšk_desc
[
TšÿnCÚŒŞ
::
LškId
].
asSŒšg
();

175 
	gBasicTuÂ–
 & 
	gŞ
 = 
TuÂ–FromId
(
Šl_id
);

176 
	gŞ
.
Qu”yLškCas
(
vlid
, 
ÿs_šfo
);

180 
	gTšÿn
::
Qu”yLškSts
(

181 cÚ¡ 
JsÚ
::
V®ue
 & 
tuÂ–_ids
,

182 
JsÚ
::
V®ue
 & 
¡©_šfo
)

184 
ušt32_t
 
i
 = 0; 
	gi
 < 
	gtuÂ–_ids
["TuÂ–Ids"].
size
(); i++)

186 
	gveùÜ
<
	g¡ršg
>
	glšk_ids
;

187 
¡ršg
 
	gŠl_id
 = 
tuÂ–_ids
["TuÂ–Ids"][
i
].
asSŒšg
();

188 
	gBasicTuÂ–
 & 
	gŞ
 = 
TuÂ–FromId
(
Šl_id
);

189 
	gŞ
.
Qu”yLškIds
(
lšk_ids
);

190 autØ
	gvlid
 : 
lšk_ids
)

192 
Ş
.
Qu”yLškInfo
(
vlid
, 
¡©_šfo
[
Šl_id
][vlid]);

199 
	gTšÿn
::
Qu”yTuÂ–Info
(

200 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
,

201 
JsÚ
::
V®ue
 & 
Šl_šfo
)

203 
BasicTuÂ–
 & 
Ş
 = 
TuÂ–FromId
(
Šl_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
());

204 
	gŞ
.
Qu”yInfo
(
Šl_šfo
);

208 
	gTšÿn
::
RemoveTuÂ–
(

209 cÚ¡ 
JsÚ
::
V®ue
 & 
Šl_desc
)

211 cÚ¡ 
¡ršg
 
Šl_id
 = 
Šl_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
();

212 if(
	gŠl_id
.
em±y
())

213 
throw
 
TCEXCEPT
("No Tunnel ID was specified");

215 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
tuÂ–s_mu‹x_
);

216 autØ
	gŠl
 = 
tuÂ–s_
.
begš
();Æ !ğtuÂ–s_.
’d
();nl++)

218 if((*
	gŠl
)->
DesütÜ
().
	guid
.
com·»
(
Šl_id
) == 0)

220 (*
Šl
)->
Shutdown
();

221 
	gtuÂ–s_
.
”a£
(
Šl
);

222 
LOG
(
LS_INFO
è<< "RemoveTuÂ–: In¡ªûƒ¿£d from cŞËùiÚ " << 
	gŠl_id
;

226 
LOG
(
LS_WARNING
è<< "RemoveTuÂ–: NØsuch vœtu®‚‘wÜkƒxi¡ " << 
	gŠl_id
;

230 
	gTšÿn
::
RemoveVlšk
(

231 cÚ¡ 
JsÚ
::
V®ue
 & 
lšk_desc
)

233 cÚ¡ 
¡ršg
 
Šl_id
 = 
lšk_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
();

234 cÚ¡ 
¡ršg
 
	gvlid
 = 
lšk_desc
[
TšÿnCÚŒŞ
::
LškId
].
asSŒšg
();

235 if(
	gŠl_id
.
em±y
(è|| 
	gvlid
.empty())

236 
throw
 
TCEXCEPT
("Required identifier‚ot specified");

238 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
tuÂ–s_mu‹x_
);

239 autØ& 
	gŠl
 : 
tuÂ–s_
)

241 if(
Šl
->
DesütÜ
().
uid
.
com·»
(
Šl_id
) == 0)

243 
Šl
->
RemoveLšk
(
vlid
);

249 
	gTšÿn
::
S’dIcc
(

250 cÚ¡ 
JsÚ
::
V®ue
 & 
icc_desc
)

252 cÚ¡ 
¡ršg
 
Šl_id
 = 
icc_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
();

253 cÚ¡ 
	g¡ršg
 & 
	glšk_id
 = 
icc_desc
[
TšÿnCÚŒŞ
::
LškId
].
asSŒšg
();

254 if(
	gicc_desc
[
TšÿnCÚŒŞ
::
D©a
].
isSŒšg
())

256 cÚ¡ 
¡ršg
 & 
d©a
 = 
icc_desc
[
TšÿnCÚŒŞ
::
D©a
].
asSŒšg
();

257 
	gBasicTuÂ–
 & 
	gŞ
 = 
TuÂ–FromId
(
Šl_id
);

258 
	gŞ
.
S’dIcc
(
lšk_id
, 
d©a
);

261 
throw
 
TCEXCEPT
("Icc data is‚ot„epresented‡s‡ string");

265 
	gTšÿn
::
OnLoÿlCasUpd©ed
(

266 
¡ršg
 
lšk_id
,

267 
¡ršg
 
lÿs
)

269 if(
	glÿs
.
em±y
())

271 
	glÿs
 = "No†ocal candidates‡vailable onhis vlink";

272 
LOG
(
LS_WARNING
è<< 
	glÿs
;

274 
boŞ
 
	gto_d–iv”
 = 
çl£
;

275 
	gunique_±r
<
	gTšÿnCÚŒŞ
> 
	gù¾
;

277 
	g¡d
::
lock_gu¬d
<
¡d
::
mu‹x
> 
lg
(
š´ogess_cÚŒŞs_mu‹x_
);

278 autØ
	g™r
 = 
š´ogess_cÚŒŞs_
.
begš
();

279 ; 
	g™r
 !ğ
š´ogess_cÚŒŞs_
.
’d
(); itr++)

281 if(
	g™r
->
	gfœ¡
 =ğ
lšk_id
)

283 
to_d–iv”
 = 
Œue
;

284 
	gù¾
 = 
move
(
™r
->
£cÚd
);

285 
	gJsÚ
::
V®ue
 & 
»¥
 = 
ù¾
->
G‘Re¥Ú£
();

286 
	g»¥
["Mes§ge"]["CAS"] = 
lÿs
;

287 
	g»¥
["Sucûss"] = 
Œue
;

288 
	gš´ogess_cÚŒŞs_
.
”a£
(
™r
);

293 if(
	gto_d–iv”
)

295 
	gù¾_lšk_
->
D–iv”
(
move
(
ù¾
));

299 
	gTšÿn
::
Upd©eRou‹TabË
(

300 cÚ¡ 
JsÚ
::
V®ue
 & 
¹s_desc
)

302 
¡ršg
 
Šl_id
 = 
¹s_desc
[
TšÿnCÚŒŞ
::
TuÂ–Id
].
asSŒšg
();

303 
	gBasicTuÂ–
 & 
	gŞ
 = 
TuÂ–FromId
(
Šl_id
);

304 
	gŞ
.
Upd©eRou‹TabË
(
¹s_desc
["Table"]);

308 
	gTšÿn
::
Run
()

311 #ià
defšed
(
_IPOP_WIN
)

312 
£lf_
 = 
this
;

313 
S‘CÚsŞeCŒlHªdËr
(
CÚŒŞHªdËr
, 
TRUE
);

317 
	gunique_±r
<
	gCÚŒŞDi¥©ch
> 
ù¾_di¥©ch
(
Ãw
 
CÚŒŞDi¥©ch
);

318 
	gù¾_di¥©ch
->
S‘Di¥©chToTšÿnInf
(
this
);

319 
	gù¾_li¡’”_
 = 
make_sh¬ed
<
CÚŒŞLi¡’”
>(
move
(
ù¾_di¥©ch
));

320 
	gùl_th»ad_
.
S¹
(
ù¾_li¡’”_
.
g‘
());

321 
	gex™_ev’t_
.
Wa™
(
Ev’t
::
kFÜev”
);

324 
boŞ


325 
	gTšÿn
::
IsTuÂ–Exis™
(

326 cÚ¡ 
¡ršg
 & 
Šl_id
)

328 
lock_gu¬d
<
mu‹x
> 
lg
(
tuÂ–s_mu‹x_
);

329 autØcÚ¡ & 
	gŠl
 : 
tuÂ–s_
) {

330 if(
Šl
->
DesütÜ
().
uid
.
com·»
(
Šl_id
) == 0)

331  
Œue
;

333  
	gçl£
;

336 
	gBasicTuÂ–
 &

337 
	gTšÿn
::
TuÂ–FromId
(

338 cÚ¡ 
¡ršg
 & 
Šl_id
)

340 
lock_gu¬d
<
mu‹x
> 
lg
(
tuÂ–s_mu‹x_
);

341 autØcÚ¡ & 
	gŠl
 : 
tuÂ–s_
)

344 if(
Šl
->
DesütÜ
().
uid
.
com·»
(
Šl_id
) == 0)

345  *
Šl
.
g‘
();

347 
¡ršg
 
msg
("No virtual‚etworkƒxists byhis‚ame: ");

348 
	gmsg
.
­³nd
(
Šl_id
);

349 
throw
 
TCEXCEPT
(
msg
.
c_¡r
());

352 
	gTšÿn
::
OnStİ
() {

353 
Shutdown
();

354 
	gex™_ev’t_
.
S‘
();

358 
	gTšÿn
::
Shutdown
()

360 
lock_gu¬d
<
mu‹x
> 
lg
(
tuÂ–s_mu‹x_
);

361 
	gùl_th»ad_
.
Qu™
();

362 autØcÚ¡ & 
	gŠl
 : 
tuÂ–s_
) {

363 
Šl
->
Shutdown
();

365 
	gtuÂ–s_
.
ş—r
();

374 #ià
defšed
(
_IPOP_WIN
)

375 
BOOL
 
__¡dÿÎ
 
	gTšÿn
::
CÚŒŞHªdËr
(
DWORD
 
CŒlTy³
) {

376 
CŒlTy³
) {

377 
CTRL_BREAK_EVENT
:

378 
CTRL_C_EVENT
:

379 
cout
 << "Stİpšgšÿn... " << 
¡d
::
’dl
;

380 
	g£lf_
->
OnStİ
();

381 (
	gTRUE
);

383 (
	gFALSE
);

	@src/tincan_control.cc

23 
	~"tšÿn_cÚŒŞ.h
"

24 
	~"web¹c/ba£/loggšg.h
"

25 
	~"tšÿn_exû±iÚ.h
"

26 
Çme¥aû
 
	gtšÿn


28 
TšÿnP¬am‘”s
 

;

29 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Commªd
("Command");

30 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
CAS
("CAS");

31 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
CÚŒŞTy³
("ControlType");

32 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
CÚŒŞËd
("Controlled");

33 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
CÚŒŞlšg
("Controlling");

34 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
C»©eCŒlRe¥Lšk
("CreateCtrlRespLink");

35 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
C»©eTuÂ–
("CreateTunnel");

36 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
D©a
("Data");

37 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Echo
("Echo");

38 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Enüy±iÚEÇbËd
("EncryptionEnabled");

39 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
FPR
("FPR");

40 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
ICC
("ICC");

41 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
IûRŞe
("IceRole");

42 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
IgnÜedN‘IÁ”çûs
("IgnoredNetInterfaces");

43 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
IP4P»fixL’
("IP4PrefixLen");

44 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
IPOP
("IPOP");

45 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
LškId
("LinkId");

46 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
LškS‹Chªge
("LinkStateChange");

47 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Lev–
("Level");

48 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
MAC
("MAC");

49 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Mes§ge
("Message");

50 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
MTU4
("MTU4");

51 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
NodeId
("NodeId");

52 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
P“rInfo
("PeerInfo");

53 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
PrÙocŞV”siÚ
("ProtocolVersion");

54 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Qu”yTuÂ–Info
("QueryTunnelInfo");

55 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Qu”yCªdid©eAdd»ssS‘
("QueryCandidateAddressSet");

56 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
RemoveTuÂ–
("RemoveTunnel");

57 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
ReqRou‹Upd©e
("ReqRouteUpdate");

58 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Reque¡
("Request");

59 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Re¥Ú£
("Response");

60 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
RŞe
("Role");

61 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
S‘IgnÜedN‘IÁ”çûs
("SetIgnoredNetInterfaces");

62 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
S‘LoggšgLev–
("SetLoggingLevel");

63 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Sts
("Stats");

64 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Stus
("Status");

65 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Sucûss
("Success");

66 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
T­Name
("TapName");

67 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
TšÿnReque¡
("TincanRequest");

68 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
TšÿnRe¥Ú£
("TincanResponse");

69 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
T¿n§ùiÚId
("TransactionId");

70 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
TuÂ–Id
("TunnelId");

71 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Ty³
("Type");

72 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
UID
("UID");

73 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Upd©eRou‹TabË
("UpdateRouteTable");

74 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
VIP4
("VIP4");

75 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
VÃtDesütiÚ
("VnetDescription");

76 cÚ¡ 
	gJsÚ
::
SticSŒšg
 
TšÿnCÚŒŞ
::
Vlšks
("Vlinks");

78 
	gTšÿnCÚŒŞ
::
TšÿnCÚŒŞ
() :

79 
´Ùo_v”_
(

.
kTšÿnCÚŒŞV”
),

80 
g_
(
NextTagV®ue
()),

81 
ty³_
(
CTTšÿnReque¡
),

82 
diù_»q_
(
nuÎ±r
),

83 
diù_»¥_
(
nuÎ±r
)

86 
	gTšÿnCÚŒŞ
::
TšÿnCÚŒŞ
(

87 
unique_±r
<
JsÚ
::
V®ue
> 
»q
) :

88 
´Ùo_v”_
(

.
kTšÿnCÚŒŞV”
),

89 
g_
(
NextTagV®ue
()),

90 
ty³_
(
CTTšÿnReque¡
),

91 
diù_»q_
(
»q
.
»Ëa£
()),

92 
diù_»¥_
(
Ãw
 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
))

95 
TšÿnCÚŒŞ
::TincanControl(

96 
unique_±r
<
JsÚ
::
V®ue
> 
»q
,

97 
unique_±r
<
JsÚ
::
V®ue
> 
»¥
) :

98 
´Ùo_v”_
(

.
kTšÿnCÚŒŞV”
),

99 
g_
(
NextTagV®ue
()),

100 
ty³_
(
CTTšÿnReque¡
),

101 
diù_»q_
(
»q
.
»Ëa£
()),

102 
diù_»¥_
(
»¥
.
»Ëa£
())

105 
	gTšÿnCÚŒŞ
::
TšÿnCÚŒŞ
(

106 cÚ¡ * cÚ¡ 
»q_d©a
,

107 cÚ¡ 
size_t
 
Ën
) :

108 
diù_»q_
(
Ãw
 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
)),

109 
diù_»¥_
(
Ãw
 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
))

112 
JsÚ
::
R—d”
 
·r£r
;

113 
	gJsÚ
::
V®ue
 
ù¾
(
JsÚ
::
objeùV®ue
);

114 if(!
	g·r£r
.
·r£
(
»q_d©a
,„eq_d©¨+ 
Ën
, 
ù¾
))

116 
¡ršg
 
	g”rmsg
 = "Unableo…arse json control object - ";

117 
	g”rmsg
.
­³nd
(
»q_d©a
,„eq_d©¨+ 
Ën
);

118 
throw
 
TCEXCEPT
(
”rmsg
.
c_¡r
());

120 if(
	gù¾
[
IPOP
].
isNuÎ
(è|| cŒl[IPOP].
em±y
())

122 
o¡ršg¡»am
 
	goss
;

123 
	goss
 << "ThcÚŒŞ i šv®id,he'IPOP' h—d” i missšg" << 
	g’dl


124 << 
	g»q_d©a
;

125 
throw
 
TCEXCEPT
(
oss
.
¡r
().
c_¡r
());

127 
ušt32_t
 
	gv”
 = 
ù¾
[
IPOP
][
PrÙocŞV”siÚ
].
asUIÁ
();

128 if(
	gv”
 !ğ

.
kTšÿnCÚŒŞV”
)

130 
o¡ršg¡»am
 
oss
;

131 
	goss
 << "Inv®id IPOP…rÙocŞ v”siÚ iÀcÚŒŞ h—d” (" << 
	gv”
 << ")";

132 
throw
 
TCEXCEPT
(
oss
.
¡r
().
c_¡r
());

134 
	g´Ùo_v”_
 = 
v”
;

135 
¡ršg
 
	gù
 = 
ù¾
[
IPOP
][
CÚŒŞTy³
].
asSŒšg
();

136 if(
	gù
 =ğ
CÚŒŞTy³SŒšgs
[
CTTšÿnReque¡
])

138 
ty³_
 = 
CTTšÿnReque¡
;

140 if(
	gù
 =ğ
CÚŒŞTy³SŒšgs
[
CTTšÿnRe¥Ú£
])

142 
ty³_
 = 
CTTšÿnRe¥Ú£
;

146 
throw
 
TCEXCEPT
("Invalid controlype");

148 
	gg_
 = 
ù¾
[
IPOP
][
T¿n§ùiÚId
].
asIÁ64
();

149 if(
	gù¾
[
IPOP
].
isMemb”
(
Reque¡
))

151 (*
	gdiù_»q_
èğ
ù¾
[
IPOP
].
»moveMemb”
(
Reque¡
);

153 if(
	gù¾
[
IPOP
].
isMemb”
(
Re¥Ú£
)) {

154 (*
	gdiù_»¥_
èğ
ù¾
[
IPOP
].
»moveMemb”
(
Re¥Ú£
);

158 
	gTšÿnCÚŒŞ
::
TšÿnCÚŒŞ
(

159 cÚ¡ 
TšÿnCÚŒŞ
 & 
ù¾_»q
) :

160 
´Ùo_v”_
(
ù¾_»q
.proto_ver_),

161 
g_
(
ù¾_»q
.tag_),

162 
ty³_
(
ù¾_»q
.type_),

163 
diù_»q_
(
Ãw
 
JsÚ
::
V®ue
(*
ù¾_»q
.dict_req_)),

164 
diù_»¥_
(
Ãw
 
JsÚ
::
V®ue
(*
ù¾_»q
.dict_resp_))

167 
TšÿnCÚŒŞ
::TincanControl(

168 
TšÿnCÚŒŞ
 && 
ù¾_»q
) :

169 
´Ùo_v”_
(
ù¾_»q
.proto_ver_),

170 
g_
(
ù¾_»q
.tag_),

171 
ty³_
(
ù¾_»q
.type_),

172 
diù_»q_
(
ù¾_»q
.dict_req_),

173 
diù_»¥_
(
ù¾_»q
.dict_resp_)

175 
	gù¾_»q
.
	gdiù_»q_
 = 
nuÎ±r
;

176 
	gù¾_»q
.
	gdiù_»¥_
 = 
nuÎ±r
;

179 
	gTšÿnCÚŒŞ
::~
TšÿnCÚŒŞ
()

181 
d–‘e
 
diù_»q_
;

182 
d–‘e
 
	gdiù_»¥_
;

185 
	gTšÿnCÚŒŞ
 &

186 
	gTšÿnCÚŒŞ
::
İ”©Ü
=(

187 
TšÿnCÚŒŞ
 & 
rhs
)

189 if(
this
 !ğ&
rhs
)

191 
´Ùo_v”_
 = 
rhs
.proto_ver_;

192 
	gg_
 = 
rhs
.
g_
;

193 
	gty³_
 = 
rhs
.
ty³_
;

195 
d–‘e
 
	gdiù_»q_
;

196 
	gdiù_»q_
 = 
Ãw
 
JsÚ
::
V®ue
(*
rhs
.
diù_»q_
);

197 
d–‘e
 
	gdiù_»¥_
;

198 
	gdiù_»¥_
 = 
Ãw
 
JsÚ
::
V®ue
(*
rhs
.
diù_»¥_
);

200  *
	gthis
;

203 
	gTšÿnCÚŒŞ
 &

204 
	gTšÿnCÚŒŞ
::
İ”©Ü
=(

205 
TšÿnCÚŒŞ
 && 
rhs
)

207 if(
this
 !ğ&
rhs
)

209 
´Ùo_v”_
 = 
rhs
.proto_ver_;

210 
	gg_
 = 
rhs
.
g_
;

211 
	gty³_
 = 
rhs
.
ty³_
;

213 
d–‘e
 
	gdiù_»q_
;

214 
	gdiù_»q_
 = 
rhs
.
diù_»q_
;

215 
	grhs
.
	gdiù_»q_
 = 
nuÎ±r
;

216 
d–‘e
 
	gdiù_»¥_
;

217 
	gdiù_»¥_
 = 
rhs
.
diù_»¥_
;

218 
	grhs
.
	gdiù_»¥_
 = 
nuÎ±r
;

220  *
	gthis
;

223 
¡ršg


224 
	gTšÿnCÚŒŞ
::
StyËdSŒšg
()

226 
JsÚ
::
V®ue
 
ù¾
(JsÚ::
objeùV®ue
);

227 
	gù¾
[
IPOP
][
PrÙocŞV”siÚ
] = 
´Ùo_v”_
;

228 
	gù¾
[
IPOP
][
T¿n§ùiÚId
] = (
JsÚ
::
UIÁ64
)
g_
;

229 
	gù¾
[
IPOP
][
CÚŒŞTy³
] = 
CÚŒŞTy³SŒšgs
[
ty³_
];

230 if(
	gdiù_»q_
)

231 
	gù¾
[
IPOP
][
Reque¡
] = *
diù_»q_
;

232 if(
	gdiù_»¥_
)

233 
	gù¾
[
IPOP
][
Re¥Ú£
] = *
diù_»¥_
;

234  
	gù¾
.
toStyËdSŒšg
();

237 
	gTšÿnCÚŒŞ
::
S‘Reque¡
(
unique_±r
<
JsÚ
::
V®ue
> 
»q
)

239 
d–‘e
 
diù_»q_
;

240 
	gdiù_»q_
 = 
»q
.
»Ëa£
();

241 
	gty³_
 = 
CTTšÿnReque¡
;

244 
	gJsÚ
::
V®ue
 &

245 
TšÿnCÚŒŞ
::
G‘Reque¡
()

247 if(!
diù_»q_
)

248 
diù_»q_
 = 
Ãw
 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
);

249  (*
	gdiù_»q_
);

253 
	gTšÿnCÚŒŞ
::
S‘Re¥Ú£
(

254 
unique_±r
<
JsÚ
::
V®ue
> 
»¥
)

256 
d–‘e
 
diù_»¥_
;

257 
	gdiù_»¥_
 = 
»¥
.
»Ëa£
();

258 
	gty³_
 = 
CTTšÿnRe¥Ú£
;

262 
	gTšÿnCÚŒŞ
::
S‘Re¥Ú£
(

263 cÚ¡ 
¡ršg
 & 
»¥_msg
,

264 
boŞ
 
sucûss
)

266 if(!
	gdiù_»¥_
)

267 
	gdiù_»¥_
 = 
Ãw
 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
);

268 (*
	gdiù_»¥_
)[
Mes§ge
] = 
»¥_msg
;

269 (*
	gdiù_»¥_
)[
Sucûss
] = 
sucûss
;

270 
	gty³_
 = 
CTTšÿnRe¥Ú£
;

273 
	gJsÚ
::
V®ue
 &

274 
TšÿnCÚŒŞ
::
G‘Re¥Ú£
()

276 if(!
diù_»¥_
)

277 
diù_»¥_
 = 
Ãw
 
JsÚ
::
V®ue
(JsÚ::
objeùV®ue
);

278  (*
	gdiù_»¥_
);

281 
¡ršg


282 
	gTšÿnCÚŒŞ
::
G‘Commªd
() const

284 if(
ty³_
 =ğ
CTTšÿnReque¡
)

285  (*
diù_»q_
)[
Commªd
].
asSŒšg
();

286 if(
	gty³_
 =ğ
CTTšÿnRe¥Ú£
)

287  (*
diù_»¥_
)[
Commªd
].
asSŒšg
();

288  
¡ršg
();

291 
	gTšÿnCÚŒŞ
::
S‘Commªd
(
¡ršg
 
cmd
)

293 if(
ty³_
 =ğ
CTTšÿnReque¡
)

294 (*
diù_»q_
)[
Commªd
] = 
cmd
;

295 if(
	gty³_
 =ğ
CTTšÿnRe¥Ú£
)

296 (*
diù_»¥_
)[
Commªd
] = 
cmd
;

299 
	gTšÿnCÚŒŞ
::
S‘T¿n§ùiÚId
(
ušt64_t
 
g
)

301 (*
diù_»q_
)[
T¿n§ùiÚId
] = (
JsÚ
::
UIÁ64
)
g
;

304 
ušt64_t


305 
	gTšÿnCÚŒŞ
::
G‘T¿n§ùiÚId
() const

307  
g_
;

310 
	gTšÿnCÚŒŞ
::
CÚŒŞTy³Enum


311 
TšÿnCÚŒŞ
::
G‘CÚŒŞTy³
() const

313  
ty³_
;

316 
	gTšÿnCÚŒŞ
::
S‘CÚŒŞTy³
(
CÚŒŞTy³Enum
 
ty³
)

318 
ty³_
 = 
ty³
;

	@src/tincan_main.cc

23 
	#TINCAN_MAIN
 1

	)

24 
	~"tšÿn_ba£.h
"

25 
	~"tšÿn.h
"

26 
Çme¥aû
 
	gtšÿn


28 
TšÿnP¬am‘”s
 
	g
;

30 
usšg
 
Çme¥aû
 
	gtšÿn
;

31 
Tšÿn
 * 
	gTšÿn
::
£lf_
ğ
NULL
;

33 
	$maš
(
¬gc
, **
¬gv
)

35 
rv
 = 0;

36 
Œy
 {

37 

.
	`P¬£CmdlšeArgs
(
¬gc
, 
¬gv
);

38 if(

.
kV”siÚCheck
) {

39 
cout
 << 

.
kTšÿnV”Mjr
 << "."

40 << 

.
kTšÿnV”MÄ
 << "."

41 << 

.
kTšÿnV”Rev
 << 
’dl
;

43 if(

.
kN“dsH–p
) {

44 
¡d
::
cout
 << "-v Version check.\n" <<

45 "-i=COUNT S³cify cÚcu¼’ˆI/Os" << 
’dl
 <<

46 "-p=PORT S³cify cÚŒŞ…Üˆnumb”" << 
’dl
;

49 
Tšÿn
 
tc
;

50 
tc
.
	`Run
();

53 
	`ÿtch
(
exû±iÚ
 & 
e
) {

54 
rv
 = -1;

55 
	`LOG
(
LS_ERROR
è<< 
e
.
	`wh©
();

57  
rv
;

58 
	}
}

	@src/virtual_link.cc

23 
	~"vœtu®_lšk.h
"

24 
	~"web¹c/¹c_ba£/¡ršg_’code.h
"

25 
	~"tšÿn_exû±iÚ.h
"

26 
	~"tuº_desütÜ.h
"

27 
Çme¥aû
 
	gtšÿn


29 
usšg
 
Çme¥aû
 
	g¹c
;

30 
	gVœtu®Lšk
::
Vœtu®Lšk
(

31 
unique_±r
<
VlškDesütÜ
> 
vlšk_desc
,

32 
unique_±r
<
P“rDesütÜ
> 
³”_desc
,

33 
¹c
::
Th»ad
* 
sigÇlšg_th»ad
,

34 
¹c
::
Th»ad
* 
ÃtwÜk_th»ad
) :

35 
vlšk_desc_
(
move
(
vlšk_desc
)),

36 
³”_desc_
(
move
(
³”_desc
)),

37 
t›b»ak”_
(
¹c
::
C»©eRªdomId64
()),

38 
cÚn_rŞe_
(
üick‘
::
CONNECTIONROLE_ACTPASS
),

39 
chªÃl_
(
nuÎ±r
),

40 
·ck‘_İtiÚs_
(
DSCP_DEFAULT
),

41 
·ck‘_çùÜy_
(
ÃtwÜk_th»ad
),

42 
g©h”_¡©e_
(
üick‘
::
kIûG©h”šgNew
),

43 
is_v®id_
(
çl£
),

44 
sigÇlšg_th»ad_
(
sigÇlšg_th»ad
),

45 
ÃtwÜk_th»ad_
(
ÃtwÜk_th»ad
)

47 
	gcÚ‹Á_Çme_
.
­³nd
(
vlšk_desc_
->
uid
.
sub¡r
(0, 7));

50 
	gVœtu®Lšk
::~
Vœtu®Lšk
()

53 
¡ršg
 
Vœtu®Lšk
::
Name
()

55  
cÚ‹Á_Çme_
;

59 
	gVœtu®Lšk
::
In™Ÿlize
(

60 
BasicN‘wÜkMªag”
 & 
ÃtwÜk_mªag”
,

61 
unique_±r
<
SSLId’t™y
>
s¦id
,

62 
SSLFšg”´št
 cÚ¡ & 
loÿl_fšg”´št
,

63 
üick‘
::
IûRŞe
 
iû_rŞe
)

65 
iû_rŞe_
 = 
iû_rŞe
;

67 
	güick‘
::
S”v”Add»s£s
 
¡un_addrs
;

68 autØ
	g¡un_£rv”
 : 
vlšk_desc_
->
¡un_£rv”s
)

70 
¹c
::
Sock‘Add»ss
 
¡un_addr
;

71 
	g¡un_addr
.
FromSŒšg
(
¡un_£rv”
);

72 
	g¡un_addrs
.
š£¹
(
¡un_addr
);

74 
	gpÜt_®loÿtÜ_
.
»£t
(
Ãw
 
üick‘
::
BasicPÜtAÎoÿtÜ
(

75 &
ÃtwÜk_mªag”
, &
·ck‘_çùÜy_
, 
¡un_addrs
));

77 
	gpÜt_®loÿtÜ_
->
£t_æags
(
üick‘
::
PORTALLOCATOR_DISABLE_TCP
);

78 
S‘upTURN
(
vlšk_desc_
->
tuº_descs
);

79 
	gŒª¥Üt_ùÌ_
 = 
make_unique
<
T¿n¥ÜtCÚŒŞËr
>(
sigÇlšg_th»ad_
,

80 
	gÃtwÜk_th»ad_
, 
	gpÜt_®loÿtÜ_
.
g‘
());

82 
	gŒª¥Üt_ùÌ_
->
S‘LoÿlC”tifiÿ‹
(
RTCC”tifiÿ‹
::
C»©e
(
move
(
s¦id
)));

83 
	gchªÃl_
 = 
Œª¥Üt_ùÌ_
->
C»©eT¿n¥ÜtChªÃl
(
cÚ‹Á_Çme_
,

84 
üick‘
::
ICE_CANDIDATE_COMPONENT_DEFAULT
);

85 
Regi¡”LškEv’tHªdËrs
();

86 
S‘upICE
(
loÿl_fšg”´št
);

87 
	gŒª¥Üt_ùÌ_
->
MaybeS¹G©h”šg
();

96 
	gVœtu®Lšk
::
AddRemÙeCªdid©es
(

97 cÚ¡ 
¡ršg
 & 
ÿndid©es
)

99 
¡d
::
i¡ršg¡»am
 
iss
(
ÿndid©es
);

100 
	güick‘
::
Cªdid©es
 
ÿs_vec
;

102 
¡ršg
 
	gÿndid©e_¡r
;

103 
	giss
 >> 
	gÿndid©e_¡r
;

104 
	gveùÜ
<
	g¡ršg
> 
	gf›lds
;

105 
size_t
 
	gËn
 = 
¹c
::
¥l™
(
ÿndid©e_¡r
, 

.
kCªdid©eD–im
, &
f›lds
);

106 
	g¹c
::
Sock‘Add»ss
 
§
;

107 if(
	gËn
 >= 10) {

108 
§
.
FromSŒšg
(
f›lds
[2].
­³nd
(":").append(fields[3]));

109 
	güick‘
::
Cªdid©e
 
ÿndid©e
(

110 
©oi
(
f›lds
[0].
c_¡r
()),

111 
f›lds
[1],

112 
§
,

113 
©oi
(
f›lds
[4].
c_¡r
()),

114 
f›lds
[5],

115 
f›lds
[6],

116 
f›lds
[7],

117 
©oi
(
f›lds
[8].
c_¡r
()),

118 
f›lds
[9]);

119 
	gÿs_vec
.
push_back
(
ÿndid©e
);

121 } 
	giss
);

122 
¡ršg
 
	g”r
;

123 
boŞ
 
	grv
 = 
Œª¥Üt_ùÌ_
->
AddRemÙeCªdid©es
(
cÚ‹Á_Çme_
, 
ÿs_vec
, &
”r
);

124 if(!
	grv
)

125 
throw
 
TCEXCEPT
(
¡ršg
("FaedØadd„emÙÿndid©e - ").
­³nd
(
”r
).
c_¡r
());

130 
	gVœtu®Lšk
::
OnR—dPack‘
(

131 
Pack‘T¿n¥ÜtIÁ”çû
 *,

132 cÚ¡ * 
d©a
,

133 
size_t
 
Ën
,

134 cÚ¡ 
¹c
::
Pack‘Time
 &,

137 
SigÇlMes§geReûived
((
ušt8_t
*)
d©a
, *(
ušt32_t
*)&
Ën
, *
this
);

141 
	gVœtu®Lšk
::
OnS’tPack‘
(

142 
Pack‘T¿n¥ÜtIÁ”çû
 *,

143 cÚ¡ 
¹c
::
S’tPack‘
 &)

148 
Vœtu®Lšk
::
OnCªdid©esG©h”ed
(

149 cÚ¡ 
¡ršg
 &,

150 cÚ¡ 
üick‘
::
Cªdid©es
 & 
ÿndid©es
)

152 
¡d
::
unique_lock
<¡d::
mu‹x
> 
lk
(
ÿs_mu‹x_
);

153 
	gloÿl_ÿndid©es_
.
š£¹
(
loÿl_ÿndid©es_
.
’d
(), 
ÿndid©es
.
begš
(),

154 
ÿndid©es
.
’d
());

158 
	gVœtu®Lšk
::
OnG©h”šgS‹
(

159 
üick‘
::
IûG©h”šgS‹
 
g©h”_¡©e
)

161 
g©h”_¡©e_
 = 
g©h”_¡©e
;

162 if(
	gg©h”_¡©e
 =ğ
üick‘
::
kIûG©h”šgCom¶‘e
)

163 
SigÇlLoÿlCasR—dy
(
vlšk_desc_
->
uid
, 
Cªdid©es
());

167 
	gVœtu®Lšk
::
OnWr™—bËS‹
(

168 
Pack‘T¿n¥ÜtIÁ”çû
 * 
Œª¥Üt
)

170 if(
Œª¥Üt
->
wr™abË
())

172 
LOG
(
LS_INFO
è<< "CÚÃùiÚƒ¡ablishedo: " << 
³”_desc_
->
uid
;

173 
SigÇlLškUp
(
vlšk_desc_
->
uid
);

177 
LOG
(
LS_INFO
è<< "Lšk NOT wr™—bË: " << 
	g³”_desc_
->
	guid
;

178 
SigÇlLškDown
(
vlšk_desc_
->
uid
);

183 
	gVœtu®Lšk
::
Regi¡”LškEv’tHªdËrs
()

185 
chªÃl_
->
SigÇlR—dPack‘
.
cÚÃù
(
this
, &
Vœtu®Lšk
::
OnR—dPack‘
);

186 
	gchªÃl_
->
	gSigÇlS’tPack‘
.
cÚÃù
(
this
, &
Vœtu®Lšk
::
OnS’tPack‘
);

187 
	gchªÃl_
->
	gSigÇlWr™abËS‹
.
cÚÃù
(
this
, &
Vœtu®Lšk
::
OnWr™—bËS‹
);

190 
	gŒª¥Üt_ùÌ_
->
	gSigÇlCªdid©esG©h”ed
.
cÚÃù
(

191 
this
, &
Vœtu®Lšk
::
OnCªdid©esG©h”ed
);

192 
	gŒª¥Üt_ùÌ_
->
	gSigÇlG©h”šgS‹
.
cÚÃù
(

193 
this
, &
Vœtu®Lšk
::
OnG©h”šgS‹
);

196 
	gVœtu®Lšk
::
T¿nsm™
(
T­F¿me
 & 
äame
)

198 
¡©us
 = 
chªÃl_
->
S’dPack‘
((cÚ¡ *)
äame
.
BufãrToT¿nsãr
(),

199 
äame
.
By‹sToT¿nsãr
(), 
·ck‘_İtiÚs_
, 0);

200 if(
	g¡©us
 < 0)

201 
LOG
(
LS_INFO
) << "Vlink send failed";

204 
¡ršg
 
	gVœtu®Lšk
::
Cªdid©es
()

206 
¡d
::
o¡ršg¡»am
 
oss
;

207 autØ& 
	gúd
 : 
loÿl_ÿndid©es_
)

209 
oss
 << 
úd
.
compÚ’t
()

210 << 

.
kCªdid©eD–im
 << 
úd
.
´ÙocŞ
()

211 << 

.
kCªdid©eD–im
 << 
úd
.
add»ss
().
ToSŒšg
()

212 << 

.
kCªdid©eD–im
 << 
úd
.
´iÜ™y
()

213 << 

.
kCªdid©eD–im
 << 
úd
.
u£ºame
()

214 << 

.
kCªdid©eD–im
 << 
úd
.
·sswÜd
()

215 << 

.
kCªdid©eD–im
 << 
úd
.
ty³
()

216 << 

.
kCªdid©eD–im
 << 
úd
.
g’”©iÚ
()

217 << 

.
kCªdid©eD–im
 << 
úd
.
found©iÚ
()

220  
	goss
.
¡r
();

223 
¡ršg
 
	gVœtu®Lšk
::
P“rCªdid©es
()

225  
³”_desc_
->
ÿs
;

229 
	gVœtu®Lšk
::
P“rCªdid©es
(

230 cÚ¡ 
¡ršg
 & 
³”_ÿs
)

232 
³”_desc_
->
ÿs
 = 
³”_ÿs
;

236 
	gVœtu®Lšk
::
G‘Sts
(
JsÚ
::
V®ue
 & 
¡©s
)

238 
üick‘
::
CÚÃùiÚInfos
 
šfos
;

239 
	gchªÃl_
->
G‘Sts
(&
šfos
);

240 autØ
	gšfo
 : 
šfos
)

242 
JsÚ
::
V®ue
 
¡©
(JsÚ::
objeùV®ue
);

243 
	g¡©
["be¡_cÚn"] = 
šfo
.
be¡_cÚÃùiÚ
;

244 
	g¡©
["wr™abË"] = 
šfo
.
wr™abË
;

245 
	g¡©
["»ûivšg"] = 
šfo
.
»ûivšg
;

246 
	g¡©
["timeout"] = 
šfo
.
timeout
;

247 
	g¡©
["Ãw_cÚn"] = 
šfo
.
Ãw_cÚÃùiÚ
;

249 
	g¡©
["¹t"] = (
JsÚ
::
UIÁ64
)
šfo
.
¹t
;

250 
	g¡©
["£Á_tÙ®_by‹s"] = (
JsÚ
::
UIÁ64
)
šfo
.
£Á_tÙ®_by‹s
;

251 
	g¡©
["£Á_by‹s_£cÚd"] = (
JsÚ
::
UIÁ64
)
šfo
.
£Á_by‹s_£cÚd
;

252 
	g¡©
["£Á_disÿrded_·ck‘s"] = (
JsÚ
::
UIÁ64
)
šfo
.
£Á_disÿrded_·ck‘s
;

253 
	g¡©
["£Á_tÙ®_·ck‘s"] = (
JsÚ
::
UIÁ64
)
šfo
.
£Á_tÙ®_·ck‘s
;

254 
	g¡©
["£Á_pšg_»que¡s_tÙ®"] = (
JsÚ
::
UIÁ64
)
šfo
.
£Á_pšg_»que¡s_tÙ®
;

255 
	g¡©
["£Á_pšg_»que¡s_befÜe_fœ¡_»¥Ú£"] = (
JsÚ
::
UIÁ64
)
šfo
.
£Á_pšg_»que¡s_befÜe_fœ¡_»¥Ú£
;

256 
	g¡©
["£Á_pšg_»¥Ú£s"] = (
JsÚ
::
UIÁ64
)
šfo
.
£Á_pšg_»¥Ú£s
;

258 
	g¡©
["»cv_tÙ®_by‹s"] = (
JsÚ
::
UIÁ64
)
šfo
.
»cv_tÙ®_by‹s
;

259 
	g¡©
["»cv_by‹s_£cÚd"] = (
JsÚ
::
UIÁ64
)
šfo
.
»cv_by‹s_£cÚd
;

260 
	g¡©
["»cv_pšg_»que¡s"] = (
JsÚ
::
UIÁ64
)
šfo
.
»cv_pšg_»que¡s
;

261 
	g¡©
["»cv_pšg_»¥Ú£s"] = (
JsÚ
::
UIÁ64
)
šfo
.
»cv_pšg_»¥Ú£s
;

263 
	g¡©
["loÿl_ÿndid©e"] = 
šfo
.
loÿl_ÿndid©e
.
ToSŒšg
();

264 
	g¡©
["»mÙe_ÿndid©e"] = 
šfo
.
»mÙe_ÿndid©e
.
ToSŒšg
();

265 
	g¡©
["¡©e"] = (
JsÚ
::
UIÁ
)
šfo
.
¡©e
;

267 
	g¡©s
.
­³nd
(
¡©
);

272 
	gVœtu®Lšk
::
S‘upICE
(

273 
SSLFšg”´št
 cÚ¡ & 
loÿl_fšg”´št
)

275 
size_t
 
pos
 = 
³”_desc_
->
fšg”´št
.
fšd
(' ');

276 
¡ršg
 
	g®g
, 
	gå
;

277 if(
	gpos
 !ğ
¡ršg
::
Åos
)

279 
®g
 = 
³”_desc_
->
fšg”´št
.
sub¡r
(0, 
pos
);

280 
	gå
 = 
³”_desc_
->
fšg”´št
.
sub¡r
(++
pos
);

281 
	g»mÙe_fšg”´št_
.
»£t
(

282 
¹c
::
SSLFšg”´št
::
C»©eFromRfc4572
(
®g
, 
å
));

287 
	gŒª¥Üt_ùÌ_
->
S‘IûRŞe
(
iû_rŞe_
);

288 
	güick‘
::
CÚÃùiÚRŞe
 
»mÙe_cÚn_rŞe
 = 
üick‘
::
CONNECTIONROLE_ACTIVE
;

289 
	gcÚn_rŞe_
 = 
üick‘
::
CONNECTIONROLE_ACTPASS
;

290 if(
	güick‘
::
ICEROLE_CONTROLLING
 =ğ
iû_rŞe_
) {

291 
cÚn_rŞe_
 = 
üick‘
::
CONNECTIONROLE_ACTIVE
;

292 
	g»mÙe_cÚn_rŞe
 = 
üick‘
::
CONNECTIONROLE_ACTPASS
;

295 
	gloÿl_desütiÚ_
.
»£t
(
Ãw
 
üick‘
::
T¿n¥ÜtDesütiÚ
(

296 
veùÜ
<
¡ršg
>(),

297 

.
kIûUäag
,

298 

.
kIûPwd
,

299 
üick‘
::
ICEMODE_FULL
,

300 
cÚn_rŞe_
,

301 & 
loÿl_fšg”´št
));

303 
	g»mÙe_desütiÚ_
.
»£t
(
Ãw
 
üick‘
::
T¿n¥ÜtDesütiÚ
(

304 
veùÜ
<
¡ršg
>(),

305 

.
kIûUäag
,

306 

.
kIûPwd
,

307 
üick‘
::
ICEMODE_FULL
,

308 
»mÙe_cÚn_rŞe
,

309 
»mÙe_fšg”´št_
.
g‘
()));

311 if(
	güick‘
::
ICEROLE_CONTROLLING
 =ğ
iû_rŞe_
)

314 
Œª¥Üt_ùÌ_
->
S‘RemÙeT¿n¥ÜtDesütiÚ
(
cÚ‹Á_Çme_
,

315 *
»mÙe_desütiÚ_
.
g‘
(), 
üick‘
::
CA_OFFER
, 
NULL
);

316 
	gŒª¥Üt_ùÌ_
->
S‘LoÿlT¿n¥ÜtDesütiÚ
(
cÚ‹Á_Çme_
,

317 *
loÿl_desütiÚ_
.
g‘
(), 
üick‘
::
CA_ANSWER
, 
NULL
);

319 if(
	güick‘
::
ICEROLE_CONTROLLED
 =ğ
iû_rŞe_
)

321 
Œª¥Üt_ùÌ_
->
S‘LoÿlT¿n¥ÜtDesütiÚ
(
cÚ‹Á_Çme_
,

322 *
loÿl_desütiÚ_
.
g‘
(), 
üick‘
::
CA_OFFER
, 
NULL
);

323 
	gŒª¥Üt_ùÌ_
->
S‘RemÙeT¿n¥ÜtDesütiÚ
(
cÚ‹Á_Çme_
,

324 *
»mÙe_desütiÚ_
.
g‘
(), 
üick‘
::
CA_ANSWER
, 
NULL
);

328 
LOG
(
LS_WARNING
è<< "Inv®id ICE„Ş¥ecif›d: " << (
	gušt32_t
)
	giû_rŞe_
;

329 
throw
 
TCEXCEPT
("Invalid ICE„ole specified");

334 
	gVœtu®Lšk
::
S‘upTURN
(

335 cÚ¡ 
veùÜ
<
TuºDesütÜ
> 
tuº_descs
)

337 if(
tuº_descs
.
em±y
()) {

338 
LOG
(
LS_INFO
) << "No TURN Server‡ddress…rovided";

342 autØ
	gtuº_desc
 : 
tuº_descs
)

344 ià(
tuº_desc
.
u£ºame
.
em±y
(è||uº_desc.
·sswÜd
.empty())

346 
LOG
(
LS_WARNING
è<< "TURN c»d’tŸl w”nÙ…rovided fÜ ho¡Çm" << 
tuº_desc
.
£rv”_ho¡Çme
;

350 
	gveùÜ
<
	g¡ršg
> 
	gaddr_pÜt
;

351 
	g¹c
::
¥l™
(
tuº_desc
.
£rv”_ho¡Çme
, ':', &
addr_pÜt
);

352 if(
	gaddr_pÜt
.
size
() != 2)

354 
LOG
(
LS_INFO
) << "Invalid TURN Server‡ddress…rovided. Address must contain‡…ort‚umber separated by‡ \":\".";

357 
	güick‘
::
R–ayS”v”CÚfig
 
»Ïy_cÚfig_udp
(
addr_pÜt
[0], 
¡oi
(addr_port[1]),

358 
tuº_desc
.
u£ºame
,uº_desc.
·sswÜd
, 
üick‘
::
PROTO_UDP
);

359 
	gpÜt_®loÿtÜ_
->
AddTuºS”v”
(
»Ïy_cÚfig_udp
);

364 
	gVœtu®Lšk
::
S¹CÚÃùiÚs
()

366 if(
³”_desc_
->
ÿs
.
Ëngth
() == 0)

367 
throw
 
TCEXCEPT
("The vlink connection cannot be started‡s‚o connection"

369 
AddRemÙeCªdid©es
(
³”_desc_
->
ÿs
);

371 
	gVœtu®Lšk
::
DiscÚÃù
()

373 
Œª¥Üt_ùÌ_
->
De¡royT¿n¥ÜtChªÃl_n
(
cÚ‹Á_Çme_
,

374 
üick‘
::
ICE_CANDIDATE_COMPONENT_DEFAULT
);

377 
boŞ
 
	gVœtu®Lšk
::
IsR—dy
()

379  
chªÃl_
->
wr™abË
();

	@src/windows/tapdev_win.cc

24 #ià
defšed
(
_IPOP_WIN
)

25 
	~"wšdows/pdev_wš.h
"

26 
	~<hÍ­i.h
>

27 
	~<m¡ı.h
>

28 
	~<wch¬.h
>

29 
	~<wšioùl.h
>

30 
	~"wšdows/wš_exû±iÚ.h
"

31 
Çme¥aû
 
	gtšÿn


33 
Çme¥aû
 
	gwšdows


35 cÚ¡ * cÚ¡ 
	gT­DevWš
::
NETWORK_PATH_
 =

38 cÚ¡ * cÚ¡ 
	gT­DevWš
::
USER_MODE_DEVICE_DIR_
 = "\\\\.\\Global\\";

39 cÚ¡ * cÚ¡ 
	gT­DevWš
::
TAP_SUFFIX_
 = ".tap";

41 
	#TAP_CONTROL_CODE
(
»que¡
,
m‘hod
) \

42 
	`CTL_CODE
 (
FILE_DEVICE_UNKNOWN
, 
»que¡
, 
m‘hod
, 
FILE_ANY_ACCESS
)

	)

44 
	#TAP_IOCTL_GET_MAC
 
	`TAP_CONTROL_CODE
 (1, 
METHOD_BUFFERED
)

	)

45 
	#TAP_IOCTL_GET_VERSION
 
	`TAP_CONTROL_CODE
 (2, 
METHOD_BUFFERED
)

	)

46 
	#TAP_IOCTL_GET_MTU
 
	`TAP_CONTROL_CODE
 (3, 
METHOD_BUFFERED
)

	)

47 
	#TAP_IOCTL_GET_INFO
 
	`TAP_CONTROL_CODE
 (4, 
METHOD_BUFFERED
)

	)

48 
	#TAP_IOCTL_CONFIG_POINT_TO_POINT
 
	`TAP_CONTROL_CODE
 (5, 
METHOD_BUFFERED
)

	)

49 
	#TAP_IOCTL_SET_MEDIA_STATUS
 
	`TAP_CONTROL_CODE
 (6, 
METHOD_BUFFERED
)

	)

50 
	#TAP_IOCTL_CONFIG_DHCP_MASQ
 
	`TAP_CONTROL_CODE
 (7, 
METHOD_BUFFERED
)

	)

51 
	#TAP_IOCTL_GET_LOG_LINE
 
	`TAP_CONTROL_CODE
 (8, 
METHOD_BUFFERED
)

	)

52 
	#TAP_IOCTL_CONFIG_DHCP_SET_OPT
 
	`TAP_CONTROL_CODE
 (9, 
METHOD_BUFFERED
)

	)

54 
	#TAP_WIN_IOCTL_CONFIG_TUN
 
	`TAP_WIN_CONTROL_CODE
 (10, 
METHOD_BUFFERED
)

	)

56 
DWORD
 
__¡dÿÎ


57 
	gT­DevWš
::
IoTh»adDesütÜ
::
IoCom¶‘iÚTh»ad
(* 
·¿m
)

59 
DWORD
 
rv
 = 
ERROR_SUCCESS
;

60 
IoTh»adDesütÜ
 * 
	giÙh
 = (IoTh»adDesütÜ*)
·¿m
;

61 
	gWAIT_OBJECT_0
 !ğ
Wa™FÜSšgËObjeù
(
iÙh
->
ex™_ev_
, 0))

63 
DWORD
 
	gby‹s_Œªsã»d
 = 0;

64 
T­DevWš
 *
	gp_dev
 = 
NULL
;

65 
OVERLAPPED
 *
	gov”Ïp
 = 
NULL
;

66 
	grv
 = 
ERROR_SUCCESS
;

67 if(!
G‘QueuedCom¶‘iÚStus
(

68 
iÙh
->
cm¶_´t_hdl_
,

69 &
by‹s_Œªsã»d
,

70 (
PULONG_PTR
)&
p_dev
, &
ov”Ïp
, 
INFINITE
))

72 
	grv
 = 
G‘La¡E¼Ü
();

74 if(
	gNULL
 =ğ
p_dev
 || 
NULL
 =ğ
ov”Ïp
)

76 if(
	gERROR_SUCCESS
 !ğ
rv
)

78 
LOG
(
LS_WARNING
è<< "Reûived‡ com¶‘iÚ…ack‘ fÜ‡ faed IO,ƒ¼Ü: " << 
rv
;

80 
AsyncIo
 * 
	gaio
 = (AsyncIo*)
ov”Ïp
;

81 
	gaio
->
By‹sT¿nsã¼ed
(0);

82 
	gaio
->
	ggood_
 = 
çl£
;

83 
	gaio
->
IsWr™e
(è? 
	gp_dev
->
wr™e_com¶‘iÚ_
(
aio
) :

84 
p_dev
->
»ad_com¶‘iÚ_
(
aio
);

88 
AsyncIo
 * 
	gaio
 = (AsyncIo*)
ov”Ïp
;

89 
	gaio
->
By‹sT¿nsã¼ed
(
by‹s_Œªsã»d
);

90 
	gaio
->
IsWr™e
(è? 
	gp_dev
->
wr™e_com¶‘iÚ_
(
aio
) :

91 
p_dev
->
»ad_com¶‘iÚ_
(
aio
);

94  
	grv
;

97 
	gT­DevWš
::
T­DevWš
() :

98 
cm¶_´t_hªdË_
(0),

99 
dev_hªdË_
(
INVALID_HANDLE_VALUE
),

100 
medŸ_¡©us_
(0),

101 
io_th»ad_poŞ_
()

104 
	gT­DevWš
::~
T­DevWš
()

108 
T­DevWš
::
O³n
(

109 cÚ¡ 
T­DesütÜ
 & 
p_desc
)

111 
lock_gu¬d
<
mu‹x
> 
lg
(
rw_mu‹x_
);

112 
	gp_Çme_
 = 
p_desc
.
Çme
;

113 
¡ršg
 
	gdeviû_guid
;

114 
	gŒy


116 cÚ¡ *
	g‹rm
;

117 
š_addr
 
	gv4_addr
;

118 if(0 =ğ
RIpv4SŒšgToAdd»ss
(
p_desc
.
4
.
c_¡r
(), 
TRUE
,

119 &
‹rm
, &
v4_addr
))

121 
memmove
(
4_
.
d©a
(), &
v4_addr
.
S_un
.
S_addr
, (ip4_));

124 
LOG
(
WARNING
) << "Failedo convert IP4 string in Tap Descriptor="

125 << 
	gp_desc
.
	g4
 << " fÜ TAP deviû " + 
	gp_Çme_
;

127 
N‘DeviûNameToGuid
(
p_Çme_
, 
deviû_guid
);

128 
¡ršg
 
deviû_·th
(
USER_MODE_DEVICE_DIR_
);

129 
	gdeviû_·th
.
­³nd
(
deviû_guid
).­³nd(
TAP_SUFFIX_
);

130 
	gdev_hªdË_
 = 
C»©eFe
(
deviû_·th
.
c_¡r
(),

131 
GENERIC_READ
 | 
GENERIC_WRITE
, 0, 0, 
OPEN_EXISTING
,

132 
FILE_ATTRIBUTE_SYSTEM
 | 
FILE_FLAG_OVERLAPPED
, 0);

133 if(
	gINVALID_HANDLE_VALUE
 =ğ
dev_hªdË_
)

135 cÚ¡ 
¡ršg
 
emsg
("FaedØİ’ TAP deviû " + 
p_Çme_
 + ".");

136 
throw
 
WINEXCEPT
(
emsg
.
c_¡r
());

138 
	gcm¶_´t_hªdË_
 = 
C»©eIoCom¶‘iÚPÜt
(
DeviûHªdË
(),

139 
Com¶‘iÚPÜtHªdË
(), (
ULONG_PTR
)
this
, 0);

140 if(!
	gcm¶_´t_hªdË_
)

142 
¡ršg
 
emsg
("The TAP IO completionhread failedo create‡n IO "

143 "com¶‘iÚ…ÜˆfÜ deviû " + 
p_Çme_
 + ".");

144 
throw
 
WINEXCEPT
(
emsg
.
c_¡r
());

146 
	gio_th»ad_poŞ_
.
AÎoc
();

147 } 
ÿtch
(
exû±iÚ
 & 
e
)

149 
Clo£HªdË
(
dev_hªdË_
);

150 
Clo£HªdË
(
cm¶_´t_hªdË_
);

151 
	ge
.
wh©
();

152 
	gthrow
;

156 
	gT­DevWš
::
Clo£
()

158 
lock_gu¬d
<
mu‹x
> 
lg
(
rw_mu‹x_
);

159 
	gio_th»ad_poŞ_
.
F»e
();

160 
Clo£HªdË
(
cm¶_´t_hªdË_
);

161 
Clo£HªdË
(
dev_hªdË_
);

165 
ušt32_t


166 
	gT­DevWš
::
R—d
(

167 
AsyncIo
 & 
aio_rd
)

169 
lock_gu¬d
<
mu‹x
> 
lg
(
rw_mu‹x_
);

170 
R—dFe
(
dev_hªdË_
,

171 
aio_rd
.
BufãrToT¿nsãr
(),

172 ()
aio_rd
.
By‹sToT¿nsãr
(),

173 
NULL
,

174 (
LPOVERLAPPED
)&
aio_rd
);

175 
DWORD
 
	grv
 = 
G‘La¡E¼Ü
();

176 if(
	grv
 !ğ
ERROR_IO_PENDING
 && 
rv
 !ğ
ERROR_SUCCESS
)

178 
LOG
(
LS_ERROR
) << "The TAP device„ead„equest operation failed for device "

179 << 
p_Çme_
 << ",ƒ¼Ü: " << 
rv
 << ".";

180  
	grv
;

185 
ušt32_t


186 
	gT­DevWš
::
Wr™e
(

187 
AsyncIo
 & 
aio_wr
)

189 
T­Mes§geD©a
 *

 = 
Ãw
 TapMessageData;

190 
	g
->
	gaio_
 = &
aio_wr
;

191 
	gwr™”_
.
Po¡
(
RTC_FROM_HERE
, 
this
, 
MSGID_WRITE
, 

);

196 
	gT­DevWš
::
N‘DeviûNameToGuid
(

197 cÚ¡ 
¡ršg
 & 
Çme
,

198 
¡ršg
 & 
guid
)

200 
DWORD
 
	gi_0
 = 0;

201 
boŞ
 
	gis_found
 = 
çl£
;

202 
DWORD
 
	gguid_buf_Ën
 = 256, 
	gÇme_buf_Ën
 = 256;

203 
HKEY
 
	gkey_0
 = 0, 
	gkey_1
 = 0;

204 
	gguid_buf
[256], 
	gÇme_buf
[256];

205 
¡ršg
 
	gfuÎ_·th
;

206 
	gŒy


209 if(
	gERROR_SUCCESS
 !ğ
RegO³nKeyEx
(
HKEY_LOCAL_MACHINE
, 
NETWORK_PATH_
, 0,

210 
KEY_READ
, &
key_0
))

212 
¡ršg
 
emsg
("Failedo open„egistry key");

213 
	gemsg
.
­³nd
(
NETWORK_PATH_
);

214 
throw
 
WINEXCEPT
(
emsg
.
c_¡r
());

216 !
	gis_found
)

219 
	gguid_buf_Ën
 = 256;

220 
DWORD
 
	grv
 = 
RegEnumKeyEx
(
key_0
, 
i_0
++, 
guid_buf
, &
guid_buf_Ën
,

221 
NULL
, NULL, NULL, NULL);

222 if(
	grv
 =ğ
ERROR_NO_MORE_ITEMS
)

223 
throw
 
WINEXCEPT
("Failedo„esolve IPOP TAP GUID in system„egistry");

224 if(
	grv
 !ğ
ERROR_SUCCESS
)

226 
	gfuÎ_·th
.
assign
(
NETWORK_PATH_
).
­³nd
("\\")

227 .
­³nd
(
guid_buf
).append("\\Connection");

228 if(
	gERROR_SUCCESS
 !ğ
RegO³nKeyEx
(
HKEY_LOCAL_MACHINE
, 
fuÎ_·th
.
c_¡r
(),

229 0, 
KEY_READ
, &
key_1
))

231 
	gÇme_buf_Ën
 = 256;

232 if(
	gERROR_SUCCESS
 !ğ
RegQu”yV®ueEx
(
key_1
, "Name", 
NULL
, NULL,

233 (
LPBYTE
)
Çme_buf
, &
Çme_buf_Ën
))

235 
RegClo£Key
(
key_1
);

236 
	gkey_1
 = 
nuÎ±r
;

240 if(
	gÇme
.
com·»
(
Çme_buf
) == 0)

242 
guid
.
assign
(
guid_buf
, 
guid_buf_Ën
);

243 
	gis_found
 = 
Œue
;

245 
RegClo£Key
(
key_1
);

246 
	gkey_1
 = 
nuÎ±r
;

248 
RegClo£Key
(
key_0
);

249 } 
ÿtch
(
exû±iÚ
 & 
e
)

251 
RegClo£Key
(
key_1
);

252 
RegClo£Key
(
key_0
);

253 
	ge
.
wh©
();

254 
	gthrow
;

259 
ušt32_t
 
	gT­DevWš
::
MedŸStus
()

261 
lock_gu¬d
<
mu‹x
> 
lg
(
rw_mu‹x_
);

262  
	gmedŸ_¡©us_
;

265 
MacAdd»ssTy³


266 
	gT­DevWš
::
MacAdd»ss
()

268 
lock_gu¬d
<
mu‹x
> 
lg
(
rw_mu‹x_
);

269 
G‘MacAdd»ss
();

270  
	gmac_add»ss_
;

274 
	gT­DevWš
::
G‘MacAdd»ss
()

276 ià(!
DeviûIoCÚŒŞ
(
dev_hªdË_
, 
TAP_IOCTL_GET_MAC
, &
mac_add»ss_
,

277 (
mac_add»ss_
), &mac_add»ss_.
äÚt
(),

278 (
DWORD
)
mac_add»ss_
.
max_size
(), &
mac_Ën_
, 
NULL
))

280 
¡ršg
 
emsg
("FaedØqu”y TAP deviû fÜ MAC‡dd»s oà" + 
p_Çme_
);

281 
throw
 
WINEXCEPT
(
emsg
.
c_¡r
());

286 
	gT­DevWš
::
OnMes§ge
(

287 
Mes§ge
 * 
msg
)

289 
msg
->
mes§ge_id
)

291 
MSGID_WRITE
:

293 
AsyncIo
* 
aio_wr
 = ((
T­Mes§geD©a
*)
msg
->
pd©a
)->
aio_
;

294 
	glock_gu¬d
<
	gmu‹x
> 
lg
(
rw_mu‹x_
);

295 
Wr™eFe
(
dev_hªdË_
, 
aio_wr
->
BufãrToT¿nsãr
(),

296 ()
aio_wr
->
By‹sToT¿nsãr
(), 
NULL
, (
LPOVERLAPPED
)aio_wr);

297 
DWORD
 
	grv
 = 
G‘La¡E¼Ü
();

298 if(
	grv
 !ğ
ERROR_IO_PENDING
 && 
rv
 !ğ
ERROR_SUCCESS
)

300 
LOG
(
LS_WARNING
) << "The TAP device write„equest operation failed for device "

301 << 
p_Çme_
 << ",ƒ¼Ü: " << 
rv
 << ".";

302 
d–‘e
 
	g¡©ic_ÿ¡
<
	gT­F¿me
*>(
	gaio_wr
->
	gcÚ‹xt_
);

307 
LOG
(
LS_WARNING
è<< "AÀšv®id TAP Mes§gID wa ¥ecif›d fÜ deviû " << 
p_Çme_
 << ".";

310 
d–‘e
 (
T­Mes§geD©a
*)
	gmsg
->
	gpd©a
;

314 
	gT­DevWš
::
Up
()

316 
lock_gu¬d
<
mu‹x
> 
lg
(
rw_mu‹x_
);

317 
DWORD
 
	gËn
 = 0;

318 
	gmedŸ_¡©us_
 = 1;

320 ià(!
DeviûIoCÚŒŞ
(
dev_hªdË_
, 
TAP_IOCTL_SET_MEDIA_STATUS
,

321 &
medŸ_¡©us_
, (media_status_), &media_status_,

322 (
medŸ_¡©us_
), (
LPDWORD
)&
Ën
, 
NULL
))

324 cÚ¡ 
¡ršg
 
emsg
("Deviû IO cÚŒŞØTAP faedØ’abË IPOP TAP deviû " + 
p_Çme_
);

325 
throw
 
WINEXCEPT
(
emsg
.
c_¡r
());

328 
ULONG
 
	gšfo
[3];

329 
mem£t
(
šfo
, 0, (info));

330 if(
DeviûIoCÚŒŞ
(
dev_hªdË_
, 
TAP_IOCTL_GET_VERSION
, &
šfo
,

331 (
šfo
), &šfo, (šfo), &
Ën
, 
NULL
))

333 
LOG
(
LS_INFO
è<< "TAP Driv” V”siÚ " << ()
	gšfo
[0] <<

334 ()
	gšfo
[1] << (info[2] ? "(DEBUG)" : "");

336 
ušt16_t
 
	gmtu
 = 
Mtu
();

337 
	gwr™”_
.
S¹
();

338 
	gio_th»ad_poŞ_
.
A‰ach
(
cm¶_´t_hªdË_
);

339 
LOG
(
LS_INFO
è<< "TAP deviû MTU " << 
	gmtu
;

343 
	gT­DevWš
::
Down
()

345 
lock_gu¬d
<
mu‹x
> 
lg
(
rw_mu‹x_
);

346 
DWORD
 
	gËn
 = 0;

347 
	gmedŸ_¡©us_
 = 0;

348 
	gio_th»ad_poŞ_
.
R–—£
();

349 
	gwr™”_
.
Qu™
();

350 ià(!
DeviûIoCÚŒŞ
(
dev_hªdË_
, 
TAP_IOCTL_SET_MEDIA_STATUS
, &
medŸ_¡©us_
,

351 (
medŸ_¡©us_
), &media_status_, (media_status_),

352 (
LPDWORD
)&
Ën
, 
NULL
))

354 cÚ¡ 
¡ršg
 
emsg
("Deviû IO cÚŒŞ faedØdi§bË IPOP TAP deviû " + 
p_Çme_
);

355 
throw
 
WINEXCEPT
(
emsg
.
c_¡r
());

366 
ušt16_t
 
	gT­DevWš
::
Mtu
()

369 
DWORD
 
Ën
 = 0;

370 
ULONG
 
	gmtu
;

371 if(!
DeviûIoCÚŒŞ
(
dev_hªdË_
, 
TAP_IOCTL_GET_MTU
, &
mtu
, (mtu),

372 &
mtu
, (mtu), &
Ën
, 
NULL
))

374 
LOG_ERR
(
LS_ERROR
) << "The ioctl failedo queryhe TAP device MTU for device "

375 << 
	gp_Çme_
 << ".";

377  (
	gušt16_t
)
	gmtu
;

380 
IP4Add»ssTy³


381 
	gT­DevWš
::
Ip4
()

383  
4_
;

	@/usr/include/arpa/inet.h

18 #iâdeà
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<Ãtš‘/š.h
>

25 #iâdeà
__sockËn_t_defšed


26 
__sockËn_t
 
	tsockËn_t
;

27 
	#__sockËn_t_defšed


	)

30 
__BEGIN_DECLS


34 
š_addr_t
 
	$š‘_addr
 (cÚ¡ *
__ı
è
__THROW
;

37 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

41 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

42 
__THROW
;

45 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

49 
š_addr_t
 
	$š‘_ÃtwÜk
 (cÚ¡ *
__ı
è
__THROW
;

53 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

58 
	$š‘_±Ú
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

59 *
__»¡riù
 
__buf
è
__THROW
;

64 cÚ¡ *
	$š‘_Áİ
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

65 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

66 
__THROW
;

70 #ifdeà
__USE_MISC


73 
	$š‘_©Ú
 (cÚ¡ *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

77 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

82 *
	$š‘_Ãt_Áİ
 (
__af
, cÚ¡ *
__ı
, 
__b™s
,

83 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

88 
	$š‘_Ãt_±Ú
 (
__af
, cÚ¡ *
__ı
,

89 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

94 
	$š‘_n§p_addr
 (cÚ¡ *
__ı
,

95 *
__buf
, 
__Ën
è
__THROW
;

99 *
	$š‘_n§p_Áß
 (
__Ën
, cÚ¡ *
__ı
,

100 *
__buf
è
__THROW
;

103 
__END_DECLS


	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


23 
	#_ERRNO_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/”ºo.h
>

32 #iâdeà
__ASSEMBLER__


34 
__BEGIN_DECLS


37 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
__©Œibu‹_cÚ¡__
;

38 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

40 #ifdeà
__USE_GNU


45 *
´og¿m_švoÿtiÚ_Çme
;

46 *
´og¿m_švoÿtiÚ_shÜt_Çme
;

50 #iâdeà
__”rÜ_t_defšed


51 
	#__”rÜ_t_defšed
 1

	)

52 
	t”rÜ_t
;

57 
__END_DECLS


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

39 #ifdeà
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oæag
) \

41 (((
oæag
è& 
O_CREAT
è!ğ0 || ((oæagè& 
__O_TMPFILE
è=ğ__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oæag
è(((oæagè& 
O_CREAT
è!ğ0)

	)

49 #iâdeà
__mode_t_defšed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_defšed


	)

54 #iâdeà
__off_t_defšed


55 #iâdeà
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

68 #iâdeà
__pid_t_defšed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_defšed


	)

74 #ifdeà
__USE_XOPEN2K8


75 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

77 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


78 
	~<b™s/¡©.h
>

80 
	#S_IFMT
 
__S_IFMT


	)

81 
	#S_IFDIR
 
__S_IFDIR


	)

82 
	#S_IFCHR
 
__S_IFCHR


	)

83 
	#S_IFBLK
 
__S_IFBLK


	)

84 
	#S_IFREG
 
__S_IFREG


	)

85 #ifdeà
__S_IFIFO


86 
	#S_IFIFO
 
__S_IFIFO


	)

88 #ifdeà
__S_IFLNK


89 
	#S_IFLNK
 
__S_IFLNK


	)

91 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


92 
	#S_IFSOCK
 
__S_IFSOCK


	)

97 
	#S_ISUID
 
__S_ISUID


	)

98 
	#S_ISGID
 
__S_ISGID


	)

100 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


102 
	#S_ISVTX
 
__S_ISVTX


	)

105 
	#S_IRUSR
 
__S_IREAD


	)

106 
	#S_IWUSR
 
__S_IWRITE


	)

107 
	#S_IXUSR
 
__S_IEXEC


	)

109 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

111 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

112 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

113 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

115 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

117 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

118 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

119 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

121 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

124 #ifdef 
__USE_MISC


125 #iâdeà
R_OK


128 
	#R_OK
 4

	)

129 
	#W_OK
 2

	)

130 
	#X_OK
 1

	)

131 
	#F_OK
 0

	)

136 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


137 
	#SEEK_SET
 0

	)

138 
	#SEEK_CUR
 1

	)

139 
	#SEEK_END
 2

	)

147 
fú
 (
__fd
, 
__cmd
, ...);

156 #iâdeà
__USE_FILE_OFFSET64


157 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

159 #ifdeà
__REDIRECT


160 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

161 
	`__nÚnuÎ
 ((1));

163 
	#İ’
 
İ’64


	)

166 #ifdeà
__USE_LARGEFILE64


167 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

170 #ifdeà
__USE_ATFILE


180 #iâdeà
__USE_FILE_OFFSET64


181 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

182 
	`__nÚnuÎ
 ((2));

184 #ifdeà
__REDIRECT


185 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

186 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

188 
	#İ’©
 
İ’©64


	)

191 #ifdeà
__USE_LARGEFILE64


192 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

193 
	`__nÚnuÎ
 ((2));

202 #iâdeà
__USE_FILE_OFFSET64


203 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

205 #ifdeà
__REDIRECT


206 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

207 
ü—t64
è
	`__nÚnuÎ
 ((1));

209 
	#ü—t
 
ü—t64


	)

212 #ifdeà
__USE_LARGEFILE64


213 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

216 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

217 && !
defšed
 
__USE_POSIX
))

226 
	#F_ULOCK
 0

	)

227 
	#F_LOCK
 1

	)

228 
	#F_TLOCK
 2

	)

229 
	#F_TEST
 3

	)

231 #iâdeà
__USE_FILE_OFFSET64


232 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

234 #ifdeà
__REDIRECT


235 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

237 
	#lockf
 
lockf64


	)

240 #ifdeà
__USE_LARGEFILE64


241 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

245 #ifdeà
__USE_XOPEN2K


248 #iâdeà
__USE_FILE_OFFSET64


249 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

250 
__advi£
è
__THROW
;

252 #ifdeà
__REDIRECT_NTH


253 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

254 
__off64_t
 
__Ën
, 
__advi£
),

255 
posix_çdvi£64
);

257 
	#posix_çdvi£
 
posix_çdvi£64


	)

260 #ifdeà
__USE_LARGEFILE64


261 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

262 
__advi£
è
__THROW
;

270 #iâdeà
__USE_FILE_OFFSET64


271 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

273 #ifdeà
__REDIRECT


274 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

275 
__off64_t
 
__Ën
),

276 
posix_çÎoÿ‹64
);

278 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

281 #ifdeà
__USE_LARGEFILE64


282 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

288 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

289 && 
defšed
 
__va_¬g_·ck_Ën


290 
	~<b™s/fú2.h
>

293 
__END_DECLS


	@/usr/include/linux/if_tun.h

17 #iâdeà
__IF_TUN_H


18 
	#__IF_TUN_H


	)

20 
	~<lšux/ty³s.h
>

21 
	~<lšux/if_‘h”.h
>

22 
	~<lšux/f‹r.h
>

25 
	#TUN_READQ_SIZE
 500

	)

27 
	#TUN_TUN_DEV
 
IFF_TUN


	)

28 
	#TUN_TAP_DEV
 
IFF_TAP


	)

29 
	#TUN_TYPE_MASK
 0x000f

	)

32 
	#TUNSETNOCSUM
 
	`_IOW
('T', 200, )

	)

33 
	#TUNSETDEBUG
 
	`_IOW
('T', 201, )

	)

34 
	#TUNSETIFF
 
	`_IOW
('T', 202, )

	)

35 
	#TUNSETPERSIST
 
	`_IOW
('T', 203, )

	)

36 
	#TUNSETOWNER
 
	`_IOW
('T', 204, )

	)

37 
	#TUNSETLINK
 
	`_IOW
('T', 205, )

	)

38 
	#TUNSETGROUP
 
	`_IOW
('T', 206, )

	)

39 
	#TUNGETFEATURES
 
	`_IOR
('T', 207, )

	)

40 
	#TUNSETOFFLOAD
 
	`_IOW
('T', 208, )

	)

41 
	#TUNSETTXFILTER
 
	`_IOW
('T', 209, )

	)

42 
	#TUNGETIFF
 
	`_IOR
('T', 210, )

	)

43 
	#TUNGETSNDBUF
 
	`_IOR
('T', 211, )

	)

44 
	#TUNSETSNDBUF
 
	`_IOW
('T', 212, )

	)

45 
	#TUNATTACHFILTER
 
	`_IOW
('T', 213, 
sock_årog
)

	)

46 
	#TUNDETACHFILTER
 
	`_IOW
('T', 214, 
sock_årog
)

	)

47 
	#TUNGETVNETHDRSZ
 
	`_IOR
('T', 215, )

	)

48 
	#TUNSETVNETHDRSZ
 
	`_IOW
('T', 216, )

	)

49 
	#TUNSETQUEUE
 
	`_IOW
('T', 217, )

	)

50 
	#TUNSETIFINDEX
 
	`_IOW
('T', 218, )

	)

51 
	#TUNGETFILTER
 
	`_IOR
('T', 219, 
sock_årog
)

	)

52 
	#TUNSETVNETLE
 
	`_IOW
('T', 220, )

	)

53 
	#TUNGETVNETLE
 
	`_IOR
('T', 221, )

	)

58 
	#TUNSETVNETBE
 
	`_IOW
('T', 222, )

	)

59 
	#TUNGETVNETBE
 
	`_IOR
('T', 223, )

	)

60 
	#TUNSETCARRIER
 
	`_IOW
('T', 226, )

	)

63 
	#IFF_TUN
 0x0001

	)

64 
	#IFF_TAP
 0x0002

	)

65 
	#IFF_NAPI
 0x0010

	)

66 
	#IFF_NAPI_FRAGS
 0x0020

	)

67 
	#IFF_NO_PI
 0x1000

	)

69 
	#IFF_ONE_QUEUE
 0x2000

	)

70 
	#IFF_VNET_HDR
 0x4000

	)

71 
	#IFF_TUN_EXCL
 0x8000

	)

72 
	#IFF_MULTI_QUEUE
 0x0100

	)

73 
	#IFF_ATTACH_QUEUE
 0x0200

	)

74 
	#IFF_DETACH_QUEUE
 0x0400

	)

76 
	#IFF_PERSIST
 0x0800

	)

77 
	#IFF_NOFILTER
 0x1000

	)

80 
	#TUN_TX_TIMESTAMP
 1

	)

83 
	#TUN_F_CSUM
 0x01

	)

84 
	#TUN_F_TSO4
 0x02

	)

85 
	#TUN_F_TSO6
 0x04

	)

86 
	#TUN_F_TSO_ECN
 0x08

	)

87 
	#TUN_F_UFO
 0x10

	)

90 
	#TUN_PKT_STRIP
 0x0001

	)

91 
	stun_pi
 {

92 
__u16
 
	mæags
;

93 
__be16
 
	m´Ùo
;

104 
	#TUN_FLT_ALLMULTI
 0x0001

	)

105 
	stun_f‹r
 {

106 
__u16
 
	mæags
;

107 
__u16
 
	mcouÁ
;

108 
__u8
 
	maddr
[0][
ETH_ALEN
];

	@/usr/include/net/if.h

19 #iâdeà
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<ã©u»s.h
>

24 #ifdeà
__USE_MISC


25 
	~<sys/ty³s.h
>

26 
	~<sys/sock‘.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_Çmešdex


35 
	mif_šdex
;

36 *
	mif_Çme
;

40 #ifdeà
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siçddr


90 
sockaddr
 
	miç_addr
;

93 
sockaddr
 
	mifu_brßdaddr
;

94 
sockaddr
 
	mifu_d¡addr
;

95 } 
	miç_ifu
;

96 
içû
 *
	miç_iå
;

97 
içddr
 *
	miç_Ãxt
;

100 
	#iç_brßdaddr
 
iç_ifu
.
ifu_brßdaddr


	)

101 
	#iç_d¡addr
 
iç_ifu
.
ifu_d¡addr


	)

111 
	sifm­


113 
	mmem_¡¬t
;

114 
	mmem_’d
;

115 
	mba£_addr
;

116 
	mœq
;

117 
	mdma
;

118 
	mpÜt
;

126 
	siäeq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	miän_Çme
[
IFNAMSIZ
];

133 } 
	miä_iän
;

137 
sockaddr
 
	miäu_addr
;

138 
sockaddr
 
	miäu_d¡addr
;

139 
sockaddr
 
	miäu_brßdaddr
;

140 
sockaddr
 
	miäu_Ãtmask
;

141 
sockaddr
 
	miäu_hwaddr
;

142 
	miäu_æags
;

143 
	miäu_iv®ue
;

144 
	miäu_mtu
;

145 
ifm­
 
	miäu_m­
;

146 
	miäu_¦ave
[
IFNAMSIZ
];

147 
	miäu_ÃwÇme
[
IFNAMSIZ
];

148 
__ÿddr_t
 
	miäu_d©a
;

149 } 
	miä_iäu
;

151 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

152 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

153 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

154 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

155 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

156 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

157 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

158 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

159 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

160 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

161 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

162 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

163 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

164 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

165 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

166 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

167 
	#_IOT_iäeq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_iäeq_shÜt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_iäeq_št
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifcÚf


178 
	mifc_Ën
;

181 
__ÿddr_t
 
	mifcu_buf
;

182 
iäeq
 *
	mifcu_»q
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

187 
	#_IOT_ifcÚf
 
	`_IOT
(
	`_IOTS
(
ifcÚf
),1,0,0,0,0è

	)

190 
__BEGIN_DECLS


193 
	$if_Çm‘ošdex
 (cÚ¡ *
__iâame
è
__THROW
;

194 *
	$if_šdextÚame
 (
__ifšdex
, *
__iâame
è
__THROW
;

197 
if_Çmešdex
 *
	$if_Çmešdex
 (è
__THROW
;

200 
	$if_ä“Çmešdex
 (
if_Çmešdex
 *
__±r
è
__THROW
;

202 
__END_DECLS


	@/usr/include/net/route.h

20 #iâdeà
_NET_ROUTE_H


21 
	#_NET_ROUTE_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<sys/sock‘.h
>

25 
	~<sys/ty³s.h
>

26 
	~<Ãtš‘/š.h
>

27 
	~<b™s/wÜdsize.h
>

31 
	s¹’Œy


33 
	m¹_·d1
;

34 
sockaddr
 
	m¹_d¡
;

35 
sockaddr
 
	m¹_g©eway
;

36 
sockaddr
 
	m¹_g’mask
;

37 
	m¹_æags
;

38 
	m¹_·d2
;

39 
	m¹_·d3
;

40 
	m¹_tos
;

41 
	m¹_şass
;

42 #ià
__WORDSIZE
 == 64

43 
	m¹_·d4
[3];

45 
	m¹_·d4
;

47 
	m¹_m‘ric
;

48 *
	m¹_dev
;

49 
	m¹_mtu
;

50 
	m¹_wšdow
;

51 
	m¹_œ‰
;

54 
	#¹_mss
 
¹_mtu


	)

57 
	sš6_¹msg


59 
š6_addr
 
	m¹msg_d¡
;

60 
š6_addr
 
	m¹msg_¤c
;

61 
š6_addr
 
	m¹msg_g©eway
;

62 
ušt32_t
 
	m¹msg_ty³
;

63 
ušt16_t
 
	m¹msg_d¡_Ën
;

64 
ušt16_t
 
	m¹msg_¤c_Ën
;

65 
ušt32_t
 
	m¹msg_m‘ric
;

66 
	m¹msg_šfo
;

67 
ušt32_t
 
	m¹msg_æags
;

68 
	m¹msg_ifšdex
;

72 
	#RTF_UP
 0x0001

	)

73 
	#RTF_GATEWAY
 0x0002

	)

75 
	#RTF_HOST
 0x0004

	)

76 
	#RTF_REINSTATE
 0x0008

	)

77 
	#RTF_DYNAMIC
 0x0010

	)

78 
	#RTF_MODIFIED
 0x0020

	)

79 
	#RTF_MTU
 0x0040

	)

80 
	#RTF_MSS
 
RTF_MTU


	)

81 
	#RTF_WINDOW
 0x0080

	)

82 
	#RTF_IRTT
 0x0100

	)

83 
	#RTF_REJECT
 0x0200

	)

84 
	#RTF_STATIC
 0x0400

	)

85 
	#RTF_XRESOLVE
 0x0800

	)

86 
	#RTF_NOFORWARD
 0x1000

	)

87 
	#RTF_THROW
 0x2000

	)

88 
	#RTF_NOPMTUDISC
 0x4000

	)

91 
	#RTF_DEFAULT
 0x00010000

	)

92 
	#RTF_ALLONLINK
 0x00020000

	)

93 
	#RTF_ADDRCONF
 0x00040000

	)

95 
	#RTF_LINKRT
 0x00100000

	)

96 
	#RTF_NONEXTHOP
 0x00200000

	)

98 
	#RTF_CACHE
 0x01000000

	)

99 
	#RTF_FLOW
 0x02000000

	)

100 
	#RTF_POLICY
 0x04000000

	)

102 
	#RTCF_VALVE
 0x00200000

	)

103 
	#RTCF_MASQ
 0x00400000

	)

104 
	#RTCF_NAT
 0x00800000

	)

105 
	#RTCF_DOREDIRECT
 0x01000000

	)

106 
	#RTCF_LOG
 0x02000000

	)

107 
	#RTCF_DIRECTSRC
 0x04000000

	)

109 
	#RTF_LOCAL
 0x80000000

	)

110 
	#RTF_INTERFACE
 0x40000000

	)

111 
	#RTF_MULTICAST
 0x20000000

	)

112 
	#RTF_BROADCAST
 0x10000000

	)

113 
	#RTF_NAT
 0x08000000

	)

115 
	#RTF_ADDRCLASSMASK
 0xF8000000

	)

116 
	#RT_ADDRCLASS
(
æags
è((
ušt32_t
èæag >> 23)

	)

118 
	#RT_TOS
(
tos
è(Ñosè& 
IPTOS_TOS_MASK
)

	)

120 
	#RT_LOCALADDR
(
æags
è((æag & 
RTF_ADDRCLASSMASK
) \

121 =ğ(
RTF_LOCAL
|
RTF_INTERFACE
))

	)

123 
	#RT_CLASS_UNSPEC
 0

	)

124 
	#RT_CLASS_DEFAULT
 253

	)

126 
	#RT_CLASS_MAIN
 254

	)

127 
	#RT_CLASS_LOCAL
 255

	)

128 
	#RT_CLASS_MAX
 255

	)

131 
	#RTMSG_ACK
 
NLMSG_ACK


	)

132 
	#RTMSG_OVERRUN
 
NLMSG_OVERRUN


	)

134 
	#RTMSG_NEWDEVICE
 0x11

	)

135 
	#RTMSG_DELDEVICE
 0x12

	)

136 
	#RTMSG_NEWROUTE
 0x21

	)

137 
	#RTMSG_DELROUTE
 0x22

	)

138 
	#RTMSG_NEWRULE
 0x31

	)

139 
	#RTMSG_DELRULE
 0x32

	)

140 
	#RTMSG_CONTROL
 0x40

	)

142 
	#RTMSG_AR_FAILED
 0x51

	)

	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifdeà
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #–ià
defšed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #–ià
defšed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<b™s/posix_İt.h
>

208 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


209 
	~<b™s/’vœÚm’ts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<b™s/ty³s.h
>

222 #iâdef 
__ssize_t_defšed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_defšed


	)

227 
	#__Ãed_size_t


	)

228 
	#__Ãed_NULL


	)

229 
	~<¡ddef.h
>

231 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


234 #iâdeà
__gid_t_defšed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_defšed


	)

239 #iâdeà
__uid_t_defšed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_defšed


	)

244 #iâdeà
__off_t_defšed


245 #iâdeà
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_defšed


	)

252 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_defšed


	)

257 #iâdeà
__u£cÚds_t_defšed


258 
__u£cÚds_t
 
	tu£cÚds_t
;

259 
	#__u£cÚds_t_defšed


	)

262 #iâdeà
__pid_t_defšed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_defšed


	)

268 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


269 #iâdeà
__šŒ_t_defšed


270 
__šŒ_t
 
	tšŒ_t
;

271 
	#__šŒ_t_defšed


	)

275 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


276 #iâdeà
__sockËn_t_defšed


277 
__sockËn_t
 
	tsockËn_t
;

278 
	#__sockËn_t_defšed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

292 #ifdeà
__USE_GNU


295 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

296 
__THROW
 
	`__nÚnuÎ
 ((1));

299 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

300 
__THROW
 
	`__nÚnuÎ
 ((1));

303 #ifdeà
__USE_ATFILE


307 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

308 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

313 #iâdef 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifdeà
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #ià
defšed
 
__USE_MISC
 && !defšed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #iâdeà
__USE_FILE_OFFSET64


337 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

339 #ifdeà
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

341 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

342 
l£ek64
);

344 
	#l£ek
 
l£ek64


	)

347 #ifdeà
__USE_LARGEFILE64


348 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

349 
__THROW
;

356 
	`şo£
 (
__fd
);

363 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

369 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

371 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


372 #iâdeà
__USE_FILE_OFFSET64


379 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

380 
__off_t
 
__off£t
è
__wur
;

387 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__off£t
è
__wur
;

390 #ifdeà
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

392 
__off64_t
 
__off£t
),

393 
´—d64
è
__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

395 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

396 
pwr™e64
è
__wur
;

398 
	#´—d
 
´—d64


	)

399 
	#pwr™e
 
pwr™e64


	)

403 #ifdeà
__USE_LARGEFILE64


407 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

408 
__off64_t
 
__off£t
è
__wur
;

411 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__off£t
è
__wur
;

420 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

422 #ifdeà
__USE_GNU


425 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

435 
	$®¬m
 (
__£cÚds
è
__THROW
;

447 
	`¦“p
 (
__£cÚds
);

449 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

450 || 
defšed
 
__USE_MISC


455 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

456 
__THROW
;

463 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

472 
	`·u£
 ();

476 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

479 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

486 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

491 #ifdeà
__USE_ATFILE


494 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

495 
__gid_t
 
__group
, 
__æag
)

496 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

500 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

502 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


504 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

514 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

523 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

524 || 
defšed
 
__USE_MISC


528 *
	$g‘wd
 (*
__buf
)

529 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

534 
	$dup
 (
__fd
è
__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

539 #ifdeà
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

546 **
__’vœÚ
;

547 #ifdeà
__USE_GNU


548 **
’vœÚ
;

554 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

555 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdeà
__USE_XOPEN2K8


560 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

561 
__THROW
 
	`__nÚnuÎ
 ((2));

566 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

567 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

571 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

572 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

576 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

577 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

581 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

582 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

588 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

590 #ifdeà
__USE_GNU


593 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

594 *cÚ¡ 
__’vp
[])

595 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

599 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


601 
	$niû
 (
__šc
è
__THROW
 
__wur
;

606 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

612 
	~<b™s/cÚâame.h
>

615 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

616 
__THROW
 
	`__nÚnuÎ
 ((1));

619 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

622 
	$syscÚf
 (
__Çme
è
__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

631 
__pid_t
 
	$g‘pid
 (è
__THROW
;

634 
__pid_t
 
	$g‘µid
 (è
__THROW
;

637 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

640 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

641 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


642 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

649 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

651 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


663 
	$£g½
 (è
__THROW
;

670 
__pid_t
 
	$£tsid
 (è
__THROW
;

672 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


674 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

678 
__uid_t
 
	$g‘uid
 (è
__THROW
;

681 
__uid_t
 
	$g‘euid
 (è
__THROW
;

684 
__gid_t
 
	$g‘gid
 (è
__THROW
;

687 
__gid_t
 
	$g‘egid
 (è
__THROW
;

692 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

703 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

705 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


708 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

711 #ifdeà
__USE_XOPEN2K


713 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

720 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

722 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


725 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

728 #ifdeà
__USE_XOPEN2K


730 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

733 #ifdeà
__USE_GNU


736 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

737 
__THROW
;

741 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

742 
__THROW
;

746 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

747 
__THROW
 
__wur
;

751 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

761 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

762 || 
defšed
 
__USE_MISC


767 
__pid_t
 
	$vfÜk
 (è
__THROW
;

773 *
	$‰yÇme
 (
__fd
è
__THROW
;

777 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

778 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

782 
	$i§‰y
 (
__fd
è
__THROW
;

784 #ifdeà
__USE_MISC


787 
	$‰y¦Ù
 (è
__THROW
;

792 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

793 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

795 #ifdeà
__USE_ATFILE


798 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

799 cÚ¡ *
__to
, 
__æags
)

800 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

803 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


805 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

806 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

811 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

812 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

813 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

816 #ifdeà
__USE_ATFILE


818 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

819 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

822 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

823 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

824 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

828 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

830 #ifdeà
__USE_ATFILE


832 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

833 
__THROW
 
	`__nÚnuÎ
 ((2));

837 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

841 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

844 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

851 *
	`g‘logš
 ();

852 #ifdeà
__USE_POSIX199506


859 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

862 #ifdef 
__USE_MISC


864 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

868 #ifdef 
__USE_POSIX2


872 
	~<b™s/g‘İt_posix.h
>

876 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


880 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

884 #ià
defšed
 
__USE_MISC


887 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

888 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

898 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

899 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

900 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

901 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

907 
	$vhªgup
 (è
__THROW
;

910 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

918 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

919 
size_t
 
__off£t
, 
__sÿË
)

920 
__THROW
 
	`__nÚnuÎ
 ((1));

926 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

930 *
	$g‘u£rsh–l
 (è
__THROW
;

931 
	$’du£rsh–l
 (è
__THROW
;

932 
	$£tu£rsh–l
 (è
__THROW
;

938 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

942 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

945 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

949 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

957 
	`fsync
 (
__fd
);

960 #ifdeà
__USE_GNU


963 
	$syncfs
 (
__fd
è
__THROW
;

967 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


970 
	`g‘ho¡id
 ();

973 
	$sync
 (è
__THROW
;

976 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K


979 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

984 
	$g‘dbËsize
 (è
__THROW
;

990 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


993 #iâdeà
__USE_FILE_OFFSET64


994 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

995 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

997 #ifdeà
__REDIRECT_NTH


998 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

999 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

1000 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1002 
	#Œunÿ‹
 
Œunÿ‹64


	)

1005 #ifdeà
__USE_LARGEFILE64


1006 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1012 #ià
defšed
 
__USE_POSIX199309
 \

1013 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1016 #iâdeà
__USE_FILE_OFFSET64


1017 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1019 #ifdeà
__REDIRECT_NTH


1020 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1021 
árunÿ‹64
è
__wur
;

1023 
	#árunÿ‹
 
árunÿ‹64


	)

1026 #ifdeà
__USE_LARGEFILE64


1027 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1033 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1034 || 
defšed
 
__USE_MISC


1038 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1044 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1048 #ifdeà
__USE_MISC


1059 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1064 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1076 
	#F_ULOCK
 0

	)

1077 
	#F_LOCK
 1

	)

1078 
	#F_TLOCK
 2

	)

1079 
	#F_TEST
 3

	)

1081 #iâdeà
__USE_FILE_OFFSET64


1082 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1084 #ifdeà
__REDIRECT


1085 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1086 
lockf64
è
__wur
;

1088 
	#lockf
 
lockf64


	)

1091 #ifdeà
__USE_LARGEFILE64


1092 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1097 #ifdeà
__USE_GNU


1102 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1103 (
__ex‹nsiÚ__
 \

1104 ({ 
__»suÉ
; \

1105 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1106 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1107 
__»suÉ
; 
	}
}))

	)

1110 
ssize_t
 
cİy_fe_¿nge
 (
__šfd
, 
__off64_t
 *
__pšoff
,

1111 
__outfd
, 
__off64_t
 *
__poutoff
,

1112 
size_t
 
__Ëngth
, 
__æags
);

1115 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1118 
fd©async
 (
__fdes
);

1124 #ifdef 
__USE_XOPEN


1126 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1127 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1131 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1132 
__THROW
 
	`__nÚnuÎ
 ((1));

1139 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1140 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1147 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1149 *
	$ù”mid
 (*
__s
è
__THROW
;

1152 *
	`cu£rid
 (*
__s
);

1158 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_XOPEN2K


1159 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1160 (*
__·»Á
) (),

1161 (*
__chd
è()è
__THROW
;

1164 #ifdeà
__USE_MISC


1167 
	$g‘’Œİy
 (*
__bufãr
, 
size_t
 
__Ëngth
è
__wur
;

1171 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1172 
	~<b™s/uni¡d.h
>

1175 
__END_DECLS


	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


24 
	#_WCHAR_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

30 
	~<b™s/æßŠ.h
>

32 
	#__Ãed_size_t


	)

33 
	#__Ãed_wch¬_t


	)

34 
	#__Ãed_NULL


	)

35 
	~<¡ddef.h
>

37 
	#__Ãed___va_li¡


	)

38 
	~<¡d¬g.h
>

40 
	~<b™s/wch¬.h
>

41 
	~<b™s/ty³s/wšt_t.h
>

42 
	~<b™s/ty³s/mb¡©e_t.h
>

43 
	~<b™s/ty³s/__FILE.h
>

45 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


46 
	~<b™s/ty³s/FILE.h
>

48 #ifdeà
__USE_XOPEN2K8


49 
	~<b™s/ty³s/loÿË_t.h
>

53 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

54 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

57 #iâdeà
WCHAR_MIN


59 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

60 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

63 #iâdeà
WEOF


64 
	#WEOF
 (0xffffffffu)

	)

74 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_GNU
 \

75 && !(
defšed
 
	g__USE_XOPEN2K
 && !defšed 
	g__USE_XOPEN2KXSI
))

76 
	~<b™s/wùy³-wch¬.h
>

79 
__BEGIN_DECLS


83 
	gtm
;

87 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

88 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

89 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

92 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

93 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

94 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

97 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

98 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

99 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

101 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

102 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

103 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

106 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

107 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

109 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

110 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

112 #ifdeà
__USE_XOPEN2K8


114 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

117 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

118 
size_t
 
__n
è
__THROW
;

122 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

123 
loÿË_t
 
__loc
è
__THROW
;

125 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

126 
size_t
 
__n
, 
loÿË_t
 
__loc
è
__THROW
;

131 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

135 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

136 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

138 #ifdeà
__USE_XOPEN2K8


144 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

145 
loÿË_t
 
__loc
è
__THROW
;

150 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

151 
size_t
 
__n
, 
loÿË_t
 
__loc
è
__THROW
;

154 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

158 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


159 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

160 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

161 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

162 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

164 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

165 
__THROW
 
__©Œibu‹_pu»__
;

168 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


169 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

170 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

171 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

172 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

174 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

175 
__THROW
 
__©Œibu‹_pu»__
;

178 #ifdeà
__USE_GNU


181 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

182 
__THROW
 
__©Œibu‹_pu»__
;

187 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

188 
__THROW
 
__©Œibu‹_pu»__
;

191 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

192 
__THROW
 
__©Œibu‹_pu»__
;

194 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


195 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

196 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

197 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

198 cÚ¡ 
wch¬_t
 *
__acû±
)

199 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

201 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

202 
__THROW
 
__©Œibu‹_pu»__
;

205 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


206 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

207 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

208 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

209 cÚ¡ 
wch¬_t
 *
__ÃedË
)

210 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

212 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

213 
__THROW
 
__©Œibu‹_pu»__
;

217 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

218 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

219 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

222 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

224 #ifdeà
__USE_XOPEN


226 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


227 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

228 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

229 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

230 cÚ¡ 
wch¬_t
 *
__ÃedË
)

231 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

233 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

234 
__THROW
 
__©Œibu‹_pu»__
;

238 #ifdeà
__USE_XOPEN2K8


240 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

241 
__THROW
 
__©Œibu‹_pu»__
;

246 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


247 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

248 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

249 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

250 
size_t
 
__n
)

251 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

253 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

254 
__THROW
 
__©Œibu‹_pu»__
;

258 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

259 
__THROW
 
__©Œibu‹_pu»__
;

262 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

263 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

267 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

268 
__THROW
;

271 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

273 #ifdeà
__USE_GNU


276 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

277 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

278 
__THROW
;

284 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

288 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

292 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

296 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

297 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

298 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

301 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

302 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

305 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

306 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

307 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

308 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

310 #ifdeà
__USE_EXTERN_INLINES


316 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

317 
__ex‹º_šlše
 
wšt_t


318 
	`__NTH
 (
	$btowc
 (
__c
))

319 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

320 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

322 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

323 
__ex‹º_šlše
 

324 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

325 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

326 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

328 
__ex‹º_šlše
 
size_t


329 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

330 
mb¡©e_t
 *
__»¡riù
 
__ps
))

331 {  (
__ps
 !ğ
NULL


332 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

337 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

338 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

339 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

343 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

344 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

345 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

348 #ifdef 
__USE_XOPEN2K8


351 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

352 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

353 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

357 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

358 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

359 
size_t
 
__nwc
, size_ˆ
__Ën
,

360 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

365 #ifdeà
__USE_XOPEN


367 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

371 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

377 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

378 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

380 #ifdeà
__USE_ISOC99


382 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

383 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

384 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

385 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

390 #ià
__HAVE_FLOAT16
 && 
defšed
 
__USE_GNU


391 
_Flßt16
 
	$wc¡of16
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

392 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

395 #ià
__HAVE_FLOAT32
 && 
defšed
 
__USE_GNU


396 
_Flßt32
 
	$wc¡of32
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

397 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

400 #ià
__HAVE_FLOAT64
 && 
defšed
 
__USE_GNU


401 
_Flßt64
 
	$wc¡of64
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

402 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

405 #ià
__HAVE_FLOAT128
 && 
defšed
 
__USE_GNU


406 
_Flßt128
 
	$wc¡of128
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

407 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

410 #ià
__HAVE_FLOAT32X
 && 
defšed
 
__USE_GNU


411 
_Flßt32x
 
	$wc¡of32x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

412 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

415 #ià
__HAVE_FLOAT64X
 && 
defšed
 
__USE_GNU


416 
_Flßt64x
 
	$wc¡of64x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

417 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

420 #ià
__HAVE_FLOAT128X
 && 
defšed
 
__USE_GNU


421 
_Flßt128x
 
	$wc¡of128x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

422 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

428 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

429 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

433 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

434 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

435 
__THROW
;

437 #ifdeà
__USE_ISOC99


440 
__ex‹nsiÚ__


441 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

442 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

443 
__THROW
;

447 
__ex‹nsiÚ__


448 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

449 
wch¬_t
 **
__»¡riù
 
__’d±r
,

450 
__ba£
è
__THROW
;

453 #ifdeà
__USE_GNU


456 
__ex‹nsiÚ__


457 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

459 
__THROW
;

463 
__ex‹nsiÚ__


464 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

465 
wch¬_t
 **
__»¡riù
 
__’d±r
,

466 
__ba£
è
__THROW
;

469 #ifdeà
__USE_GNU


473 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

475 
loÿË_t
 
__loc
è
__THROW
;

477 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

478 
wch¬_t
 **
__»¡riù
 
__’d±r
,

479 
__ba£
, 
loÿË_t
 
__loc
è
__THROW
;

481 
__ex‹nsiÚ__


482 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

483 
wch¬_t
 **
__»¡riù
 
__’d±r
,

484 
__ba£
, 
loÿË_t
 
__loc
è
__THROW
;

486 
__ex‹nsiÚ__


487 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

488 
wch¬_t
 **
__»¡riù
 
__’d±r
,

489 
__ba£
, 
loÿË_t
 
__loc
)

490 
__THROW
;

492 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

493 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

494 
__THROW
;

496 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

497 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

498 
__THROW
;

500 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
,

502 
loÿË_t
 
__loc
è
__THROW
;

504 #ià
__HAVE_FLOAT16


505 
_Flßt16
 
	$wc¡of16_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

506 
wch¬_t
 **
__»¡riù
 
__’d±r
,

507 
loÿË_t
 
__loc
è
__THROW
;

510 #ià
__HAVE_FLOAT32


511 
_Flßt32
 
	$wc¡of32_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

512 
wch¬_t
 **
__»¡riù
 
__’d±r
,

513 
loÿË_t
 
__loc
è
__THROW
;

516 #ià
__HAVE_FLOAT64


517 
_Flßt64
 
	$wc¡of64_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

518 
wch¬_t
 **
__»¡riù
 
__’d±r
,

519 
loÿË_t
 
__loc
è
__THROW
;

522 #ià
__HAVE_FLOAT128


523 
_Flßt128
 
	$wc¡of128_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

524 
wch¬_t
 **
__»¡riù
 
__’d±r
,

525 
loÿË_t
 
__loc
è
__THROW
;

528 #ià
__HAVE_FLOAT32X


529 
_Flßt32x
 
	$wc¡of32x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

530 
wch¬_t
 **
__»¡riù
 
__’d±r
,

531 
loÿË_t
 
__loc
è
__THROW
;

534 #ià
__HAVE_FLOAT64X


535 
_Flßt64x
 
	$wc¡of64x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

536 
wch¬_t
 **
__»¡riù
 
__’d±r
,

537 
loÿË_t
 
__loc
è
__THROW
;

540 #ià
__HAVE_FLOAT128X


541 
_Flßt128x
 
	$wc¡of128x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

542 
wch¬_t
 **
__»¡riù
 
__’d±r
,

543 
loÿË_t
 
__loc
è
__THROW
;

548 #ifdeà
__USE_XOPEN2K8


551 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

552 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

556 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

557 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

558 
__THROW
;

564 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

567 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

570 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


573 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

580 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

581 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

587 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

590 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

591 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

592 
__THROW
 ;

598 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

599 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

600 
__gnuc_va_li¡
 
__¬g
)

606 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

607 
__gnuc_va_li¡
 
__¬g
)

611 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

612 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

613 
__gnuc_va_li¡
 
__¬g
)

614 
__THROW
 ;

621 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

622 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

628 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

631 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

632 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

633 
__THROW
 ;

635 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

636 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

637 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

638 #ifdeà
__REDIRECT


642 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

643 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

644 
__isoc99_fwsÿnf
)

646 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

647 
__isoc99_wsÿnf
)

649 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

650 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

651 ...), 
__isoc99_swsÿnf
)

654 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

655 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

656 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

657 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

658 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

659 
__THROW
;

660 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

661 
	#wsÿnf
 
__isoc99_wsÿnf


	)

662 
	#swsÿnf
 
__isoc99_swsÿnf


	)

668 #ifdeà
__USE_ISOC99


673 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

674 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

675 
__gnuc_va_li¡
 
__¬g
)

681 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

682 
__gnuc_va_li¡
 
__¬g
)

685 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

686 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

687 
__gnuc_va_li¡
 
__¬g
)

688 
__THROW
 ;

690 #ià!
defšed
 
__USE_GNU
 \

691 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

692 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

693 #ifdeà
__REDIRECT


694 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

695 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

696 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

698 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

699 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

701 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

706 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

707 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

708 
__gnuc_va_li¡
 
__¬g
);

709 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

710 
__gnuc_va_li¡
 
__¬g
);

711 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

712 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

713 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

714 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

715 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

716 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

727 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

728 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

734 
wšt_t
 
	`g‘wch¬
 ();

741 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

742 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

748 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

756 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

757 
__FILE
 *
__»¡riù
 
__¡»am
);

763 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

764 
__FILE
 *
__»¡riù
 
__¡»am
);

771 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

774 #ifdeà
__USE_GNU


782 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

783 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

791 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

799 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

808 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

809 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

818 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

819 
__FILE
 *
__»¡riù
 
__¡»am
);

827 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

828 
__FILE
 *
__»¡riù
 
__¡»am
);

835 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

836 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

837 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

839 #ifdeà
__USE_GNU


842 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

843 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

844 cÚ¡ 
tm
 *
__»¡riù
 
__
,

845 
loÿË_t
 
__loc
è
__THROW
;

849 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


850 
	~<b™s/wch¬2.h
>

853 #ifdeà
__LDBL_COMPAT


854 
	~<b™s/wch¬-ldbl.h
>

857 
__END_DECLS


	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #undeà
__USE_ISOC11


120 #undeà
__USE_ISOC99


121 #undeà
__USE_ISOC95


122 #undeà
__USE_ISOCXX11


123 #undeà
__USE_POSIX


124 #undeà
__USE_POSIX2


125 #undeà
__USE_POSIX199309


126 #undeà
__USE_POSIX199506


127 #undeà
__USE_XOPEN


128 #undeà
__USE_XOPEN_EXTENDED


129 #undeà
__USE_UNIX98


130 #undeà
__USE_XOPEN2K


131 #undeà
__USE_XOPEN2KXSI


132 #undeà
__USE_XOPEN2K8


133 #undeà
__USE_XOPEN2K8XSI


134 #undeà
__USE_LARGEFILE


135 #undeà
__USE_LARGEFILE64


136 #undeà
__USE_FILE_OFFSET64


137 #undeà
__USE_MISC


138 #undeà
__USE_ATFILE


139 #undeà
__USE_GNU


140 #undeà
__USE_FORTIFY_LEVEL


141 #undeà
__KERNEL_STRICT_NAMES


142 #undeà
__GLIBC_USE_DEPRECATED_GETS


146 #iâdeà
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

159 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

168 #ià
defšed
 
__şªg_majÜ__
 && defšed 
__şªg_mšÜ__


169 
	#__glibc_şªg_´”eq
(
maj
, 
mš
) \

170 ((
__şªg_majÜ__
 << 16è+ 
__şªg_mšÜ__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

172 
	#__glibc_şªg_´”eq
(
maj
, 
mš
è0

	)

176 
	#__GLIBC_USE
(
F
è
__GLIBC_USE_
 ## 
	)
F

182 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

183 && !
defšed
 
	g_DEFAULT_SOURCE


185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifdeà
_GNU_SOURCE


191 #undeà
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #undeà
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #undeà
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #undeà
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #undeà
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #undeà
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #undeà
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #undeà
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #undeà
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #undeà
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #ià(
defšed
 
_DEFAULT_SOURCE
 \

216 || (!
defšed
 
	g__STRICT_ANSI__
 \

217 && !
defšed
 
	g_ISOC99_SOURCE
 \

218 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

219 && !
defšed
 
	g_XOPEN_SOURCE
))

220 #undeà
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #ià(
defšed
 
_ISOC11_SOURCE
 \

226 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

232 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

238 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifdeà
__ılu¥lus


244 #ià
__ılu¥lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #ià
__ılu¥lus
 >ğ201103L || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifdeà
_DEFAULT_SOURCE


259 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #undeà
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #undeà
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #ià((!
defšed
 
__STRICT_ANSI__
 \

269 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #ià((!
defšed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #undeà
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #ià(
defšed
 
_POSIX_SOURCE
 \

298 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
defšed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #undeà
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #undeà
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #undeà
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #ià(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #undeà
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #ià(
_XOPEN_SOURCE
 - 0) >= 600

337 #ià(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #undeà
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #undeà
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifdeà
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifdeà
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifdeà
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #ià
defšed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #ià
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #ià
defšed
 
__ılu¥lus
 ? __ılu¥lu >ğ201402L : defšed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<¡dc-´edef.h
>

410 #undeà
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 27

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

419 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

422 #iâdeà
__ASSEMBLER__


423 #iâdeà
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

438 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

439 && 
defšed
 
	g__ex‹º_šlše


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/¡ubs.h
>

	@/usr/include/linux/filter.h

6 #iâdeà
__LINUX_FILTER_H__


7 
	#__LINUX_FILTER_H__


	)

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/bpf_commÚ.h
>

16 
	#BPF_MAJOR_VERSION
 1

	)

17 
	#BPF_MINOR_VERSION
 1

	)

24 
	ssock_f‹r
 {

25 
__u16
 
	mcode
;

26 
__u8
 
	mjt
;

27 
__u8
 
	mjf
;

28 
__u32
 
	mk
;

31 
	ssock_årog
 {

32 
	mËn
;

33 
sock_f‹r
 *
	mf‹r
;

37 
	#BPF_RVAL
(
code
è((codeè& 0x18)

	)

38 
	#BPF_A
 0x10

	)

41 
	#BPF_MISCOP
(
code
è((codeè& 0xf8)

	)

42 
	#BPF_TAX
 0x00

	)

43 
	#BPF_TXA
 0x80

	)

48 #iâdeà
BPF_STMT


49 
	#BPF_STMT
(
code
, 
k
è{ ()(code), 0, 0, k }

	)

51 #iâdeà
BPF_JUMP


52 
	#BPF_JUMP
(
code
, 
k
, 
jt
, 
jf
è{ ()(code), jt, jf, k }

	)

58 
	#BPF_MEMWORDS
 16

	)

65 
	#SKF_AD_OFF
 (-0x1000)

	)

66 
	#SKF_AD_PROTOCOL
 0

	)

67 
	#SKF_AD_PKTTYPE
 4

	)

68 
	#SKF_AD_IFINDEX
 8

	)

69 
	#SKF_AD_NLATTR
 12

	)

70 
	#SKF_AD_NLATTR_NEST
 16

	)

71 
	#SKF_AD_MARK
 20

	)

72 
	#SKF_AD_QUEUE
 24

	)

73 
	#SKF_AD_HATYPE
 28

	)

74 
	#SKF_AD_RXHASH
 32

	)

75 
	#SKF_AD_CPU
 36

	)

76 
	#SKF_AD_ALU_XOR_X
 40

	)

77 
	#SKF_AD_VLAN_TAG
 44

	)

78 
	#SKF_AD_VLAN_TAG_PRESENT
 48

	)

79 
	#SKF_AD_PAY_OFFSET
 52

	)

80 
	#SKF_AD_RANDOM
 56

	)

81 
	#SKF_AD_VLAN_TPID
 60

	)

82 
	#SKF_AD_MAX
 64

	)

84 
	#SKF_NET_OFF
 (-0x100000)

	)

85 
	#SKF_LL_OFF
 (-0x200000)

	)

87 
	#BPF_NET_OFF
 
SKF_NET_OFF


	)

88 
	#BPF_LL_OFF
 
SKF_LL_OFF


	)

	@/usr/include/linux/if_ether.h

22 #iâdeà
_LINUX_IF_ETHER_H


23 
	#_LINUX_IF_ETHER_H


	)

25 
	~<lšux/ty³s.h
>

32 
	#ETH_ALEN
 6

	)

33 
	#ETH_TLEN
 2

	)

34 
	#ETH_HLEN
 14

	)

35 
	#ETH_ZLEN
 60

	)

36 
	#ETH_DATA_LEN
 1500

	)

37 
	#ETH_FRAME_LEN
 1514

	)

38 
	#ETH_FCS_LEN
 4

	)

40 
	#ETH_MIN_MTU
 68

	)

41 
	#ETH_MAX_MTU
 0xFFFFU

	)

47 
	#ETH_P_LOOP
 0x0060

	)

48 
	#ETH_P_PUP
 0x0200

	)

49 
	#ETH_P_PUPAT
 0x0201

	)

50 
	#ETH_P_TSN
 0x22F0

	)

51 
	#ETH_P_IP
 0x0800

	)

52 
	#ETH_P_X25
 0x0805

	)

53 
	#ETH_P_ARP
 0x0806

	)

54 
	#ETH_P_BPQ
 0x08FF

	)

55 
	#ETH_P_IEEEPUP
 0x0a00

	)

56 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

57 
	#ETH_P_BATMAN
 0x4305

	)

58 
	#ETH_P_DEC
 0x6000

	)

59 
	#ETH_P_DNA_DL
 0x6001

	)

60 
	#ETH_P_DNA_RC
 0x6002

	)

61 
	#ETH_P_DNA_RT
 0x6003

	)

62 
	#ETH_P_LAT
 0x6004

	)

63 
	#ETH_P_DIAG
 0x6005

	)

64 
	#ETH_P_CUST
 0x6006

	)

65 
	#ETH_P_SCA
 0x6007

	)

66 
	#ETH_P_TEB
 0x6558

	)

67 
	#ETH_P_RARP
 0x8035

	)

68 
	#ETH_P_ATALK
 0x809B

	)

69 
	#ETH_P_AARP
 0x80F3

	)

70 
	#ETH_P_8021Q
 0x8100

	)

71 
	#ETH_P_ERSPAN
 0x88BE

	)

72 
	#ETH_P_IPX
 0x8137

	)

73 
	#ETH_P_IPV6
 0x86DD

	)

74 
	#ETH_P_PAUSE
 0x8808

	)

75 
	#ETH_P_SLOW
 0x8809

	)

76 
	#ETH_P_WCCP
 0x883E

	)

78 
	#ETH_P_MPLS_UC
 0x8847

	)

79 
	#ETH_P_MPLS_MC
 0x8848

	)

80 
	#ETH_P_ATMMPOA
 0x884ø

	)

81 
	#ETH_P_PPP_DISC
 0x8863

	)

82 
	#ETH_P_PPP_SES
 0x8864

	)

83 
	#ETH_P_LINK_CTL
 0x886ø

	)

84 
	#ETH_P_ATMFATE
 0x8884

	)

87 
	#ETH_P_PAE
 0x888E

	)

88 
	#ETH_P_AOE
 0x88A2

	)

89 
	#ETH_P_8021AD
 0x88A8

	)

90 
	#ETH_P_802_EX1
 0x88B5

	)

91 
	#ETH_P_TIPC
 0x88CA

	)

92 
	#ETH_P_MACSEC
 0x88E5

	)

93 
	#ETH_P_8021AH
 0x88E7

	)

94 
	#ETH_P_MVRP
 0x88F5

	)

95 
	#ETH_P_1588
 0x88F7

	)

96 
	#ETH_P_NCSI
 0x88F8

	)

97 
	#ETH_P_PRP
 0x88FB

	)

98 
	#ETH_P_FCOE
 0x8906

	)

99 
	#ETH_P_IBOE
 0x8915

	)

100 
	#ETH_P_TDLS
 0x890D

	)

101 
	#ETH_P_FIP
 0x8914

	)

102 
	#ETH_P_80221
 0x8917

	)

103 
	#ETH_P_HSR
 0x892F

	)

104 
	#ETH_P_NSH
 0x894F

	)

105 
	#ETH_P_LOOPBACK
 0x9000

	)

106 
	#ETH_P_QINQ1
 0x9100

	)

107 
	#ETH_P_QINQ2
 0x9200

	)

108 
	#ETH_P_QINQ3
 0x9300

	)

109 
	#ETH_P_EDSA
 0xDADA

	)

110 
	#ETH_P_IFE
 0xED3E

	)

111 
	#ETH_P_AF_IUCV
 0xFBFB

	)

113 
	#ETH_P_802_3_MIN
 0x0600

	)

120 
	#ETH_P_802_3
 0x0001

	)

121 
	#ETH_P_AX25
 0x0002

	)

122 
	#ETH_P_ALL
 0x0003

	)

123 
	#ETH_P_802_2
 0x0004

	)

124 
	#ETH_P_SNAP
 0x0005

	)

125 
	#ETH_P_DDCMP
 0x0006

	)

126 
	#ETH_P_WAN_PPP
 0x0007

	)

127 
	#ETH_P_PPP_MP
 0x0008

	)

128 
	#ETH_P_LOCALTALK
 0x0009

	)

129 
	#ETH_P_CAN
 0x000C

	)

130 
	#ETH_P_CANFD
 0x000D

	)

131 
	#ETH_P_PPPTALK
 0x0010

	)

132 
	#ETH_P_TR_802_2
 0x0011

	)

133 
	#ETH_P_MOBITEX
 0x0015

	)

134 
	#ETH_P_CONTROL
 0x0016

	)

135 
	#ETH_P_IRDA
 0x0017

	)

136 
	#ETH_P_ECONET
 0x0018

	)

137 
	#ETH_P_HDLC
 0x0019

	)

138 
	#ETH_P_ARCNET
 0x001A

	)

139 
	#ETH_P_DSA
 0x001B

	)

140 
	#ETH_P_TRAILER
 0x001C

	)

141 
	#ETH_P_PHONET
 0x00F5

	)

142 
	#ETH_P_IEEE802154
 0x00F6

	)

143 
	#ETH_P_CAIF
 0x00F7

	)

144 
	#ETH_P_XDSA
 0x00F8

	)

145 
	#ETH_P_MAP
 0x00F9

	)

154 #iâdeà
__UAPI_DEF_ETHHDR


155 
	#__UAPI_DEF_ETHHDR
 1

	)

158 #ià
__UAPI_DEF_ETHHDR


159 
	s‘hhdr
 {

160 
	mh_de¡
[
ETH_ALEN
];

161 
	mh_sourû
[
ETH_ALEN
];

162 
__be16
 
	mh_´Ùo
;

163 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/types.h

2 #iâdeà
_LINUX_TYPES_H


3 
	#_LINUX_TYPES_H


	)

5 
	~<asm/ty³s.h
>

7 #iâdeà
__ASSEMBLY__


9 
	~<lšux/posix_ty³s.h
>

17 #ifdeà
__CHECKER__


18 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

20 
	#__b™wi£__


	)

22 
	#__b™wi£
 
__b™wi£__


	)

24 
__u16
 
	t__b™wi£
 
	t__Ë16
;

25 
__u16
 
	t__b™wi£
 
	t__be16
;

26 
__u32
 
	t__b™wi£
 
	t__Ë32
;

27 
__u32
 
	t__b™wi£
 
	t__be32
;

28 
__u64
 
	t__b™wi£
 
	t__Ë64
;

29 
__u64
 
	t__b™wi£
 
	t__be64
;

31 
__u16
 
	t__b™wi£
 
	t__sum16
;

32 
__u32
 
	t__b™wi£
 
	t__wsum
;

43 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

44 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

45 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<b™s/¡dšt-ušŠ.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_MPLS
 = 137,

89 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


98 #ià!
__USE_KERNEL_IPV6_DEFS


101 
	mIPPROTO_HOPOPTS
 = 0,

102 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

103 
	mIPPROTO_ROUTING
 = 43,

104 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

105 
	mIPPROTO_FRAGMENT
 = 44,

106 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

107 
	mIPPROTO_ICMPV6
 = 58,

108 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

109 
	mIPPROTO_NONE
 = 59,

110 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

111 
	mIPPROTO_DSTOPTS
 = 60,

112 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

113 
	mIPPROTO_MH
 = 135

114 
	#IPPROTO_MH
 
IPPROTO_MH


	)

119 
ušt16_t
 
	tš_pÜt_t
;

124 
	mIPPORT_ECHO
 = 7,

125 
	mIPPORT_DISCARD
 = 9,

126 
	mIPPORT_SYSTAT
 = 11,

127 
	mIPPORT_DAYTIME
 = 13,

128 
	mIPPORT_NETSTAT
 = 15,

129 
	mIPPORT_FTP
 = 21,

130 
	mIPPORT_TELNET
 = 23,

131 
	mIPPORT_SMTP
 = 25,

132 
	mIPPORT_TIMESERVER
 = 37,

133 
	mIPPORT_NAMESERVER
 = 42,

134 
	mIPPORT_WHOIS
 = 43,

135 
	mIPPORT_MTP
 = 57,

137 
	mIPPORT_TFTP
 = 69,

138 
	mIPPORT_RJE
 = 77,

139 
	mIPPORT_FINGER
 = 79,

140 
	mIPPORT_TTYLINK
 = 87,

141 
	mIPPORT_SUPDUP
 = 95,

144 
	mIPPORT_EXECSERVER
 = 512,

145 
	mIPPORT_LOGINSERVER
 = 513,

146 
	mIPPORT_CMDSERVER
 = 514,

147 
	mIPPORT_EFSSERVER
 = 520,

150 
	mIPPORT_BIFFUDP
 = 512,

151 
	mIPPORT_WHOSERVER
 = 513,

152 
	mIPPORT_ROUTESERVER
 = 520,

155 
	mIPPORT_RESERVED
 = 1024,

158 
	mIPPORT_USERRESERVED
 = 5000

166 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

167 
	#IN_CLASSA_NET
 0xff000000

	)

168 
	#IN_CLASSA_NSHIFT
 24

	)

169 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

170 
	#IN_CLASSA_MAX
 128

	)

172 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

173 
	#IN_CLASSB_NET
 0xffff0000

	)

174 
	#IN_CLASSB_NSHIFT
 16

	)

175 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

176 
	#IN_CLASSB_MAX
 65536

	)

178 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

179 
	#IN_CLASSC_NET
 0xffffff00

	)

180 
	#IN_CLASSC_NSHIFT
 8

	)

181 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

183 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

184 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

186 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

187 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

190 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

192 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

194 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

197 
	#IN_LOOPBACKNET
 127

	)

199 #iâdeà
INADDR_LOOPBACK


200 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

204 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

205 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

206 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

207 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

209 #ià!
__USE_KERNEL_IPV6_DEFS


211 
	sš6_addr


215 
ušt8_t
 
	m__u6_addr8
[16];

216 
ušt16_t
 
	m__u6_addr16
[8];

217 
ušt32_t
 
	m__u6_addr32
[4];

218 } 
	m__š6_u
;

219 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

220 #ifdeà
__USE_MISC


221 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

227 cÚ¡ 
š6_addr
 
š6addr_ªy
;

228 cÚ¡ 
š6_addr
 
š6addr_loİback
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_š


239 
__SOCKADDR_COMMON
 (
sš_
);

240 
š_pÜt_t
 
	msš_pÜt
;

241 
š_addr
 
	msš_addr
;

244 
	msš_z”o
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
š_pÜt_t
) -

247  (
š_addr
)];

250 #ià!
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_š6


254 
__SOCKADDR_COMMON
 (
sš6_
);

255 
š_pÜt_t
 
	msš6_pÜt
;

256 
ušt32_t
 
	msš6_æowšfo
;

257 
š6_addr
 
	msš6_addr
;

258 
ušt32_t
 
	msš6_scİe_id
;

262 #ifdeà
__USE_MISC


264 
	s_m»q


267 
š_addr
 
	mimr_muÉŸddr
;

270 
š_addr
 
	mimr_š‹rçû
;

273 
	s_m»q_sourû


276 
š_addr
 
	mimr_muÉŸddr
;

279 
š_addr
 
	mimr_š‹rçû
;

282 
š_addr
 
	mimr_sourûaddr
;

286 #ià!
__USE_KERNEL_IPV6_DEFS


288 
	sv6_m»q


291 
š6_addr
 
	mv6mr_muÉŸddr
;

294 
	mv6mr_š‹rçû
;

298 #ifdeà
__USE_MISC


300 
	sgroup_»q


303 
ušt32_t
 
	mgr_š‹rçû
;

306 
sockaddr_¡Üage
 
	mgr_group
;

309 
	sgroup_sourû_»q


312 
ušt32_t
 
	mg¤_š‹rçû
;

315 
sockaddr_¡Üage
 
	mg¤_group
;

318 
sockaddr_¡Üage
 
	mg¤_sourû
;

323 
	s_msf‹r


326 
š_addr
 
	mimsf_muÉŸddr
;

329 
š_addr
 
	mimsf_š‹rçû
;

332 
ušt32_t
 
	mimsf_fmode
;

335 
ušt32_t
 
	mimsf_num¤c
;

337 
š_addr
 
	mimsf_¦i¡
[1];

340 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

341 -  (
š_addr
) \

342 + (
num¤c
è*  (
š_addr
))

	)

344 
	sgroup_f‹r


347 
ušt32_t
 
	mgf_š‹rçû
;

350 
sockaddr_¡Üage
 
	mgf_group
;

353 
ušt32_t
 
	mgf_fmode
;

356 
ušt32_t
 
	mgf_num¤c
;

358 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

361 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

362 -  (
sockaddr_¡Üage
) \

363 + ((
num¤c
) \

364 *  (
sockaddr_¡Üage
)))

	)

374 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

375 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

376 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

382 
	~<’dŸn.h
>

385 
	~<b™s/by‹sw­.h
>

386 
	~<b™s/ušŠ-id’t™y.h
>

388 #ifdeà
__OPTIMIZE__


392 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


395 
	#Áohl
(
x
è
	`__ušt32_id’t™y
 (x)

	)

396 
	#Áohs
(
x
è
	`__ušt16_id’t™y
 (x)

	)

397 
	#htÚl
(
x
è
	`__ušt32_id’t™y
 (x)

	)

398 
	#htÚs
(
x
è
	`__ušt16_id’t™y
 (x)

	)

400 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


401 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

402 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

403 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

404 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

409 #ifdeà
__GNUC__


410 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

411 (
__ex‹nsiÚ__
 \

412 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

413 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

414 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

415 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

416 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ0; 
	}
}))

	)

418 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

419 (
__ex‹nsiÚ__
 \

420 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

421 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

422 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

423 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

424 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

426 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

427 (
__ex‹nsiÚ__
 \

428 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

429 (
__a
->
__š6_u
.
__u6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

431 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

432 (
__ex‹nsiÚ__
 \

433 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

434 (
__a
->
__š6_u
.
__u6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

436 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

437 (
__ex‹nsiÚ__
 \

438 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

439 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

440 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

441 && 
__a
->
__š6_u
.
__u6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

443 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

444 (
__ex‹nsiÚ__
 \

445 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

446 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

447 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

448 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

449 && 
	`Áohl
 (
__a
->
__š6_u
.
__u6_addr32
[3]è> 1; }))

	)

451 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

452 (
__ex‹nsiÚ__
 \

453 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

454 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

455 
__a
->
__š6_u
.
__u6_addr32
[0] =ğ
__b
->__in6_u.__u6_addr32[0] \

456 && 
__a
->
__š6_u
.
__u6_addr32
[1] =ğ
__b
->__in6_u.__u6_addr32[1] \

457 && 
__a
->
__š6_u
.
__u6_addr32
[2] =ğ
__b
->__in6_u.__u6_addr32[2] \

458 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ
__b
->__š6_u.__u6_addr32[3]; }))

	)

460 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

461 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

462 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

464 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

466 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

467 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

468 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

470 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

472 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

473 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

474 =ğ
	`htÚl
 (0xã800000))

	)

476 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

477 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

478 =ğ
	`htÚl
 (0xãc00000))

	)

480 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

481 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

482 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

483 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

485 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

486 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

487 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

488 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

489 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

491 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

492 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

493 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

495 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

498 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

500 #ifdeà
__USE_MISC


502 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

505 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

506 
__THROW
;

510 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

511 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

512 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

514 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

515 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

516 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

518 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

519 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

520 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

522 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

523 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

524 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

526 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

527 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

528 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

531 #ifdeà
__USE_GNU


532 
cmsghdr
;

534 #ià!
__USE_KERNEL_IPV6_DEFS


536 
	sš6_pktšfo


538 
š6_addr
 
i6_addr
;

539 
i6_ifšdex
;

543 
	s6_mtušfo


545 
sockaddr_š6
 
6m_addr
;

546 
ušt32_t
 
6m_mtu
;

551 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

552 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

553 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

554 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

555 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

556 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

557 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

558 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

559 
__muÉx
, 
__¶usy
)

560 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

561 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

562 
ušt8_t
 **
__Œp
)

563 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

564 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

565 
ušt8_t
 **
__Œp
, 
__ty³
)

566 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

570 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

571 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

572 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

573 **
__d©abuå
è
__THROW
;

574 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

575 
__THROW
;

576 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

577 
sockËn_t
 
__v®Ën
è
__THROW
;

578 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

579 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

580 **
__d©abuå
è
__THROW
;

581 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

582 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

583 **
__d©abuå
è
__THROW
;

584 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

585 
sockËn_t
 
__v®Ën
è
__THROW
;

589 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

590 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

591 
__£gm’ts
è
__THROW
;

592 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

593 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

594 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

595 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

596 
__THROW
;

602 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

603 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

604 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

605 
__THROW
;

608 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

609 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

610 
ušt32_t
 
__num¤c
,

611 cÚ¡ 
š_addr
 *
__¦i¡
)

612 
__THROW
;

616 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

617 cÚ¡ 
sockaddr
 *
__group
,

618 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

619 
ušt32_t
 *
__num¤c
,

620 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

623 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

624 cÚ¡ 
sockaddr
 *
__group
,

625 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

626 
ušt32_t
 
__num¤c
,

627 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

630 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

61 
	~<b™s/ušŠ-id’t™y.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

80 
	#htobe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

81 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

82 
	#be16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

83 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

85 
	#htobe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

86 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

87 
	#be32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

88 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

90 
	#htobe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

91 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

92 
	#be64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

93 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/linux/bpf_common.h

2 #iâdeà
__LINUX_BPF_COMMON_H__


3 
	#__LINUX_BPF_COMMON_H__


	)

6 
	#BPF_CLASS
(
code
è((codeè& 0x07)

	)

7 
	#BPF_LD
 0x00

	)

8 
	#BPF_LDX
 0x01

	)

9 
	#BPF_ST
 0x02

	)

10 
	#BPF_STX
 0x03

	)

11 
	#BPF_ALU
 0x04

	)

12 
	#BPF_JMP
 0x05

	)

13 
	#BPF_RET
 0x06

	)

14 
	#BPF_MISC
 0x07

	)

17 
	#BPF_SIZE
(
code
è((codeè& 0x18)

	)

18 
	#BPF_W
 0x00

	)

19 
	#BPF_H
 0x08

	)

20 
	#BPF_B
 0x10

	)

21 
	#BPF_MODE
(
code
è((codeè& 0xe0)

	)

22 
	#BPF_IMM
 0x00

	)

23 
	#BPF_ABS
 0x20

	)

24 
	#BPF_IND
 0x40

	)

25 
	#BPF_MEM
 0x60

	)

26 
	#BPF_LEN
 0x80

	)

27 
	#BPF_MSH
 0xa0

	)

30 
	#BPF_OP
(
code
è((codeè& 0xf0)

	)

31 
	#BPF_ADD
 0x00

	)

32 
	#BPF_SUB
 0x10

	)

33 
	#BPF_MUL
 0x20

	)

34 
	#BPF_DIV
 0x30

	)

35 
	#BPF_OR
 0x40

	)

36 
	#BPF_AND
 0x50

	)

37 
	#BPF_LSH
 0x60

	)

38 
	#BPF_RSH
 0x70

	)

39 
	#BPF_NEG
 0x80

	)

40 
	#BPF_MOD
 0x90

	)

41 
	#BPF_XOR
 0xa0

	)

43 
	#BPF_JA
 0x00

	)

44 
	#BPF_JEQ
 0x10

	)

45 
	#BPF_JGT
 0x20

	)

46 
	#BPF_JGE
 0x30

	)

47 
	#BPF_JSET
 0x40

	)

48 
	#BPF_SRC
(
code
è((codeè& 0x08)

	)

49 
	#BPF_K
 0x00

	)

50 
	#BPF_X
 0x08

	)

52 #iâdeà
BPF_MAXINSNS


53 
	#BPF_MAXINSNS
 4096

	)

	@/usr/include/linux/posix_types.h

2 #iâdeà
_LINUX_POSIX_TYPES_H


3 
	#_LINUX_POSIX_TYPES_H


	)

5 
	~<lšux/¡ddef.h
>

22 #undeà
__FD_SETSIZE


23 
	#__FD_SETSIZE
 1024

	)

26 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

27 } 
	t__k”Ãl_fd_£t
;

30 (*
	t__k”Ãl_sighªdËr_t
)();

33 
	t__k”Ãl_key_t
;

34 
	t__k”Ãl_mqd_t
;

36 
	~<asm/posix_ty³s.h
>

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

61 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/linux/stddef.h

4 #iâdeà
__®ways_šlše


5 
	#__®ways_šlše
 
__šlše__


	)

	@
1
.
1
/usr/include
54
1317
include/async_io.h
include/basic_tunnel.h
include/control_dispatch.h
include/control_listener.h
include/controller_handle.h
include/linux/lnx_exception.h
include/linux/tapdev_lnx.h
include/multi_link_tunnel.h
include/peer_descriptor.h
include/peer_network.h
include/single_link_tunnel.h
include/tap_frame.h
include/tapdev.h
include/tapdev_inf.h
include/tincan.h
include/tincan_base.h
include/tincan_control.h
include/tincan_exception.h
include/tunnel_descriptor.h
include/turn_descriptor.h
include/virtual_link.h
include/windows/tapdev_win.h
include/windows/win_exception.h
src/basic_tunnel.cc
src/control_dispatch.cc
src/control_listener.cc
src/linux/tapdev_lnx.cc
src/multi_link_tunnel.cc
src/peer_network.cc
src/single_link_tunnel.cc
src/tap_frame.cc
src/tincan.cc
src/tincan_control.cc
src/tincan_main.cc
src/virtual_link.cc
src/windows/tapdev_win.cc
/usr/include/arpa/inet.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/linux/if_tun.h
/usr/include/net/if.h
/usr/include/net/route.h
/usr/include/unistd.h
/usr/include/wchar.h
/usr/include/features.h
/usr/include/linux/filter.h
/usr/include/linux/if_ether.h
/usr/include/linux/types.h
/usr/include/netinet/in.h
/usr/include/endian.h
/usr/include/linux/bpf_common.h
/usr/include/linux/posix_types.h
/usr/include/stdc-predef.h
/usr/include/linux/stddef.h
